commid_id,commit_message,critical_class_name_list,issue_id
91afe8b6e9e9f0a808261b72c8532841b871ba45,"move *Partitioner from cassandra.service to cassandra.dht.
patch by jbellis; reviewed by Jun Rao for CASSANDRA-65

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@769013 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-65
63a748ccf9ab5192456baca9dd90b4c0cf2a2038,"r/m unused code
patch by jbellis; reviewed by Jun Rao for CASSANDRA-65

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@769014 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-65
907d92e21b8ce79e6a224933764e3b7215a94454,"replace BigInteger tokens with BigIntegerToken and StringToken in RandomPartitioner and OrderPreservingPartitioner, respectively.  (OrderPreservingHashPartitioner is no more.)

Doing order preserving partitioning based on the raw string has a number of compelling advantages:
 - there is no key length that all tokens must be padded to (which can be expensive if there is a range of key lengths) and which cannot be increased after deployment
 - it allows user-defined collations [sorting] rather than being limited to sorting by code point value (which is useless in the unicode world, and not always what you want even for ascii keys)
 - it will work with all UTF-16 characters, not just the UCS-2 subset (this is a limitation of using as a base 2**16, i.e., assuming for your order preserving hash that all characters are two bytes).

patch by jbellis; reviewed by Jun Rao for CASSANDRA-65

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@769016 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-65
ec7f04b4df62b87231d9cacca754a209bd8fcc59,"r/m StorageService.token in favor of explicitly passing a Partitioner object.  this allows testing of components independent of the static SS.
patch by jbellis; reviewed by Jun Rao for CASSANDRA-65

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@769017 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-65
296e15b63cdb678a12db004e29359eaf8c14c6c5,"add test for ReplicaPlacementStrategy covering both Random and OrderPreserving partitioners
patch by jbellis; reviewed by Jun Rao for CASSANDRA-65

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@769018 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-65
bfb2e952204f9879133826305b2b5dfda3e61776,"rename getDefaultToken -> getInitialToken
patch by jbellis; reviewed by Jun Rao for CASSANDRA-65

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@769019 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-65
d2a61c67b09ed70ee3e5dfc9bf15fb74a4876f56,"add SSTable tests.  in particular we want to be sure to test bloomfilter
[de]serialize since that's going to change a lot.
patch by jbellis; reviewed by Eric Evans for CASSANDRA-37

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@769087 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-37
9db8da81b7f269e5a8a7f896b751d482847d7082,"Add range query support, which requires using an OrderPreservingPartitioner.  (Keys are returned in the order defined by the partitioner collation.)  The fundamental approach (in table.getKeyRange) is simple: create a CollatedIterator that will return unique keys from different sources, each of which is already sorted.  Then we just need Iterators for different key sources.  For SSTables, this means adding seekTo and an Iterator interface to FileStruct.  For Memtable, this means adding a DestructivePQIterator since unlike SSTable keys those are not inherently ordered already.  This means that we only do M log N work sorting the memtable keys where M is the number of keys we actually read, and N is the total number of keys, where a naive sort-everything-first iterator would be N log N.

This does not yet implement range queries spanning multiple nodes.

patch by jbellis; reviewed by Jun Rao for CASSANDRA-71

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@769874 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-71
f70a5a0c8cff203b17285494fbbd99176bbee649,"clean up anticompaction code a little.
patch by jbellis; reveiewed by Eric Evans for CASSANDRA-78

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@771339 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-78
fce0ee0d7b89576c7f49c2f24a90e8f26e10314a,"This changeset abstracts the logic for placing a flush on the queue into a new method, Memtable.enqueueFlush. enqueueFlush is called from both forceflush and put (when a threshold is exceeded), without the need to apply a special flushKey.  patch by Eric Evans; reviewed by jbellis for CASSANDRA-34

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@771926 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-34
7779df6ce4633752a0f6768da94627aee2162103,"This patch adds ColumnFamilyStore.forceflush to the mbean so that it can be activated through the management agent.  patch by Eric Evans; reviewed by jbellis for CASSANDRA-34

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@771927 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-34
f17487c541dfae03858ae703015d4049094a0f55,"A make hint generation include a real timestamp so we can do meaningful deletes
 B call removeDeleted on the data we read locally to purge tombstones
 C because of (B) any supercolumn w/o subcolumns simply won't exist so we know we can skip re-deleting the endpoint data. so deleteKey becomes deleteHintedData.
 D because deleted data is not immediately purged, increased the scheduled interval from 20min to 60 to reduce the load of scanning the hint CF.

patch by Jun Rao and jbellis for CASSANDRA-34

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@771934 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-34
8dcf76ab27f9c7ac615fbaf5cd17fdfbd17cb9be,"tombstones take priority over non-tombstones w/ the same timestamp in supercolumn and column.  this makes HH management deterministic.
patch by jbellis; reviewed by Jun Rao for CASSANDRA-34

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@771935 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-34
362f287c84f19ae5cdd774f2fc013db5339d49ec,"refactor IColumn.addColumn to remove redundant name parameter.  patch by Sandeep Tata; reviewed by jbellis for CASSANDRA-96

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@772000 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-96
edacc67c266fc2bef360356d360f394ea9b46154,"remove unnecessary List creation in getSliceFrom and move close() cleanup for to the finally block.  patch by Jun Rao; reviewed by jbellis for CASSANDRA-201

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@779322 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-201
8f9e6a4516a58a8684886604b5c45c95e50f81ed,"To make available the Cassandra specific information available on the
node detail page:

- Exposed the existing StorageService.getLoadInfo()
- Created StorageService.getCurrentGenerationNumber() and added to
  MBean interface.

patch by Eric Evans; reviewed by jbellis for CASSANDRA-211

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@782629 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-211
b244a2e64527ea168dc4ac235933c23fb350ec09,"rename Table.doGC to forceCleanup.  patch by Eric Evans; reviewed by jbellis for CASSANDRA-211

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@782773 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-211
f685f4dec8ff0173394737cb7196b6bd2d111ed5,"expose compaction via JMX.  patch by Eric Evans; reviewed by jbellis for CASSANDRA-211

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@782774 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-211
72e6eea9e4ce1fcf30754534216586bcf9e7b041,"split sstable into data, index, and bloom filter files.  this allows us to avoid saving up index chunks
in memory until the sstable data is completely written, while still allowing fast scanning of the index
on startup.  it also simplifies the sstable/sequencefile code considerably.
patch by jbellis; reviewed by Jun Rao for  CASSANDRA-208

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@783077 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-208
cd2139ee7c91b2ed48afc98202d79e864db3e450,"system.exit on oome.  patch by jbellis; reviewed by Eric Evans for CASSANDRA-218

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@783388 13f79535-47bb-0310-9956-ffa450edef68",['CassandraDaemon.java'],CASSANDRA-218
01adb7a1aa008372423e4549f9e59bba79c560ca,"add nodeprobe cli tool.  patch by Eric Evans; reviewed by jbellis for CASSANDRA-211

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@785178 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-211
a116ef72e850b6e6830938003ae34681384a8948,"rethrow IOException with more details.  patch by jbellis; reviewed by Jun Rao for CASSANDRA-202

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@786025 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-202
a0c2b2a3809152591d5c5b89fd4b6f1c0a5c9108,"add CommitLog and RecoveryManager tests.  patch by jbellis; reviewed by goffinet for CASSANDRA-237

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@786243 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-237
9aeef94db8309764fa241b92c8ee92380e39cafa,"Pass and write table parameter as needed throughout the codebase to add multitable support.
(Many places cheated and just assumed that tables.get(0) was the only table.)
Patch builds but does not yet pass tests.

Patch by goffinet; reviewed by jbellis for CASSANDRA-79

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@787403 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-79
cc373761dc025711eeb7c35bc64fe0881654d255,"cleanup of table.open.

patch by jbellis; reviewed by goffinet for CASSANDRA-79

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@787405 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-79
5ccebd43c920619928d7e890d7593247e9f77ef9,"fix columnfamily id generation in the face of multiple tables and rip out TableMetadata serialization, which only complicates things needlessly.

patch by jbellis; reviewed by goffinet for CASSANDRA-79

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@787406 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-79
509cbb85de257a9c67311c7dd2fea18ed1b8f096,"remove table_ from CommitLog and add multitable tests.
patch by jbellis; reviewed by goffinet for CASSANDRA-79

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@787407 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-79
d48d8fcbf781e8745b81d5f0ccb8e1b10976c560,"r/m unused code dealing with sstables, and ConcurrentWriter / FastConcurrentWriter.  mmap is not faster than write() for sequential I/O, which is what the vast majority of our writes are.  mmap _does_ have an advantage when we seek back to the start of a commitlog segment to update the headers after memtable flush, but we do that infrequently enough that it's not worth the disadvantages (primarily, blowing up if we exceed the 4MB size).
patch by jbellis; reviewed by Eric Evans for CASSANDRA-224

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@787758 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-224
a2f9b401830fa2edddc3ffaaadeb6c4433a33f9a,"refactor read-only constructor to SSTable.open
patch by jbellis; reviewed by Eric Evans for CASSANDRA-224

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@787759 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-224
2493c9a5651a72aa4c36ff0f080ee3f6c6978dc8,"encapsulate sstable index
patch by jbellis; reviewed by Eric Evans for CASSANDRA-224

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@787760 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-224
2f322a8bd0a716b6010594ba4bb7cba9019a6ebc,"encapsulate sstable bloom filter
patch by jbellis; reviewed by Eric Evans for CASSANDRA-224

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@787761 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-224
f9a1343d92237e6a9553a4fd96db0208b6789126,"make static methods of SSTable that take a filename and then use the cache to grab an sstable object, simple non-static methods instead
patch by jbellis; reviewed by Eric Evans for CASSANDRA-224

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@787762 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-224
5cdc75d7603d1051c9d78d6ee11dd9cd44056f44,"move Hints cf to SYSTEM_TABLE
patch by jbellis; reviewed by Jun Rao for CASSANDRA-235

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@788142 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-235
682736ee5ebf33ed344abd1c6e04dc408a07bfe6,"r/m recycle cf and undocumented/incomplete Loader code using it
patch by jbellis; reviewed by Jun Rao for CASSANDRA-235

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@788143 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-235
81dd8ee5f6e224c550bdf956e0bec3ec2c92cbee,"use normal Table for system metadata
patch by jbellis; reviewed by Jun Rao for CASSANDRA-235

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@788144 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-235
b516ce8176c4ff90f4f1696aba9315941b67f0d0,"DBManager obscures rather than clarifies what is going on.  Remove it.

At some point we stopped calling DBManager.instance(), so Table.onStart was
not getting called.  Move that into CassandraDaemon so we don't rely on a side
effect to run it.

patch by jbellis; reviewed by Jun Rao for CASSANDRA-235

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@788145 13f79535-47bb-0310-9956-ffa450edef68","['CassandraDaemon.java', 'StorageService.java']",CASSANDRA-235
064a59cdb00361c6b92ce098922b87357cae7736,"cleanup CFS.onstart
patch by jbellis; reviewed by Jun Rao for CASSANDRA-235

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@788146 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-235
4e7f8deac0b4cfdbb24b6b8a304ca5bd289454fe,"switch to passing a single filename to open an sstable for writing.  this makes open-for-read and open-for-write consistent.

patch by jbellis; reviewed by Eric Evans for CASSANDRA-254

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@788473 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-254
261340a3425343c02970082ab6a5248a0d1d84c3,"r/m http server (use cli, nodeprobe, jmx as necessary instead).
patch by jbellis and Eric Evans for CASSANDRA-211

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@788892 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'MessagingService.java', 'StorageService.java']",CASSANDRA-211
0172497ad24e4b31ce4e70fee8bc69def99a9fe6,"minor code cleanups.  patch by Edward Ribeiro; reviewed by jbellis for CASSANDRA-273

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@791059 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-273
cdd8b170628176924c21db1cb6dcbecf4c7f2148,"add offset support to get_slice.  patch by Jun Rao; reviewed by jbellis for CASSANDRA-261

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@791553 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-261
26aefa2f4a04083c42f5338eda24a5bb09ab04ed,"encapsulate bloom filter access into sstable.getPosition
patch by jbellis; reviewed by Jun Rao for CASSANDRA-259

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@791589 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-259
013d59fc00d7d241abdf5bc0448ce55425c5f112,"add concurrentlinkedhashmap cache and config option.  config option is NOT yet wired up to control cache sizes.
patch by jbellis; reviewed by Jun Rao for CASSANDRA-259

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@791590 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-259
d6c0b0f2596de169186d3584474d8d5a34c3c9de,"refactor sstable into SSTable, SSTableReader, and SSTableWriter.
patch by jbellis; reviewed by Jun Rao for CASSANDRA-259

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@791591 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-259
b54de30a0226daafaa6ecf0257371e6e8c2a0742,"per-table key cache size.
patch by jbellis; reviewed by Jun Rao for CASSANDRA-259

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@791592 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-259
e324ef90519ffe2b9068ad852c8115ff8a7a1075,"disallow specifying ColumnSort on supercolumns.  patch by jbellis; reviewed by Evan Weaver for CASSANDRA-251

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@791598 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-251
23fa1bc0bd52c3167dbaaea40a94f16f9a823c73,"combine range version of get_slice into get_slice itself.
patch by jbellis; reviewed by Michael Greene for CASSANDRA-277

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@791872 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-277
4e3a4404c9e19d41db4de4f6c4bf85404e514c7f,"spelling fixes.  patch by Michael Greene; reviewed by jbellis for CASSANDRA-281

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@792126 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-281
7762e06571fc3ab1164c5e45d61e4cd03648a96c,"rename lock_ -> sstableLock_.
patch by jbellis; reviewed by Jun Rao for CASSANDRA-287

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@793051 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-287
4d1395e0fa7e96c2540bd2aff00dadaa68b57c34,"refactor out QueryFilter, SliceQueryFilter.
patch by jbellis; reviewed by Jun Rao for CASSANDRA-287

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@793052 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-287
48093358fb9022947592813a6aae43db148847ca,"replace namesfilter with NamesQueryFilter.  mv filter code into separate package.
patch by jbellis; reviewed by Jun Rao for CASSANDRA-287

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@793053 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-287
dd4f4be2b426361b1c50b784f8e3c6557e765497,"add IdentityQueryFilter and finish removing IFilter.
patch by jbellis; reviewed by Jun Rao for CASSANDRA-287

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@793055 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-287
4b4459c0d1aef5d22477755c2d20083fc3c51012,"r/m ZooKeeper vestiges.  patch by Michael Greene; reviewed by jbellis for CASSANDRA-291

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@793691 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-291
ff764ff22b488206bf102a0155e55de85efd8aa9,"r/m offset from slice api; we could live with being inefficient but not with breaking read repair.
patch by jbellis; reviewed by Evan Weaver for CASSANDRA-286

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@794474 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-286
715b60d14776bc892a31fbc13c7afc81da013ee4,"fix not including tombstone-only keys in keyRange.
patch by jbellis; reviewed by Evan Weaver for CASSANDRA-286

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@794475 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-286
e425474af2e08dd4a54db2316cb6758f972fa778,"add get_slice for supercolumn, tests.  add back updated TimeSortTest.  we need to pass gcBefore to the filters so Slice can count correctly.
patch by jbellis; reviewed by Eric Evans for CASSANDRA-303

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@796129 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-303
985d96a52ca9abe2a5e7522435aa488bb1f9505a,"rename DD.getType -> getComparator
patch by jbellis; reviewed by Eric Evans for CASSANDRA-304

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@796130 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-304
b866f81415e160bc7669250e531035b4dc976988,"add SubcolumnCompareWith option and subcolumnComparator code.
patch by jbellis; reviewed by Eric Evans for CASSANDRA-304

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@796132 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-304
cf01ea1c49f1168292cca9faa860617ab973334e,"Return standard/super designation to introspection and fix typo in DD.  patch by Michael Greene; reviewed by jbellis for CASSANDRA-314

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@797209 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-314
38d81587acfff4e97e632967ff86e05c3e6d6492,"finish snapshot support.  patch by Sammy Yu; reviewed by jbellis and Michael Greene for CASSANDRA-279

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@798228 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-279
d76bbca3e2f3572ad83daa8de3db40560148de9e,"add ConsistencyLevel Thrift enum to avoid client having to compute quorum size. patch by Sammy Yu; reviewed by jbellis for CASSANDRA-300

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@798298 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-300
acd50bd901367f6506495580d5c11b9bf0be2b67,"add ConsistencyLevel parameter to read ops.  patch by Sammy Yu; reviewed by jbellis for CASSANDRA-232

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@798390 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-232
8588982b85aad50e480b7816fd5630ed1bf09423,"combine switchMemtable and enqueueFlush so that they always operate on the same object.  move forceFlush guts from MT to CFS since it encapsulates better there
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-320

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@798935 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-320
51dbca6927af69fd8f116910c5288ff2a0a6b6ec,"Pluggable replicaplacement, endpointsnitch classes.  patch by Sammy Yu; reviewed by jbellis for CASSANDRA-323

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@799043 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-323
56a846ba1c4eedefb39b3c82903d92a1e37ecc37,"Pluggable replicaplacement, endpointsnitch classes (take 2).  patch by Sammy Yu; reviewed by jbellis for CASSANDRA-323

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@799065 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-323
572b5f852dc20d954100a75f6029418873bf198d,"table -> keyspace
patch by jbellis; reviewed by Michael Greene for CASSANDRA-271

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@799140 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'CassandraDaemon.java', 'NodeProbe.java']",CASSANDRA-271
edf2226079d61a0e23f803bc3f064b9e360fb141,"add CompareSubcolumnsWith to describe_keyspace.  patch by Evan Weaver; reviewed by Michael Greene for CASSANDRA-326

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@799320 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-326
70ce402fddc5361d249d161ba119f3fd2784cced,"Make range queries continue on the next node when necessary.
Patch by Arin Sarkissian; reviewed by jbellis for CASSANDRA-212

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@799684 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-212
22dc26bb9d1527c187df3a57d40655c646fd4dd6,"make CommitLog use a raw BufferedRandomAccessFile instead of overloading AbstractWriter/IFileReader unnecessarily.  the set of AW features used by both CommitLog and SSTable was nil.
patch by jbellis; reviewed by Stu Hood for CASSANDRA-330

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@799942 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-330
c31d44ae89c6c723eb9eaa23b082674f8f4aa9a6,"move next, getColumnGroupReader out of SSTableReader.
patch by jbellis; reviewed by Stu Hood for CASSANDRA-330

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@799943 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-330
0f95411c030f89dd4274cc4e9fdd14b1fda32b2e,"r/m SF.next(DataOutput) in favor of more-efficient IteratingRow.
patch by jbellis; reviewed by Stu Hood for CASSANDRA-330

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@799944 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-330
d1f4234d26ba7289233df9245a54774be551186b,"r/m SequenceFile. ColumnGroupReader moved to SSTableSliceIterator mostly unchanged for now. (finish cleaning this up in #332)
patch by jbellis; reviewed by Stu Hood for CASSANDRA-330

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@799949 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-330
45514cf1be89387be5779e9cc1c142ea95093eef,"remove AbstractWriter. all it was providing was append methods, which are inlined into SSTableWriter now; the rest was all wrappers. also, rename some variables in SST/SSTW.
patch by jbellis; reviewed by Stu Hood for CASSANDRA-330

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@799950 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-330
b6858825356dab747ed44b3a59e8740213fa43cc,"renames and cleanup for bootstrap-related code.
patch by Sandeep Tata; reviewed by jbellis for CASSANDRA-213

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@800440 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'MessagingService.java']",CASSANDRA-213
07330c1cfa4fb83a0f7d455d01858cec90b66c21,"brings findbugs count from 266 -> 250 bugs by fixing some scopes, removing some dead code, and not implementing Serializable unnecessarily.  patch by Michael Greene; reviewed for CASSANDRA-338 by jbellis

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@800547 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-338
6c492310278bb83853542992ce9b7d523a180a9a,"Bootstrap code + tests.  Patch by Sandeep Tata; reviewed by jbellis for CASSANDRA-213

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@800561 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-213
939709f977311add1cdc89cdd51bb19dc694d8f7,"fix NPE on iterator close.  patch by jbellis; reviewed by Chris Goffinet for CASSANDRA-341

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@801047 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-341
88b0ee7be461abf54236eda862920e9f006b9855,"fix more findbugs complaints.  patch by Michael Greene; reviewed by jbellis for CASSANDRA-338

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@801228 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-338
449a444c7d1cfa13e1a7d25865227e1ba8c300e2,"fix range query buglet; add debug logging
patch by jbellis; tested by Mark Robson for CASSANDRA-348

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@801676 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-348
cb0e6a348ff026b25a813bc19c705c15e212652e,"human-readable error for bad CommitLogSyncDelay.
patch by jbellis; reviewed by Eric Evans for CASSANDRA-349

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@802092 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-349
9a9371d1efd93117b16bda9caf48238a9001c75c,"include index and bloom filter in snapshots.  patch by Sammy Yu; reviewed by jbellis for CASSANDRA-353

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@802093 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-353
fba03ce69122e7a1bd6f2d5709eaa06c1ada0bc1,"move getKeyRange to CFS, where it encapsulates better.
patch by jbellis; reviewed by Eric Evans for CASSANDRA-345

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@802098 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-345
8a9c25ae0e849409a752b4d6eaf5a9bfbb3b3ca0,"- switch from trying to get the next endpoint by increasing offset to asking tokenMetadata for ""the next
one."" this will always be correct where the offset approach will not (usually you want offset to just be 1,
but sometimes you have to keep increasing it if no results are found but the range is still not finished)
 - merge results differently when the endpoint responsible for where the ring wraps is involved, since
that endpoint can hold keys from both the beginning and end of the range.

patch by jbellis; tested by Mark Robson for CASSANDRA-348

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@802180 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-348
e24925d49ee4301bab9791884f79a474fcbae3fd,"add SSTableWriter buffer size option; increase default.
patch by jbellis; reviewed by Sammy Yu for CASSANDRA-339

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@802185 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-339
d748648b235bd7dc95bfb2672ee156e0eb132bd8,"fix broken casts.  patch by Bill de hOra; reviewed by jbellis for CASSANDRA-338

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@802267 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-338
9d6f4752b6353c1374469fa78649b9bcda1e2e46,"reduce buffer sizes for test suite since it forces lots of small flushes.  reduces NameSortTest from ~30s back to < 10s.
patch by jbellis for CASSANDRA-339

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@802276 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-339
cee37599f6526b9a33df3d2d8d9d87315af0f7c5,"rename, clean up collectColumns methods
patch by jbellis; reviewed by Evan Weaver for CASSANDRA-356

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@802826 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-356
ceb4a10808a25fa7b9a20ad113242e8c4ab6ad76,"use the existing collectReducedColumns api to make subcolumn slices conform as expected to filter semantics
patch by jbellis; reviewed by Evan Weaver for CASSANDRA-356

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@802827 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-356
bf6236ddf661ebb896c069daf930abe3e9bb3b35,"CASSANDRA-241 optional support for framed transport

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@802898 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-241
6b7a1c300f0d59ad689767307cffd0e9ef3b8523,"switch ""!isAscending"" for ""reversed.""
patch by jbellis, Carl Bystrom, and Bill de hOra. reviewed by Eric Evans for CASSANDRA-311

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@802953 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-311
480650b8264162fa9ee18584c00f78609266d602,"fix typo breaking CompareSubcolumnsWith.  fix timeuuid compare with byte[0].
patch by jbellis; reviewed by Evan Weaver for CASSANDRA-357

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@802977 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-357
7ea2c96852f1b3f4fceda17a70cb2ccbc95060e7,"add settings for buffer sizes; make unconfigurable ones more sane.
patch by jbellis; reviewed by Jun Rao and Eric Evans for CASSANDRA-355

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@803135 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-355
850e86544004bdddd31fd63d62525412e1f47ce7,"use CFS executor for BMt flushes.
patch by jbellis; reviewed by Eric Evans for CASSANDRA-337

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@803211 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-337
ac414f9a52f9ffb023cf3690cd782e4ecb976140,"add back read latency stats for CFS.getColumnFamily.  patch by Sammy Yu; reviewed by jbellis for CASSANDRA-359

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@803240 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'NodeProbe.java']",CASSANDRA-359
a461792de9bf885b205686161161c2b62294be25,"Move CFSerializer into its own file.  Rename deserializeEmpty to deserializeFromSSTableNoColumns; add serializeForSSTable and serializeWithIndexes to do the without-metadata serialization.  Add SSTableReader.makeColumnFamily to create the CF skeleton w/o reading any data.
patch by jbellis; reviewed by Sandeep Tata for CASSANDRA-233

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@803284 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-233
3ec8258db67ef4c5afc35e71ca63435681cf9e87,"expose threadpool's pendingtasks via nodeprobe.  patch by Sammy Yu; reviewed by jbellis for CASSANDRA-360

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@803285 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-360
cd66ac83260f8479d90317f93a116226d3cf564e,"CASSANDRA-361 cleanup left-over references to Cql

Patch by Michael Greene (+ regeneration of thrift code); reviewed
by eevans for CASSANDRA-361

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@803355 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-361
ddf00a509a4793bc69bf11cf10cc8155a9371f2d,"give up on trying to optimize startWith -- it's basically impossible when replication factor > 1 b/c of the range wrap point.
patch by jbellis; tested by Mark Robson for CASSANDRA-348

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@803716 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-348
7158863861cf16d65bc4244b8c787375b29cbe5d,"Fixes for saving Token in SystemTable.  patch by jbellis and Sammy Yu for CASSANDRA-362

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@804045 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'SSTableReader.java']",CASSANDRA-362
eb886e99995713f3ed563142107e765f880a4fcc,"make StorageTable.StorageMetadata a singleton, so multiple initMetadatas are safe.
patch by Bill de hOra and jbellis; reviewed by Michael Greene for CASSANDRA-358

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@804372 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-358
8a72a27cf199e8f810c6c84d48775fcf3df9cfcb,"rename underscores away
patch by jbellis; reviewed by Sammy Yu for CASSANDRA-364

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@806015 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-364
e959b2c7f6d78b51492c5e7b19beb30c36e75987,"rename getInitialToken to getToken; it doesn't actually have anything to do w/ initial or default tokens.  log token on startup.
patch by jbellis; reviewed by Sammy Yu for CASSANDRA-364

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@806016 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-364
c0df773c99cf8b65a735870a02ca90995304b460,"add getPendingTasks to CommitLogExecutorService
patch by jbellis; reviewed by Michael Greene for CASSANDRA-369

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@806030 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-369
d7e492410a5649c3c25357f3d61f1a809a5880e1,"remove authorship comments.  patch by Michael Greene; reviewed by jbellis for CASSANDRA-379

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@806032 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-379
51401247c1a2e00638aa3f12a0e924ff85e49ab6,"remove groovy jar, half-baked Callout code.  patch by Michael Greene; reviewed by jbellis for CASSANDRA-380

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@806267 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-380
3917094f04a76878c56947e745154c708ff99632,"allow blocking write to create hints if not enough of the ""correct"" nodes are live, but enough are to fulfil the requested consistency level.  patch by Sandeep Tata; reviewed by jbellis and Michael Greene for CASSANDRA-383

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@807305 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-383
6690c5135943b2d15155a92fa9bc4d7f46fc8cdc,"Update AsyncResult to know when it started waiting so you can get() multiple Results in serial but have them wait in parallel.  Use this to implement multiget methods.  Remove unused MultiAsyncResult code and StorageProxy methods using it.
Patch by Chris Goffinet; reviewed by jbellis for CASSANDRA-70

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@808589 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-70
dc794169b8ffdce004036568619bd27b590ee1b9,"Fixes to make BinaryMemtable useful.  Highlights are configurable threads for [binary]memtable flushing and flushAndShutdown JMX/nodeprobe directive.
patch by Chris Goffinet; reviewed by jbellis for CASSANDRA-337

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@808942 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'MessagingService.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-337
86abfe10279ce957e3dad221b2ca6e58eea1758d,"r/m special case of local destination when writing with ConsistencyLevel.ZERO, since it causes blocking for commitlog.  (MessagingService still optimizes out the network write/read.)  Patch by Chris Goffinet; reviewed by jbellis for CASSANDRA-399

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@809216 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-399
eb83251bda8caedd69d07f1f7aa8857a27f87fe9,"r/m unnecessary IReplicationStrategy interface.  r/m LoadVerbHandler and unused endpoint-related code.  rename AbstractStrategy -> AbstractReplicationStrategy and getEndpoint methods.
patch by jbellis; reviewed by Sandeep Tata for CASSANDRA-393

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@809586 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-393
35cd1761f69be5849515994f02f07478cd2cf249,"change default comparator to BytesType
patch by jbellis; reviewed by Chris Goffinet for CASSANDRA-400

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@809645 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-400
781dfe4b6bdaa81ea7c0304d521c33b12dbb7cc9,"allow setting the logging level at runtime via mbean.
patch by jbellis; reviewed by Eric Evans for CASSANDRA-402

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@809746 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-402
ab392a6ee7db31fe7a4cf8093e7308057cd47493,"remove buggy concurrentlinkedhashmap library and lru cache.  too late in 0.4 to try to debug the library -- will revisit for 0.5.  patch by jbellis; reviewed by Chris Goffinet for CASSANDRA-405

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@810540 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-405
8be0d7de6a8a5862be23d1733a458592b1f55946,"CASSANDRA-414 combine addToList and storeLocation; rename to addSSTable

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@812161 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-414
dec8490e5ee399beb93e02fe269c51bdbfd4e7de,"clean up inaccurate comments; remaining double-increment code.
patch by jbellis; reviewed by Sammy Yu for CASSANDRA-418

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@812163 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-418
7bfe8df549c5bd2761801e3616f7c08db1fc5fbd,"Revert ""remove sstableLock.  re-order a few ops so that we can never ""lose"" data temporarily -- always remove old sstable references _after_ adding the new ones.  so at worst a few read ops will merge data from an sstable that is obsolete -- this is ok and better than Stop The World locking""
and ""CASSANDRA-414 combine addToList and storeLocation; rename to addSSTable""

These were works in progress (and broken); accidentally committed w/ the 418 fix.

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@812164 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-414
71b3b3c7364445ed508a8ee52050ca39b9c5de66,"fix compaction bug -- only one of the SSTR constructors was adding to openedFiles.  (fixes regression from #413).
patch by jbellis; reviewed by Eric Evans for CASSANDRA-425

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@812230 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-425
95e7ed26bb9030cd0e6ef0ca455c1971e4d71186,"r/m unused BUFSIZE
patch by jbellis; reviewed by Eric Evans for CASSANDRA-424

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@812639 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-424
d1674646482a2f8f67e2e575242a85c6c4fee350,"rename getIndex -> getGeneration
patch by jbellis; reviewed by Eric Evans for CASSANDRA-424

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@812640 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-424
40c154ab4b3d8f31eedd47ebd6005db70564a3f6,"make compaction code use SSTableReader objects.  r/m SSTableReader.get static method
patch by jbellis; reviewed by Eric Evans for CASSANDRA-424

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@812641 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-424
4da540024a429f0c0a3f73161086d1f7997d5b95,"combine addToList and storeLocation; rename to addSSTable
patch by jbellis; reviewed by Chris Goffinet for CASSANDRA-414

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@813542 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-414
87bd4a24a42fd990ed4ea881cf5bbaf3c8e7e0cb,"convert ssTables_ to a Set, since the filename is encapsulated in the SSTR object now
patch by jbellis; reviewed by Chris Goffinet for CASSANDRA-414

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@813543 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-414
bee816c68a81b0812959c5f58e393e0b167a287f,"Replace sstableLock with SSTableTracker, which performs updates to the sstable list atomically
without readers ever having to block.  (Readers will always either see the old list, or the new.)
We avoid a race on the delete of the old SSTable files on-disk by using a ReferenceQueue:
when the last reference is gone, a PhantomReference is added to the queue and can do cleanup.
In case Cassandra is killed between compaction and this cleanup, a -Compacted empty file
is written to disk; Cassandra removes any files thus tagged on startup.

patch by jbellis; reviewed by Chris Goffinet for CASSANDRA-414

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@813544 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-414
39982f3649705623edb8593c7b6cb5665c156f48,"make anticompaction return a list of the split-out sstables, instead of a mostly-useless boolean
patch by jbellis; reviewed by goffinet for CASSANDRA-431

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@814756 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-431
91acae3dfb4a3e8550ca024b91957f695337c6d0,"Fix deserialization bug in TokenUpdateVerbHandler; change TokenUpdater to update one node at a time, and add bin/tokenupdater as a convenience.  Patch by Sammy Yu; reviewed for CASSANDRA-363 by jbellis

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@815373 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-363
effc0ecee398ea3978623a6d0c0a5e115f15cbfa,"add mbean to get/set compaction thresholds.  patch by Sammy Yu; reviewed by jbellis for CASSANDRA-447

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@815497 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-44
0c84342d3ab4dec0c528c814eced4f9cad3affcc,"rename MinorCompactionManager -> CompactionManager.  patch by jbellis for CASSANDRA-447

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@815498 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'NodeProbe.java']",CASSANDRA-44
bb5a2700d7189de187e732d1fcc9ea65e3b95ae6,"minor fixes
patch by jbellis; reviewed by goffinet for CASSANDRA-436

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@816379 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-436
254e6a2c237506198820e5837cbb06766852cb17,"copy FileStruct to SSTableScanner and remove cruft.  Migrate getKeyRange to new scanner class.
patch by jbellis; reviewed by goffinet for CASSANDRA-436

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@816380 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-436
a45bb97cc09835a2d8d073f4811c38e86d2e533a,"allow ReducingIterator to reduce from one type to a different one
patch by jbellis; reviewed by goffinet for CASSANDRA-436

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@816381 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-436
b618106f3cd55a7fb4f2fd2b3aa7da7715cdc034,"Replace PriorityQueue mess with a CompactionIterator that efficiently yields compacted Rows from a set of sstables by feeding CollationIterator into a ReducingIterator transform.  (""Efficiently"" means we never deserialize data until it is needed, so the number of sstables that can be compacted at once is  virtually unlimited, and if only one sstable contains a given key that row data will be copied over without an intermediate de/serialize step.) This is a very natural fit for the compaction algorithm and almost entirely gets rid of duplicated code between doFileCompaction and doAntiCompaction.
patch by jbellis; reviewed by goffinet for CASSANDRA-436

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@816382 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-436
4b721abdf38cd2ab5dc3e3db311d4d0811eed9df,"commitlog may consider writes flushed, that are not yet; patched by junrao; reviewed by jbellis for CASSANDRA-445

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@816453 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-44
6e709a28633813d730170c2d6911b63419c73550,"move per-key locking inside Memtable and shard it.
patch by jbellis; reviewed by junrao for CASSANDRA-444

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@816744 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-44
c8cb217548173fe7424b92dee438e7b5bc90723a,"cleanup; r/m unused code
patch by jbellis; reviewed by junrao for CASSANDRA-444

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@816746 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-44
767e0235b0ce6c6cbbf6a1912ba96d3e202e3f40,"r/m memtableLock; it is redundant wrt flusherLock
patch by jbellis; reviewed by junrao for CASSANDRA-444

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@816747 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-44
aee7b0c4df80b88f8a4ed06d61be55f478c08b25,"Consolidate BMT threshold and object count sizes into getMemtableSize() and getMemtableObjectCount().  patch by Chris Goffinet; reviewed by jbellis for CASSANDRA-433

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@817265 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-433
1c547a2aa9bfc8ed536ddd875be88de887b39909,"support multiple flush threads safely.  automatically use up to avaiable core count threads for flushing.  pause updates when too many unflushed memtables are generated.
patch by jbellis; reviewed by goffinet for CASSANDRA-401

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@817925 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-401
e279ccd874bedc79d61512ebfa2a62b4b2a03084,"clean out unused code from MessagingService. Inline sink processing into sendOneWay instead of having another executor for that.
this sets the stage for backpressuring the client, should we choose to do that
patch by jbellis; reviewed by goffinet for CASSANDRA-401

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@817926 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-401
767467724a5191b10b1bbc5f19951afa19f18ecc,"r/m unused commitlogcontext arg to flush. synchronize getTempSSTablePath
patch by jbellis; reviewed by goffinet for CASSANDRA-401

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@817927 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-401
d7bd37af1531087f5343c3af636b7699c4687a79,"clean up ThreadFactoryImpl and rename to NamedThreadFactory
patch by jbellis; reviewed by goffinet for CASSANDRA-401

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@817928 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'MessagingService.java', 'StorageService.java']",CASSANDRA-401
93df28fcb4b61a61186852cbdaf77f24aa199808,"split flusher executor into flushSorter and flushWriter.  This is because sorting is CPU-bound, and writing is disk-bound; we want to be able to do both at once.
patch by jbellis; reviewed by goffinet for CASSANDRA-401

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@817929 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-401
1d0cf136f6871730c663db143ada9a9b66034286,"remove unused skip argument from anticompaction. change HHM to perform a major compaction instead of anticompaction since that's really what we want there
patch by jbellis; reviewed by junrao for CASSANDRA-454

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@818517 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-454
d309c5dc7723b023ed12eeb6ae331747695c6ee1,"record gossipped enpoint/token pairs as we see them.  also clean up SystemTable code to avoid unnecessary CF fetches.  patch by Gary Dusbabek and jbellis for CASSANDRA-437

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@818712 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-437
aee70135ef001ee13d3aa3f3da5e0d1da7183699,"r/m unnecessary SortedFlushable class.  Keeping a 2nd reference to the Flushable in question,
when it is only used to pass back to that Flushable for the write phase, was unnecessary & confusing.
patch by jbellis; tested for CASSANDRA-458 by Teodor Sigaev

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@819125 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-458
de8318315f51a1cc5d8d0e7c7535c0290870a742,"Replace DebuggableScheduledThreadPoolExecutor with non-Scheduled Executors and Timers.  This allows logging exceptions from repeated tasks, which is basically impossible with STPE.
patch by jbellis; reviewed by Jun Rao for CASSANDRA-455

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@819665 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-455
60839fea8577a135b623c3dcc002351137c7fb45,"fix tests
patch by jbellis for CASSANDRA-459

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@819827 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-459
f48c5b612af2f73e3fa5a4ddc0732b9eabbd3513,"formatting + cleanup.  patch by jbellis for CASSANDRA-462

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@820417 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-462
ce27422729599086dffb197608ddf3e8c4b541cf,"logging for digests.  patch by jbellis for CASSANDRA-462

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@820418 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-462
a917588bb26c3007cbde435542bdf6fa1d0c2a64,"add MemtableFlushAfterMinutes, a global replacement for the old per-CF FlushPeriodInMinutes setting
patch by jbellis; reviewed by junrao for CASSANDRA-463

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@821127 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-463
370082fae4899f3cb65862491f8a940d675eee98,"fix heisenbug in RecoveryManager2Test where a compaction could add back a new sstable to the ""cleared"" ColumnFamilyStore
patch by jbellis; reviewed by junrao for CASSANDRA-463

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@821128 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-463
67ae1ee58928114a11e3d47d20176a8e69e7086b,"Use DecoratedKey objects in Memtable, SSTableReader/Writer objects.
patch by johano; reviewed by jbellis for CASSANDRA-446

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@821134 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java', 'StorageProxy.java']",CASSANDRA-44
becb0b1c7ab966572843da6ddbe665ef3c107e65,"clean up loadinfo and SLB
patch by jbellis; reviewed by Eric Evans for CASSANDRA-385

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@822787 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-385
ece6e6d4592ff68e8153770160d3c8e20a058591,"move javadoc into mbean.  inline methods where wrapping is not necessary to satisfy Demeter
patch by jbellis; reviewed by Eric Evans for CASSANDRA-385

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@822789 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-385
d1a8e1322fd5580e4e4b1178257057718ee1209c,"use Strings instead of Endpoints in jmx methods. merge cluster info into ring.
patch by jbellis; reviewed by Eric Evans for CASSANDRA-385

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@822790 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-385
02a569e384b37f17049c3d2799738a3be1f556f2,"add getLoadMap jmx method; add load info to nodeprobe ring
patch by jbellis; reviewed by Eric Evans for CASSANDRA-385

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@822791 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-385
103a13c68f4deaaf1306b3ce7e371b7197c3bfb9,"get token on bootstrap that gives us half of the keys from the most heavily-loaded node. (the ""splits"" approach should also be useful for #342; adding it to Thrift is trivial)
patch by jbellis; reviewed by Eric Evans for CASSANDRA-385

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@822792 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-385
5e9b35cc8c056cbc36516f679fbd01314598675b,"rename getMessagingInstance -> instance; r/m unused methods from FBUtiltities
patch by jbellis; reviewed by Eric Evans for CASSANDRA-385

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@822793 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-385
fe1aa5b52ded59198f98d9d915276c04dad4a7cb,"rename LOCATION_CF -> STATUS_CF.  cleanup.
patch by jbellis; reviewed by Eric Evans for CASSANDRA-438

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@822875 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-438
ff3dd4dcec517e72b61e35d1b3bf19dd021a2da0,"add autobootstrap
patch by jbellis; reviewed by Eric Evans for CASSANDRA-438

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@822876 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-438
303951c4584cc6db4e71f404e4622dc2d07acf54,"r/m nodeprobe bootstrap
patch by jbellis; reviewed by Eric Evans for CASSANDRA-438

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@822877 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-438
3329f5ec9880e1008e48a70958b12d2bd2b52b64,"create new collection when reducing the number of sstables compacted; the lists returned by subList are unmodifiable
patch by jbellis; reviewed by goffinet for CASSANDRA-473

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@822878 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-47
294bfa9a2106feeb5ad94ef0819001a7ca05e292,"Added the ability to set maxthreshold to zero in nodeprobe, and added a special case to CF.doCompaction to not run compaction when its disabled. patch by goffinet; reviewed by jbellis for CASSANDRA-465

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@822931 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'NodeProbe.java']",CASSANDRA-465
ba98fa4797f43e12185bc1aad9d3fd878497b4c3,"Fail startup if <seeds> is empty.  patch by Sammy Yu; reviewed by jbellis for CASSANDRA-479

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@823264 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-47
6d070498beeba4d431a09043fd83abb96f5eff9d,"r/m undocumented term aliases in favor of a single 'comment' field.
patch by jbellis and Brandon Williams; reviewed by Michael Greene for CASSANDRA-481

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@823349 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-481
3e3ebc3fb39ef56da87661057359aa997f49e0ab,"expose additional metrics for executors.  patch by Sammy Yu; reviewed by jbellis for CASSANDRA-482

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@823562 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-482
51ec66cccbfc0d7ffbedac930475de5bb5a4b9a6,"move bootstrap-related code into Bootstrapper
patch by jbellis; reviewed by Eric Evans for CASSANDRA-477

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@823616 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-47
4a4b8bebf76e7b4bc494a020435277f47b0bcfaf,"fix regressions
patch by jbellis reviewed by Eric Evans for CASSANDRA-477

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@823617 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-47
735435be69a03a3c4506b50facd771316e1b355c,"add AutoBootstrap config option
patch by jbellis.  reviewed by goffinet for CASSANDRA-385

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@824007 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-385
1782c886fa051ea5e2708159d774c92c72c73883,"r/m unused attachContext.
patch by jbellis for CASSANDRA-478

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@824476 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-47
b0e6053b85e0f1bf2297c6839f87c0e7b52c1844,"add test catching regression; call removeDeleted during compaction.
patch by jbellis; reviewed by eevans for CASSANDRA-500

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@827761 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-500
93b0b062c2e6eaa36dda8a99da196d64e5c13871,"rename nodePicker -> replicationStrategy.
patch by jbellis; reviewed by Sandeep Tata for CASSANDRA-497

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@828028 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-497
7dbbca6698fdd14bae1de4a8a53a44ce21723434,"make write targets computable independent of replication strategy (i.e., make getReadStorageEndPoints the only method a Strategy needs to implement).  we do this by computing the token/endpoint -> Range[] map from the read endpoints, then using that to determine if a bootstrapping node needs to receive a write (if the token being written falls in any of its ranges).  Also, make the StorageProxy insert methods aware that bootstrap can entail having extra write targets temporarily, and include those in its consistencylevel calculations.
patch by jbellis; reviewed by Sandeep Tata for CASSANDRA-497

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@828029 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-497
d5eaa4e141ea830bbbacc7c249198e58169882e7,"Make EndPoint objects immmutable, so hashcode can't change (making the EndPoint potentially disappear from a map)
patch by jbellis; reviewed by Sandeep Tata for CASSANDRA-497

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@828030 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-497
c44e9d05ca1d2baf33333a90548d84bed230bec0,"r/m unused ""listening"" distinction in TcpConnection
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-498

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@828127 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-498
694a6115c7d3e45f2b448b308b10cce10b700442,"r/m uses of EndPoint(port) constructor; rename EndPoint methods to make porting easier; r/m gratuitous uses of getHost
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-498

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@828128 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-498
b767bf7e7d94fb8f81a784a97662a74816ec6754,"convert EndPoint to InetAddress (removes MembershipCleaner, the code to drop a node from the cluster entirely.  we're probably going to want to resurrect that at some point)
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-498

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@828130 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-498
26971fb3ffe3036a0d552a72f65a3c9f13a4153e,"CLHM, fixed version
patch by jbellis; reviewed by goffinet for CASSANDRA-423

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@828734 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-423
7518f7ce9f012cf5a5bbcf976a1590a1b5531db0,"all rows go through deserialize/removeDeleted so we can GC tombstones.
patch by jbellis; reviewed by junrao for CASSANDRA-507

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@828755 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-507
ed808be3d3fd6ac94ac242ab6a9fa17b9249ba0f,"fix regression recognizing local reads from 828148.
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-512

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@829136 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-512
d2c2365a78e52424a88baf30448c1148d1ee787e,"add dcquorum/dcquorumsync consistency levels, representing ""a quorum of the replicas in the current dc"" and ""a quorum of the replicas in each dc,"" respectively.
patch by Vijay Parthasarathy; reviewed by jbellis for CASSANDRA-492

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@829819 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-492
e006aa51b981ee7e7257de35feed0f14e77608cb,"r/m single-use executor in favor of a Thread
patch by jbellis; reviewed by goffinet for CASSANDRA-483

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@830210 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-483
ad01178e373756e90c136bac4d30a6a79ef140b9,"rename away underscores
patch by jbellis; reviewed by goffinet for CASSANDRA-483

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@830211 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-483
0287d0dd8749d7bbb0e8474b3b5d42f7a77b303a,"fix the bootstrap interaction with gossip; there were two main problems:
1) token and bootstrap state are not guaranteed to be gossiped together; since we only updated TMD.bootstrapNodes on an update of the token, this means we could actually miss the bootstrap notice
2) deletions of state are not actually supported by Gossiper; there is no concept of that at the protocol level. so if we delete state locally it will never get gossiped. Instead, we have a MODE that is either MOVING or NORMAL, corresponding to bootstrap & normal operation.

patch by jbellis; reviewed by goffinet for CASSANDRA-483

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@830212 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-483
160483cd19efcc51a66f361d3b015c32743eec81,"rename getRangeMap -> getRangeAddresses; add inverse getAddressRanges
patch by jbellis; reviewed by goffinet for CASSANDRA-483

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@830213 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-483
4856460f0e927761d8b321092c877092bce41569,"refactor bootstrap to only concern itself with bootstrapping the local node, which greatly simplifies things
patch by jbellis; reviewed by goffinet for CASSANDRA-483

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@830214 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-483
128cb03a5f3eb77b6015840f87ac6dc8bf01e0d9,"make BootStrapperTest use of TokenMetadata match actual BootStrapper use better.  patch by jbellis for CASSANDRA-502

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@830218 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-502
ccafdada1384428f42e3da3e9a507759ff170993,"fixes for DQ quorum code.  patch by Vijay Parthasarathy; reviewed by jbellis for CASSANDRA-492

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@831339 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-492
f170a9dfadbab924996e4ecaf1bf16f6a2f1bf10,"fix hinted handoff map computation
patch by jbellis; tested by Edmond Lau for CASSANDRA-524

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@831414 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-524
1794fbed23a83abb7c6285ecb69628f90382686f,"add updateForeignTokenUnsafe for bulk loader.  patch by goffinet; reviewed by jbellis for CASSANDRA-523

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@831433 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-523
4d256f66550c34d047d30faf3ac7392c2977b047,"scan on startup for orphaned filter and index files and remove them.
patch by Gary Dusbabek; reviewed by jbellis for CASSANDRA-432

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@832075 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-432
242fa0231bd74fe09454e67c10a4af651dd8c4e2,"CASSANDRA-522
convert replication strategy methods to multimap
patch by jbellis for CASSANDRA-522

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@832266 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java']",CASSANDRA-522
3678daa0be6e88821b3a61e20c78493d6f119449,"brute-force replacement of throwing maps around with encapsulated TokenMetadata
patch by jbellis for CASSANDRA-522

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@832267 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-522
46e5f23e1bb6cf374d0d89ecff40c84a1824b998,"fix NPE caused by getToken on endpoint that isn't member of ring yet.  add assert to prevent in the future.
patch by jbellis for CASSANDRA-522

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@832268 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-522
e946c6380637b10dc8ec9e257fbfdf47b175dfd3,"refactor getDefaultToken into default checking + getRandomToken.  Decorate OPP keys so we don't have to special case IndexedDKs for getSplits.
patch by jbellis and Vijay Parthasarathy for CASSANDRA-513

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@832272 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-513
98719aa7c68d102a3ec7555e08bb130bd275de3f,"don't removeDeleted on the whole CF before filtering what the request was for; it's expensive.  also, fixes subcolumn queries being counted twice in readStats
patch by jbellis; reviewed by gdusbabek for CASSANDRA-510

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@832797 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-510
538dc69515f517303c6ba19e6fdab35f8a25b2e4,"return clones of supercolumns from memtable so caller can't accidentally mutate them, fixing the failing test.

convert removeDeleted on SC to remove-oriented instead of clone-then-add-back to make this hurt performance less.

patch by jbellis; reviewed by gdusbabek for CASSANDRA-510

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@832798 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-510
63a0c9d6c79340b62354260652c7d8a533cebf49,"add onAlive, onDead methods to gossiper listener interface so listeners don't have to try to infer that by less accurate circumstantial evidence
patch by jbellis; reviewed by Jaakko Laine for CASSANDRA-527

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@832996 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-527
f77ec79a8b2b36a7928d13df7393509aa3859f97,"avoid flushing empty binarymemtable
patch by jbellis; reviewed by goffinet for CASSANDRA-532

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@833498 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-532
b3b58932f352a01c87bfe66590044c99d16b4a5f,"fix TODO in tokenmetadata (bootstrap tokens aren't part of the official ring now).  r/m redundant getNextEndPoint method in favor of getSuccessor
patch by jbellis; reviewed by Jaakko Laine for CASSANDRA-525

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@833576 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-525
d6977789cdfb66d80a4ec50a8541bb6807aff0c4,"split out onJoin from onChange, so we can pass a single ApplicationState object to onChange to emphasize that it gets called once per AS; rename ApplicationState.getState -> getValue
patch by jbellis; reviewed by Jaakko Laine for CASSANDRA-525

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@833578 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-525
5d447035ba19bd2a02fd6afe0acd2271aa3f4ce4,"containing isBootstrapping and BootstrapTokenAddress information in TokenMetadata is the wrong level of abstraction.  Switch to pendingRanges instead.
patch by jbellis and Jaakko Laine for CASSANDRA-525

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@833579 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-525
580ac7d7086d9dd7a448826e1475ba2efb09a12f,"clean out unused code from TcpConnectionManager; split connections to a node into ""command"" and ""ack"", which will allow us to use backpressure on the command socket.  patch by gdusbabek; reviewed by jbellis for CASSANDRA-488

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@834143 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-488
c9a6b7de3913f779a52d37d9e90954aed7b3b833,"check for live-ness and throw UnavailableException if quorum is unsatisfyable.
patch by jbellis; reviewed by Ray Slakinski for CASSANDRA-441

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@834164 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-44
d0db57ad10e09564e58753c789f01c006c0f2168,"move more generic streaming code into Streaming.java
patch by jbellis; reviewed by Jaakko Laine for CASSANDRA-435

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@834939 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-435
542accc65b7b89eff77b515068abc6cc6c6c26c6,"add leaving mode
patch by jbellis; reviewed by Jaakko Laine for CASSANDRA-435

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@834940 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-435
50b67f50af55f9a656b5e233caa751d5253bdcfa,"simplify getChangedRangesForLeaving.  patch by Jaakko Laine; reviewed by jbellis for CASSANDRA-435

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@834945 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-435
4c877f9124bc9734bc0e74bcc5074be3d98cf2c7,"parallelize post-recovery flushes.
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-539

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@834995 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-539
2b8c1cec9ac40273a1491ebd697caf8431dc83a2,"avoid making local node part of the token ring until bootstrap completes; fix other buglets
patch by jbellis; reviewed by Jaakko Laine for CASSANDRA-536

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@835213 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-536
0485f532a49b507b1e9eb5d0e9e8ffcc683d9ba5,"tokenMetadata should be updated before removing obsolete pending ranges, and unset bootstrapped flag when decommission is complete.  patch by Jaakko Laine and jbellis for CASSANDRA-435

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@835413 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-435
183f51dc2167a3ade932413505712543a690315e,"r/m unused bootstrap directory and ensure streaming files live to be streamed
patch by jbellis; reviewed by Jun Rao for CASSANDRA-538

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@835446 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-538
6ede8c5d91f334ff0e06197a3d1fbc4ec9480137,"fix misleading comment.  patch by jbellis for CASSANDRA-545

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@835873 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-545
f3cdaa96b70d3b1b558abeedd4a893a9ead30d01,"add Move command
patch by jbellis; reviewed by Jaakko Laine for CASSANDRA-541

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@835890 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-541
266e94f320b47532761bad3972e5e2a5a664ae70,"clean up temporary for-streaming files when done
patch by jbellis; tested by Ray Slakinski for CASSANDRA-550

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@835986 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-550
f31e5779de32ea6bd719620e718632712ecf4323,"make iterator closeable, again
patch by jbellis; tested by ""elsif"" for CASSANDRA-552

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@835999 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-552
050752c70360fe8cae9803f3db15dad2fec224fc,"Fixed multi-get to put localCommands onto the StorageService.readStage when a node gets commands to process, instead of running them serially. 
patch by goffinet, minor cleanup and review by jbellis for CASSANDRA-555


git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@836264 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-555
f1279e961829fce958df6e9e68742798562f4ec0,"add getSortedApplicationStates to preserve state ordering when re-gossiping to other nodes.  patch by Jaakko Laine; reviewed by jbellis for CASSANDRA-548

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@880772 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-548
f57ac0d95994f4a50c2f5ced2cf7937e85bfc932,"make local insert() skip MessagingService and fix HH write
patch by jbellis; reviewed by Jaakko Laine for CASSANDRA-558

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@881280 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-558
a5bd08f421c647c3a472d231b24ae0d0a7101b9e,"add WriteResponseHandler combining the important parts of QuorumResponseHandler and WriteResponseResolver.
In particular, not thate we (correctly) never send a write response of false, letting the timeout take care
of that should-never-happen case.  optimize local writes in insertBlocking, and fix HH.

patch by jbellis; reviewed by Jaakko Laine for CASSANDRA-558

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@881281 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-558
fc518cbb6a098f4f3adcd96a851155b4f6742349,"add primitive get_range_slice. inefficient, but better than get_key_range + get_slices.
patch by gdusbabek; reviewed by jbellis for CASSANDRA-344

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@881998 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-344
46a809eef9ea55de927514d6fc9067bf8ced2fc0,"expose TimedOutException distinct from UnavailableException
patch by jbellis; reviewed by gdusbabek for CASSANDRA-563

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@882248 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-563
eb32e2775162b0171ec45a4babec254d3ad09c2b,"check for listenaddress misconfiguration
patch by jbellis; reviewed by gdusbabek for CASSANDRA-298

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@882312 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-298
8ec9b7bd95c5e09227a67893a944945fd0a37707,"make members volatile where necessary to make double-checked locking safe.  patch by gdusbabek; reviewed by jbellis for CASSANDRA-248

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@882682 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-248
bae22eae6b81d79e035f43eedc012bb8bf09a9a1,"Modify move function to get balanced token at bootstrap time if token given as a parameter was null.  patch by Jaakko Laine; reviewed by jbellis for CASSANDRA-574

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@883405 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-574
5f343039334a5d89a0f3f78d77c7df373261ef18,"add RING_DELAY sleep to startBootstrap.  patch by Jaakko Laine; reviewed by jbellis for CASSANDRA-575

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@883474 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-575
cb3b171079f248370206218df9e0b6aa658225f8,"Moved leaving ring code to a separate helper function and call it right away if rangesMM is empty.  patch by Jaakko Laine; reviewed by jbellis for CASSANDRA-573

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@883854 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-573
7c4166444bdef1bd1d56f198e4a448f14f1bcab8,"r/m unused Row code, and move table variable into callers rather than serializing it redundantly
patch by jbellis; tested by Dan Di Spaltro for CASSANDRA-578

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@884331 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-578
994487d755250fb02125b28075aea3c3fb2685d7,"make Row contain a single, final CF reference
patch by jbellis; tested by Dan Di Spaltro for CASSANDRA-578

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@884332 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-578
95cbb3461ad9fc66969f9f8338b686b0f50d9a9a,"allow serializing null CF; add get_range_slice test exercising this
patch by jbellis; tested by Dan Di Spaltro for CASSANDRA-578

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@884333 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-578
8e08487c26f719c1e41ae36daafb7d0be76d70b1,"skip the system table (keyspace) for cleanup, it's local-only.  patch by jbellis; reviewed by Stu Hood for CASSANDRA-579

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@885572 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-579
8648d3fa0125ac12f5e894f05f369479151d4b6a,"CASSANDRA-591 remove unused setters

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@885894 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-591
5da5bf9ae5e9e0fe315c88ce9168125a891363d3,"use size of sstables as load, instead of naively counting everything in the data directories
patch by jbellis; reviewed by Stu Hood for CASSANDRA-554

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@886006 13f79535-47bb-0310-9956-ffa450edef68","['CassandraDaemon.java', 'StorageService.java']",CASSANDRA-554
eccbe75a382345ece044596feb5b706f6106f45b,"add StorageService.initClient, which starts up Gossiper without setting a token or anything other application state.
patch by gdusbabek and jbellis for CASSANDRA-535

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@886253 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-535
360d9b6a9807e76f8d9ff71b388008127f029683,"improve testing of StorageService init, and fix shutdown of messagingservice.
patch by gdusbabek; reviewed by jbellis for CASSANDRA-535

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@886254 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-535
0a7e6d10879221549f0b451e9b5235629c7485fd,"update bmt_example to use new client mode.
patch by jbellis; reviewed by gdusbabek for CASSANDRA-535

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@886256 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-535
83cce240bf61efe41c2074b8da4958794f15b123,"Fix not returning live subcolumns of deleted supercolumns
patch by jbellis; reviewed by junrao for CASSANDRA-583

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@886886 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-583
42eea2c50da56495ad9ab8a0aeec70354397c1e1,"r/m misguided attempt at optimizing merging range scan results from multiple nodes
patch by jbellis; reviewed by Stu Hood for CASSANDRA-568

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@887463 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-568
6d96f53add0c0fc9193a0dfac8c42ac18a6a97e7,"move ""are we done yet"" check in quorum read entirely into RRR.isDataPresent instead of partly there and partly in QRH.response
patch by jbellis; reviewed by Stu Hood for CASSANDRA-568

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@887465 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-568
23aa01beca4d7637b037ee85b87090cb1dff8bcf,"convert range slice to use DecoratedKeys
patch by jbellis; reviewed by Stu Hood for CASSANDRA-568

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@887466 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-568
9e0ee8f269e0a389517b480a7cc9693f9073e742,"add strong reads to range slicing
patch by jbellis; reviewed by Stu Hood for CASSANDRA-568

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@887468 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-568
b6aa09fa148305668cbd8024c394ae68ca6235e5,"ColumnFamily.onStart() was not checking files related to only it's column family. It was possible to remove files from other CFs thinking they were orphans. Skip files not apart of the CF. patch by goffinet; reviewed by jbellis for CASSANDRA-606

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@887627 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-606
08479960ee33534926c282d42f8c7b0b4e8ff5dc,"promote a couple streaming debug messages to info.  patch by jbellis for CASSANDRA-592

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@888022 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-592
c8664861b7c3744bb29925646d1bc61862d1aaaf,"minor CFS cleanup.  patch by Stu Hood; reviewed by jbellis for CASSANDRA-520

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@888169 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-520
b1810fd428e90a85705aedb82bdf002c9e7a27ab,"cleanup Streaming and rename transferOneTable -> transferSSTables.  patch by Stu Hood; reviewed by jbellis for CASSANDRA-520

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@888170 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-520
3e574a962c43af699eccd968b1488f724d78d5a0,"only GC when compacting all sstables, to avoid situations where the data a tombstone is intended to supress is in an sstable that is not part of the compaction set.
patch by jbellis; reviewed by Ramzi Rabah for CASSANDRA-604

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@888512 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-604
616ab64c4888825c544e55d0945a5a3d412e0947,"r/m unused code.  patch by Stu Hood; reviewed by jbellis for CASSANDRA-608

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@888551 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-608
6f00a24296179b0abc9673c94f76d1e551ebdeab,"respect memtable thresholds when replaying commit log
patch by jbellis; reviewed by Jun Rao for CASSANDRA-609

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@888701 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-609
d267cf77bd9f87389997d0c4b990aa799bc6cfda,"support ConsistencyLevel.ALL on read.  patch by jbellis; reviewed by goffinet for CASSANDRA-584

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@888707 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-584
27cadba02769ec7761b9f7a60c4e18f3f5a750c8,"Rename BootstrapMetadata and friends to StreamRequest* as that is what those essentially are. Move them to cassandra.io where rest of streaming stuff resides.  patch by Jaakko Laine; reviewed by jbellis for CASSANDRA-564

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@888864 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-564
ea30613ff7d3f59b643de2c98c6b1b4b7fc72238,"Add removeToken command to StorageService and nodeprobe.  patch by Jaakko Laine; reviewed by jbellis for CASSANDRA-564

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@888866 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-564
70e0eee7918b02a08886332d03f41f9343678073,"fix log statement for hinted writes.  patch by Gabriele Renzi; reviewed by jbellis for CASSANDRA-631

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@889937 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-631
7777a90c7531709aeac357e4009846b30223f505,"minor StorageProxy cleanup.  patch by Gabriele Renzi; reviewed by jbellis for CASSANDRA-631

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@889938 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-631
beba91e885c450a4542823da955c677b01d66a17,"add batch_mutate command.  patch by Jeff Hodges; reviewed by jbellis for CASSANDRA-336

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@892382 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-336
453c8171d9b3472c40d946254d6a6fe1ae59fe87,"clean up compactions api and move into CompactionManager.  patch by jbellis; reviewed by eevans for CASSANDRA-599

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@893600 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-599
b4c7f55afe4ecfc98bc88ec3e54d5f79cbf3b244,"abstract DTPE from JMXETPE.  patch by jbellis; reviewed by eevans for CASSANDRA-599

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@893601 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'MessagingService.java', 'StorageService.java']",CASSANDRA-599
090e9f8f10e890f4c1e3177e945d8facccc95cd8,"expose cf count, disk space to JMX.  patch by jbellis; reviewed by eevans for CASSANDRA-599

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@893603 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-599
1954f8252b3122fd467dc2d6c599ee6d56ce1e33,"move initial check for compaction to after log replay.  patch by jbellis; reviewed by eevans for CASSANDRA-599

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@893604 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'CassandraDaemon.java']",CASSANDRA-599
b2b057ffde14e4bb15a8d13f87cdca2d22c1a3b2,"make estimation of pendingtasks for CompactionManager sane.  patch by jbellis; reviewed by eevans for CASSANDRA-599

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@893605 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-599
1cb079400f80b716fbb0ad4448a427ca94c8460c,"replace DataInputBuffer with ByteArrayInputStream/DataInputStream.  patch by Todd Blose; reviewed by jbellis for CASSANDRA-656

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@894312 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-656
d6d4a4fe185c332e1e8f6de5e2f1385f89f74451,"CASSANDRA-651  TcpConnectionManager was holding on to disconnected connections, giving the false indication they were being used.

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@894721 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-651
ded4585812a540f99189247cb0134f276d821ad0,"Implement FileDataInput with MappedFileDataInput, backed by a mmap'd ByteBuffer.
patch by jbellis; reviewed by Brandon Williams and goffinet for CASSANDRA-408

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@894943 13f79535-47bb-0310-9956-ffa450edef68","['SSTableReader.java', 'CassandraDaemon.java']",CASSANDRA-408
b2c2a6031a8e686092801b12f649b498623b667c,"productize mmap approach: handle files > 2GB by chunking w/ fallback to BRAF
when a row crosses chunk boundaries (you don't want to have to check for crossing
boundary in each read() call, or you'll almost certainly waste more time than
the BRAF approach); add retrying-delete to wait for mmapped files to be unmapped
by finalizer after compaction

patch by jbellis; reviewed by Brandon Williams and goffinet for CASSANDRA-408

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@894944 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'SSTableReader.java']",CASSANDRA-408
4aff8fadb7611aa60cfbb0edae5e6347ec46be68,"r/m unused TC.inUse_ field
patch by jbellis; reviewed by gdusbabek for CASSANDRA-659

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@895885 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-659
b72fb58000f17815c60ee9816b281eb0bb08b82f,"r/m unused ""reservedverbs"" code
patch by jbellis; reviewed by gdusbabek for CASSANDRA-659

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@895887 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-659
2b37194d05958b1e508e6e3e1891a4e09ea2d00d,"r/m unused MS.endPoints_ field
patch by jbellis; reviewed by gdusbabek for CASSANDRA-659

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@895888 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-659
a96bdf32395b82e791692d82c5c91f77bc8ef193,"use NBHM instead of Hashtable and (!) manual locking in MessagingService
patch by jbellis; reviewed by gdusbabek for CASSANDRA-659

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@895889 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-659
d6bdce610d2cdf7d319279c7f2b31f91faa4a4d7,"store data information for any index entries spanning a mmap segment boundary when reading the index (with a BufferedRAF) so we don't have to deal with that at read time.
patch by jbellis; tested by Brandon Williams for CASSANDRA-669

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@896741 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-669
33acfcd657bfdd844960de2d6c816a9be1e6f0aa,"add support for multiple mmapped index segments, and add mmap_index_only option
patch by jbellis; tested by Brandon Williams for CASSANDRA-669

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@896742 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'SSTableReader.java']",CASSANDRA-669
2f3d2c0e4845faf62e33c191d152cb1b3fa62806,"instead of providing a RandomAccessFile-like interface in FileDataInput implementing seek and trying to keep people from shooting themselves in the foot by forgetting that it may only represent a 2GB segment of a larger file, provide an InputStream-like interface emphasizing mark/reset
patch by jbellis; tested by Brandon Williams for CASSANDRA-669

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@896743 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-669
b40af751144c1859d3a866195a92ad3ecdd35b63,"use throughput and op count instead of size and column count to determine when to flush, greatly reducing the amount of synchronization required to insert
patch by jbellis; tested by Brandon Williams for CASSANDRA-658

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@896755 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-658
3998a4e600ef65a1f2ac92e37dd7b93567448616,"fix bad rebase causing regression in the CASSANDRA-669 patchset (use index path to open index file).  patch by jbellis

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@896932 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-669
facfe74ac968d952c1fac258433ab46bae2c8757,"cleanup of HHOM.  patch by jbellis; tested by Brandon Williams for CASSANDRA-680.

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@897234 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-680
d89a63c1157ab956b7f6e1da2dba0ddac42e4354,"make ""stealth defaults"" less gotcha-ful.  patch by jbellis for CASSANDRA-671

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@897307 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-671
6b5d8bf8028c04db5d167543d006da901eb01663,"centralize stage creation in StageManager and standardize stage naming
patch by jbellis; reviewed by gdusbabek for CASSANDRA-684

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@898035 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-684
c1e0e1900924242fe68e13acf5781aabfb27c9e1,"basic row caching.
patch by jbellis; reviewed by goffinet for CASSANDRA-678

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@898175 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-678
e6df900909f262177956651c1aa30aa07cacb51f,"clean up Table/CFS onstart to fix cache size calculation (need key count so it's not zero)
patch by jbellis; reviewed by goffinet for CASSANDRA-678

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@898176 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-678
ab800ad8e49b01558f29c32cbacb00c2e4dee7f1,"row cache instrumentation
patch by jbellis; reviewed by goffinet for CASSANDRA-678

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@898177 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-678
9a486949a7d4dc941e05462504e5dabbbc391950,"make rowcache, keycache configurable per-CF
patch by jbellis; reviewed by goffinet for CASSANDRA-678

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@898178 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-678
27f17db6f8f5f6675d5af5f2261f8d75c2a74bec,"update cached rows in-place instead of invalidating & reloading.  should make it more suitable for relatively wide rows, especially if updates are to a small number of columns.
patch by jbellis; reviewed by goffinet for CASSANDRA-678

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@898179 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-678
70e1ee304c8b92c50e014944cf5955b438352c24,"fix enabling/disabling row cache.
patch by jbellis; reviewed by goffinet for CASSANDRA-689

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@898893 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-689
0e276b5ab0eacfdd4c96d101cf76a0ae7dde4113,"add missing gcBefore parameter to removeDeleted; clone SC from cache before modifying
patch by jbellis; reviewed by goffinet for CASSANDRA-689

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@898894 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-689
ca4a07e4f0cc7a7e240860b8dd47d7a2082cd995,"fix missing update of local deletion time introduced in #658.
patch by jbellis; reviewed by goffinet for CASSANDRA-689

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@898895 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-689
b0d6e5c9f7b75e876cdf89659a21cb817d032556,"rename read executor and give it one thread.  patch by jbellis; tested by Brandon Williams for CASSANDRA-701

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@899519 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-701
a2e2c03435d453306446d19c1000a95089fd8d22,"replace instance() accessors with public final fields.  patch by Jeff Hodges; reviewed by Gary Dusbabek and jbellis for CASSANDRA-700

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@899791 13f79535-47bb-0310-9956-ffa450edef68","['CompactionManager.java', 'SSTableReader.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-700
dd40656405f2d90232532e112e4a714d9c6606f8,"Remove 'final' from all class declarations. Patch by Jeff Hodges, reviewed by Gary Dusbabek. CASSANDRA-706

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@899850 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-706
1dc4279584a38c1c92d31ec4d6a4331aad0ac909,"move cache classes to cassandra.cache package.
patch by jbellis; reviewed by goffinet for CASSANDRA-688

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@900432 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'MessagingService.java']",CASSANDRA-688
15e5d1c80c3eb1793826dc19c8dd88dfd61a5836,"extract InstrumentingCache from jmx code
patch by jbellis; reviewed by goffinet for CASSANDRA-688

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@900433 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-688
72a9a4eaae36c3acd59a46461e1ceaf88bfce356,"add JMXAggregatingCache to present all the SSTR keycaches in one mbean
patch by jbellis; reviewed by goffinet for CASSANDRA-688

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@900434 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-688
27101e9626b4a97d4e34ba5ecf3abc52309f1e19,"change RowsCachedFraction option to RowsCached, specified either as an absolute number or as a percentage of rows in the CF
patch by jbellis; reviewed by goffinet for CASSANDRA-688

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@900435 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-688
ea2eded3b84826a6317eeb561f50b89b89d5d2e8,"remove get_key_rang. Patch by Gary Dusbabek, reviewed by Jonathan Ellis. CASSANDRA-710

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@901207 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-710
2126f608ed6497d05b97d27cf2862ec2cd4ec54e,"make shutdown non-reentrant and make MS a true singleton
patch by jbellis; tested by Brandon Williams for CASSANDRA-705

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@901432 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-705
69588b56b61bf19692c9d07c7c3e94125389d60c,"replace tcp socket reads w/ blocking i/o
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-705

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@901433 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-705
592976b4f202980b25f4b140fc507c81beb1f120,"replace tcp writes w/ blocking i/o
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-705

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@901435 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-705
6522483594337fb3f25a4a2b2fb88de03ead440f,"implement streaming w/ blocking io
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-705

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@901436 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-705
5b522404d6fa7a6517d114c2de35ce1119f84e8a,"convert gossip to use tcp.  this finishes the removal of nio
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-705

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@901437 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageService.java']",CASSANDRA-705
32e73238c11ea6913315145566d4c758c0d47c1e,"handle node failure
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-705

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@901438 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-705
44a7a48e9a1056f73530e5ad473c04b0642078f0,"simplify header code
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-705

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@901440 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-705
944a2a1338a3c027d2ec9bae6da95a112f694db3,"mv tree and gossip verb registration into StorageService
patch by jbellis; reviewed by Stu Hood for CASSANDRA-717

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@901858 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageService.java']",CASSANDRA-717
ca72d17210dd954c1c74f89873fdb47ca719da00,"convert verbs to enums
patch by jbellis; reviewed by Stu Hood for CASSANDRA-717

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@901860 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageService.java']",CASSANDRA-717
1c0bbc7cba7480a0bf6db63895ab010db2e5d3e8,"lower MS.convict debug statement to trace. CASSANDRA-695

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@901893 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-695
6065d714a1fa775547dd04ab3c0fdcfdd1354755,"invalidate cache after compaction so we read what's in the new sstable instead of the cache
patch by jbellis; reviewed by goffinet for CASSANDRA-719

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@901956 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-719
0a062926630fd54a187d0ab91379671fc191e0bd,"Add ConsistencyLevel.ANY for writes. Patch by Gary Dusbabek, reviewed by Jonathan Ellis. CASSANDRA-687

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@902140 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-687
9c7e277720d34f3245e06bfdcf4f9d2bfd341a09,"move connecting into OutboundTcpConnection so write does not block for connection startup
patch by jbellis; reviewed by gdusbabek for CASSANDRA-728

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@902300 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-728
a47296f7f97b02170673598bc3d146847f922167,"move sstable deletions into a Timer to reduce concurrency
patch by jbellis; reviewed by gdusbabek for CASSANDRA-667

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@902304 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-667
38ee5fcecd6aafbef7108c00ff555af240dce823,"modify removetoken to remove node from gossip. remove fat clients automatically after 1h of inactivity. patch by jaakko, reviewed by jbellis. CASSANDRA-644

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@902744 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-644
d6682ffb7b3594491151e664b070f8526fc4fece,"use 0-capacity cache instead of null to indicate no caching; this means we don't need to worry about creating & destroying cache objects from JMX
patch by jbellis; reviewed by goffinet for CASSANDRA-708

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@902914 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-708
56053d3b7164e09fc508593d381051e20fcfb157,"add cache info to cfstats; add setcachecapacity
patch by jbellis; reviewed by goffinet for CASSANDRA-708

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@902915 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-708
a6e720390caee30b88f92da3014fe8b3eea7ead2,"better division of aggregated capacity among sstable caches
patch by jbellis; reviewed by goffinet for CASSANDRA-708

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@902917 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-708
979a022f896aaa5a799b27a973cd476e5727820e,"replace remaining uses of TimedStatsDeque with LatencyTracker
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-702

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@904524 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java', 'NodeProbe.java']",CASSANDRA-702
4a354d037c3bf12d725e7766a11a541ada8b1be0,"Remove import breaking compilation. Related to CASSANDRA-702.

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@904550 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-702
cc9737abaf6b6e5a117385cfe627c0a9a90b5988,"centralize streaming code in org.apache.cassandra.streaming; split out verbs & handlers into top-level classes
patch by jbellis; reviewed by stuhood for CASSANDRA-751

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@904924 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-751
c14e573cc03731d83fc7cd7c25afe464d18857ca,"split Streaming into StreamOut and StreamIn; clean up StreamManager
patch by jbellis; reviewed by stuhood for CASSANDRA-751

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@904925 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-751
6224d8b25dcfdcf8a1771a77cbf8619a1d1e6d59,"move IncomingStreamReader, StreamInitiateMessage, and BootstrapTest to streaming package.  r/m 'public' modifier from streaming classes that don't need it
patch by jbellis; reviewed by stuhood for CASSANDRA-751

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@904932 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-751
4922a87b54c8ddcc47ef8a3c7542bc40dde435c2,"clean up Table iteration; add Table.all, CFS.all
patch by jbellis; reviewed by stuhood for CASSANDRA-753

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@905868 13f79535-47bb-0310-9956-ffa450edef68","['CassandraDaemon.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'CassandraDaemon.java']",CASSANDRA-753
77335589c85f65b91c5e31482088ba85969020f4,"r/m SSTR.openedFiles; clean up decorated key iteration
patch by jbellis; reviewed by stuhood for CASSANDRA-753

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@905869 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-753
7af12623b19cf0df440fcb2b5b05ef83d5931553,"allow wrapped range queries.  patch by jbellis; reviewed by stuhood for CASSANDRA-758

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@906209 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-758
ecdcc00ff3105135dec4e4ae47af85cb576a3084,"add option to skip start key in range query (StorageProxy only for now) and test.
patch by jbellis; reviewed by stuhood for CASSANDRA-759

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@906272 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-759
3577fd82520a035df989b6da2fcc982a058106ef,"add per-keyspace replication factor and replication strategy. Patch by Gary Dusbabek, reviewed by Jaakko Laine.  CASSANDRA-620

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@906521 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'CompactionManager.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-620
f30ca092fc96ea0e50d0a3301bd2e848c143ca5b,"replace gc after each compaction w/ gc before compaction/flush only if we need it for the file space
patch by jbellis; tested by Brandon Williams for CASSANDRA-724

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@906629 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-724
d274cc82488f26ec19357f15144017b5e1bb7983,"only gc if there are undeleted sstables that gc-ing could free
patch by jbellis; tested by Brandon Williams for CASSANDRA-724

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@906631 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-724
6d8adfea897e805d56d7a8bb518b908c17f5eeec,"make init* methods idempotent.  patch by Stu Hood and jbellis for CASSANDRA-342

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@907005 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-342
6420863e04b583621d3cf1b68f782a6111230433,"track latency in nanoseconds, measure in microseconds. patch by Gary Dusbabek, reviewed by Jonathan Ellis. CASSANDRA-733

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@907044 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-733
b8030f2661c83595ebaaaf78426780629020ad88,"emit a message if an unbootstrapped autobootstrap node is configured as a seed. Patch by Gary Dusbabek, reviewed by Brandon Williams. CASSANDRA-746

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@907064 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-746
db1bebf118ce75a3f431a306ebed166ef7c991a1,"avoid accidentally generating a cache read statistic on writes to cached CFs.  patch by jbellis; reviewed by Brandon Williams for CASSANDRA-770

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@907087 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-770
2f99e71f304b3663f2cc7d8bb79172a999525062,"have RangeSliceCommand take Range or Bounds (client bounds, start-inclusive, non-wrapping)
patch by jbellis; reviewed by Stu Hood for CASSANDRA-763

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@907172 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-763
d2f13e568131792ce8f6481caea3db5aed7bf89c,"adding sstables to tracker via constructor was inconsistent with add() method.  r/m constructor code path, forcing use of add() for consistency.  patch by Stu Hood; reviewed by jbellis for CASSANDRA-772

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@907266 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-772
6877a05efe91c417bf5bdb07d71d5262aca03fc1,"add TokenMetadata.ringIterator to replace one-offs of the same functionality
patch by jbellis; reviewed by Stu Hood for CASSANDRA-771

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@907368 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-771
6a72aa100576e0a8a4130462017c13a055df4a52,"iterate ranges rather than endpoints, and sort endpoints by proximity
patch by jbellis; reviewed by Stu Hood for CASSANDRA-771

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@907369 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-771
c325fcab720418f68cccdf1046afff24d86c3542,"expose describe_ methods replacing the get_*_property ones.  add TokenRange struct for describe_ring.
patch by jbellis; reviewed by Stu Hood for CASSANDRA-736

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@907705 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-736
75daa13317fffdf96c168d40b8cb712b5413518d,"Avoid deadlocks by creating all replication strategies when SS in instantiated. Patch by Gary Dusbabek, reviewed by Jonthan Ellis. CASSANDRA-778 (regression introduced in CASSANDRA-620).

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@907771 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-778
58225374f426b2f76712eb47ef888f76f07f1121,"improve the concurrency of bootstrapping. Patch by Gary Dusbabek, reviewed by Jonathan Ellis. CASSANDRA-779

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@907816 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-779
e274575bdd248b09e9510f2e867b08984a21d3cb,"fix timeout bug.  patch by jbellis; tested by Jack Culpepper for CASSANDRA-781

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@908561 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-781
2ac485b64c4a854a6a63c67bdfc58553c57f7afe,"replace map iteration via keys + value get w/ iteration over entryset.  patch by gabriele renzi; reviewed by Stu Hood and jbellis for CASSANDRA-773

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@908568 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-773
dade352715f80a0c74ee688a13cb5c8aafd5c7c5,"jmx interface for tracking streams (incoming and outgoing) and a general operation-mode.  Patch by Gary Dusbabek, reviewed by Jonathan Ellis.  CASSANDRA-709

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@908682 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-709
fdba4279a0f402603872b36f58fe3c686f691ac4,"encapsulate commitlog file operations in CommitLogSegment
patch by jbellis; reviewed by junrao for CASSANDRA-783

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@908830 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-783
03da50d62cc607b154d801b3709b2f6663d86ac5,"mv RecoverManager.doRecovery() -> CommitLog.recover()
patch by jbellis; reviewed by junrao for CASSANDRA-783

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@908831 13f79535-47bb-0310-9956-ffa450edef68","['CassandraDaemon.java', 'CassandraDaemon.java']",CASSANDRA-783
1e6ccecd47f92e895834e11de8f92a54b0903ef1,"add wordcount hadoop example
patch by jbellis; reviewed by Stu Hood for CASSANDRA-342

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@909626 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-342
43b86fe61f69abba40cdd37519e69ca537d9405f,"sub splits
patch by jbellis; reviewed by Stu Hood for CASSANDRA-342

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@909631 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-342
9cc51b5f2cc31cea6ace8deae81356fea4d9ed22,"fix range queries and Range/Bounds intersections.  patch by jbellis; tested by Jack Culpepper for CASSANDRA-781

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@910380 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-781
41635b264612e474c4c345a91f2cd9d6ec109862,"use while loop instead of recursion when trimming sstables compaction list to avoid blowing stack in pathological cases.
patch by jbellis; reviewed by gdusbabe for CASSANDRA-804

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@911074 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-804
a4e9b14d21473e862144ddd9198ad7e240e2e614,"refactor IFlushable contract to push differences b/t Mt and BMT into their respective classes
patch by jbellis; reviewed by Stu Hood for CASSANDRA-799

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@911222 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-799
b55b26d790bee95fa53078e85d8aa5dc86fc6193,"use a sorted map for memtable contents to make range queries not have to sort every time
patch by jbellis; reviewed by Stu Hood for CASSANDRA-799

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@911223 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-799
7b8542c8ba2f5d19bec343248a720d6a924bfa2b,"refactor to make memtablesPendingFlush a member variable instead of a static, and Memtable to have a reference to CFS instead of table/cfname pair.
patch by jbellis; reviewed by Stu Hood for CASSANDRA-799

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@911224 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-799
b3680921f4c58c7e57b6c5eea063e9dd41b09abf,"No longer use a streaming directory. Patch by Gary Dusbabek and Stu Hood, reviewed by same.  CASSANDRA-810.

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@912620 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'CompactionManager.java']",CASSANDRA-810
81d713a7cf921b6c67a39aaa7946d44a57dabf2c,"sstable versioning. Patch by Stu Hood, reviewed by Gary Dusbabek. CASSANDRA-389

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@912650 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-389
fbda616f682362053f3a11b9f4bbdd725c9b38fa,"Refactor DatabaseDescriptor to isolate the code that establishes the keyspaces and column families. Patch by Gary Dusbabek, reviewed by Eric Evans.  CASSANDRA-819

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@915533 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-819
84b39205eb67d9445d3cdffd99a8ac510b294ea5,"make CompactionExecutor and KeyPosition classes static.  patch by gabriele renzi; reviewed by jbellis for CASSANDRA-829

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@916015 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-829
7d2115bf8bad64f69a23647dc05be817d5f1a684,"add optional bitmask matching to SliceRange.  patch by Ted Zlatanov; reviewed by jbellis for CASSANDRA-764

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@918844 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-764
86eaf906b7fcb33081fc505bea7e54ee29243bff,"move SSTable* to io.sstable package.  patch by Stu Hood; reviewed by jbellis for CASSANDRA-777

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@919170 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-777
9f7ceaebec5d21a8ae5d0b9134ffed1a5cf9eec5,"extract SSTableReader as superclasses; subclass is RowIndexedReader
patch by Stu Hood; reviewed by jbellis for CASSANDRA-777

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@919171 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-777
b2beaf4bc6a7eb176898d30a3be20040f4e8b232,"drop a cf on a single node. Patch by Gary Dusbabek, reviewed by Jonthan Ellis. CASSANDRA-840


git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@921961 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-840
0095f0c68f640a8aa8c4f8a8f24c0876861c004c,"CASSANDRA-625 switch to slf4j logging. Patch by Gabriele Renzi, reviewed by Gary Dusbabek.

git-svn-id: https://svn.apache.org/repos/asf/incubator/cassandra/trunk@922409 13f79535-47bb-0310-9956-ffa450edef68","['CassandraDaemon.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java', 'CassandraDaemon.java']",CASSANDRA-625
17f3dbb11bd8b3571bae657b83512742f567ac74,"make Table.open throw IOError instead of IOException.  patch by Rodrigo Peinado; reviewed by jbellis for CASSANDRA-756

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@923416 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-756
468fde03e092322e457e4c8a9b93e70991db52f5,"make CFS.getColumnFamily throw IOError instead of IOException.  patch by Rodrigo Peinado; reviewed by jbellis for CASSANDRA-756

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@924108 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-756
6e41b41adfec8ebe065081e82e57f53be8e71b60,"cleanup DeletionService and MessagingService. Patch by Gary Dusbabek, reviewed by Jonathan Ellis. CASSANDRA-880


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@924481 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-880
c3afaeb3d3b647c0a487801065107ed5ee8a666a,"table creates data dirs in ctor. patch by Gary Dusbabek, reviewed by Jonathan Ellis. CASSANDRA-861.


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@924780 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-861
f54c4015868f89f0d811bf85b593eb0b8bee01e4,"drop keyspace. patch by Gary Dusbabek, reviewed by Jonathan Ellis. CASSANDRA-861.


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@924784 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-861
5630eb378d927bba8eb0ccfa083436b2a2052c32,"don't allow hyphens in column family names

Patch by eevans; reviewed by jbellis for CASSANDRA-915

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@926836 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-9
bf98ec94eca061d2dbe6eba0472134cb334978a6,"separate QueryFilter from IFilter, make QueryFilter handle both the top-level and subcolumn filtering transparently to caller.
patch by jbellis; reviewed by johano for CASSANDRA-917

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@929163 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-917
081538ad0db4e961fe975ae0a3146802e1a942c2,"add ReadRepairChance to CF definition.  patch by Matthew Dennis; reviewed by jbellis for CASSANDRA-930

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@930272 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-930
9f65dd42188698fe6862d42aa1540e496716089a,"better error handling for authenticators

Patch by Roger Schildmeijer; reviewed by eevans for CASSANDRA-935

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@930584 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-9
caf057f3ca676381d09775bdb70cc7f81bfea654,"remove unused JoinMessage.  Patch by Gary Dusbabek, reviewed by Jonthan Ellis. CASSANDRA-827


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@931197 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-827
a89fd2a3388a2f222a78d28e4715d37ed60c3975,"Refactor so meta mutations can be serialized and moved around.  Patch by Gary Dusbabek, reviewed by Jonthan Ellis. CASSANDRA-827


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@931198 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-827
4d4ef96cd2268d9616df98b83cc1bb2564f786d9,"move ConfigurationException to its own class file. Patch by Gary Dusbabek, reviewed by Jonthan Ellis. CASSANDRA-827


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@931199 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-827
82bd54dbdaac502c87805d569f24a98daf720c7d,"Gossip metadata version and request updates. Patch by Gary Dusbabek, reviewed by Jonthan Ellis. CASSANDRA-827


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@931200 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-827
7a75b63b2659db34306f7000a885c102859720f7,"switch to reading schema configuration from storage. Patch by Gary Dusbabek, reviewed by Jonthan Ellis. CASSANDRA-827


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@931202 13f79535-47bb-0310-9956-ffa450edef68","['CassandraDaemon.java', 'DatabaseDescriptor.java', 'StorageService.java', 'CassandraDaemon.java']",CASSANDRA-827
8d72fdc817e044075e6e61069954de0185b55c92,"thrift impl. Patch by Gary Dusbabek, reviewed by Jonthan Ellis. CASSANDRA-827


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@931203 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-827
94f8a8e80c79248db83c751c230e2e5a5e237744,"SS.loadSchemaFromXML should record migrations. Patch by Gary Dusbabek, reviewed by Jonathan Ellis. CASSANDRA-963


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@931942 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-963
1dbcd39b45b5c3a8284a3fccfeb5bab9f85f4216,"announce version early during startup. Patch by Gary Dusbabek, reviewed by Jonathan Ellis. CASSANDRA-962


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@931943 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-962
d411227715059d07ad73ab1f31d6e0dd96bb1fce,"RingCache fixups in the wake of CASSANDRA-44

 * invoke DatabaseDescriptor.loadSchemas from RingCache ctor (needed
   now to populate DD's table list).
 * improved error handling in DD.getReplicaPlacementStrategyClass so that
   any future failures to call loadSchemas are easier to spot.
 * updated TestRingCache. This was never runnable as a unit test, (it
   requires a running instance), and doing static initialization is
   problematic now that RingCache's ctor throws IOExceptions.

Patch by eevans

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@932073 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-44
6fdad7fd0e8c887dcaebd07b5ee274a3886b1976,"access static members by class name.  patch by Tupshin Harper; reviewed by jbellis for CASSANDRA-966

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@933248 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-966
c1d34fbf48492155dded21a04fcace617cb43c31,"store bytes in DecoratedKey. Patch by Stu Hood, reviewed by Gary Dusbabek. CASSANDRA-767


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@934150 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-767
434564d1f9c39774cc185077dd3141b352b3f5c0,"byte for decorateKey and getToken in IPartitioner. Patch by Stu Hood, reviewed by Gary Dusbabek. CASSANDRA-767


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@934154 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-767
a07e71cd1bacaa3d7dcc16b340e0b1ecf51d36e2,"import and dead-code cleanup. Patch by Stu Hood, reviewed by Gary Dusbabek. CASSANDRA-767


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@934158 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-767
dd787f7fcba042a87b7627f96ea808c5e7e6b1ef,"simplify configuration file loading; rename to cassandra.xml
patch by jbellis; reviewed by eevans for CASSANDRA-971

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@934505 13f79535-47bb-0310-9956-ffa450edef68","['CassandraDaemon.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-971
79e9a80b2f6ca205b5895075ba93180129197594,"make EndPointSnitch per-cluster instead of per-keyspace, and add better error messages for snitch misconfiguration.
patch by jbellis; reviewed by gdusbabek for CASSANDRA-986

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@935049 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-986
18b2a16f0a9cc90ef6f8c9677b7fa970a5200b5b,"rename EndPoint -> Endpoint, part 1.  patch by Erick Tryzelaar; reviewed by jbellis for CASSANDRA-994

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@935594 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-994
2e1b1a53c953f183210052ea10b06c0818e427ed,"rename EndPoint classes -> Endpoint (case change).
patch by Erick Tryzelaar; reviewed by jbellis for CASSANDRA-994

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@935601 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-994
04384943fef3c50b1cb27845c02a5287c983d11a,"convert cassandra.xml to cassandra.yaml.  patch by Todd Blose and Stu Hood for CASSANDRA-990

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@936510 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-990
6ceaa06d93e7f00cc70fd2afbf74f0a6359feb51,"add missing files from CASSANDRA-990

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@936572 13f79535-47bb-0310-9956-ffa450edef68",['Config.java'],CASSANDRA-990
1f79cba9c1315b821cc849dd3fb9fa4528674389,"set limit of 60s on ""extra"" threads
patch by jbellis; reviewed by rschildmeijer for CASSANDRA-805

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@937118 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'MessagingService.java', 'StorageService.java']",CASSANDRA-805
71c51f11ddf7314953f87ed482979357dd0d7d3a,"add row cache preload option
patch by Vijay Parthasarathy and jbellis for CASSANDRA-946

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@937591 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-946
d338a977e3ae0f36917ccc29ae4a19e40e8a0402,"rename preloadRowCache to preload_row_cache in yaml for consistency.  patch by Vijay Parthasarathy; reviewed by jbellis for CASSANDRA-946

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@938058 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-946
45d8fc50cfdd35a9c1087d0ad2f9268a0d243536,"Replace synchronization in Gossiper with concurrent data structures and volatile fields.  Also removes getSortedApplicationStates since nothing actually seems to rely on iterating in sorted order.  Patch by Brandon Williams and jbellis for CASSANDRA-757

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@938597 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-757
f69947c2fa7cd5a2a3d085b67346c8976f9b5864,"ignore subdirectories (snapshots) within a keyspace directory when scanning for files. Patch by Paul Bohm, reviewed by Gary Dusbabek. CASSANDRA-983

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@942069 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-983
8a3543a1edbfd59621af1a5f371a05539ce54377,"implement truncate.  patch by jbellis and Ran Tavory for CASSANDRA-531

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@942817 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-531
d55ed91006b8ad6ef8b3ede0d4e124700b825dc9,"revert unreviewed patch to CASSANDRA-952

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@942842 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-952
5a45534c27e97e0463507acff48b3847d958eea9,"make DCQUORUM CLs actually wait for the nodes per DC rather than attempting a purely count-based approach that didn't really work as advertised.  patch by Vijay Parthasarathy and jbellis; reviewed by Jeremy Hanna for CASSANDRA-952

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@945333 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-952
2bff10641963474a73a989237b7325775f001ca9,"remove redundant cfNamesMap in Table. Patch by Stu Hood, reviewed by Gary Dusbabek. CASSANDRA-956


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@947120 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-956
71b84e43f0582bd878c6d1be3462086bfcb7b067,"add easy reverse lookup from id cf. Patch by Stu Hood, reviewed by Gary Dusbabek. CASSANDRA-956


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@947121 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-956
6ebc3723eaaaa4b998fd1141964c200e3e8a8780,"remove name field from cf and clean up. Patch by Stu Hood, reviewed by Gary Dusbabek. CASSANDRA-956


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@947122 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-956
44e6a2843b0cdc47efd26b78728b6d2e77d3f165,"recover when a migration crashes before system table is flushed. patch by gdusbabek, reviewed by stuhood. CASSANDRA-987


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@947163 13f79535-47bb-0310-9956-ffa450edef68",['CassandraDaemon.java'],CASSANDRA-987
8c323b80e87d90e1eb381ba9f331b780d578fdc1,"apply CASSANDRA-987 to thrift.CassandraDaemon too...

...and expect that lastMigration might be null

Patch by eevans

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@948929 13f79535-47bb-0310-9956-ffa450edef68","['CassandraDaemon.java', 'CassandraDaemon.java']",CASSANDRA-987
88fc353f67832e8a32d5747af0789ad14c43b557,"remove some unused fields. patch by gdusbabek, reviewed by jbellis. CASSANDRA-956


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@953348 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-956
e34bc868d0bd42cfa07e8a924a720077f44c209c,"Extract index/filter writing into IndexWriter; add recovery for non-essential sstable components; only send the datafile when streaming
patch by Stu Hood; reviewed by jbellis for CASSANDRA-579


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@955840 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-579
aadfa6a334135e1f9f7b8eff827941ab6e588d2f,"Stream sstables without anticompaction
patch by Stu Hood; reviewed by jbellis for CASSANDRA-579


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@955923 13f79535-47bb-0310-9956-ffa450edef68","['SSTableReader.java', 'MessagingService.java']",CASSANDRA-579
e349f3f82326891cf70535660657249c7e10c822,"log cassandra and thrift versions at startup.  patch by mdennis; reviewed by jbellis for CASSANDRA-972

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@961952 13f79535-47bb-0310-9956-ffa450edef68","['CassandraDaemon.java', 'StorageService.java', 'CassandraDaemon.java']",CASSANDRA-972
67c57208ab9cbec1200723533d9e62f3a67de004,"Dynamic snitch to adaptively avoid reading from slow nodes.  Patch by brandonwilliams; reviewed by jbellis for CASSANDRA-981

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@962720 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java']",CASSANDRA-981
fc73007f3d966312c1c8330925a3027950ae8bbd,"avoid double-copy of flushed data by serializing directly to output file.  patch by jbellis; reviewed by mdennis for CASSANDRA-270

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@963159 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-270
b22c91127fc5c345e72c77e7f07c425c60bcd5e6,"Use EnumMap for verbHandlers.  patch by Folke Behrens; reviewed by jbellis for CASSANDRA-717

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@963842 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-717
0b0c523581a2223777422d335289e593d9c58de6,"make framed transport the default so malformed requests can't OOM the server.  patch by Nate McCall; reviewed by jbellis for CASSANDRA-475

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@964274 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-47
35ee5347f8d8a344f62389f9bcc3f028351818b6,"per-connection read-your-writes ""session"" consistency.  patch by Brian Palmer; reviewed by jbellis for CASSANDRA-876

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@986781 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-876
d28cab41a067803b6e2fa2b5e88f6a4f4103f1ce,"Add CfDef.default_validation_class.  patch by jhermes; reviewed by jbellis for CASSANDRA-891

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@989344 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-891
f43e6217e3d38703eb81f2bc50db8d962de55d94,"fix drop race with compaction. patch by gdusbabek, reviewed by jbellis. CASSANDRA-1631


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1025542 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-1631
3f83c10ef103a485d12489cdcf62c702f859339c,"fix drop race with flush. patch by gdusbabek, reviewed by jbellis. CASSANDRA-1631


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1025543 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-1631
00ff744620d5e9482c71ead358cb59e21d70b232,"Add framing to hint destinations.  Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-1617

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1025680 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1617
8959c1f1fc064bcf1f55febb3359c32ed748d1fc,"put JOIN verb back. patch by gdusbabek, reviewed by jbellis. CASSANDRA-1642

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1026012 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1642
09d3507fb3c4794e310862ac2b27271798a45b37,"reduce automaticallychosen memtablesizes by 50%
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-1641

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1026071 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-1641
00554e90b84074139060ccf2c32fa3130211136b,"move endpoint cache from snitch to strategy
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-1643

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1026138 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-1643
aeb0d5467d24b8b6c844de7566bfb5c58ddc5e27,"fix commitlog recovery deleting the newly-created segment as well as the old ones
patch by jbellis; reviewed by gdusbabek for CASSANDRA-1644

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1026177 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-1644
187761a3229a9d6853090295d966731fb1170458,"upgrade to Thrift 0.5
patch by Jake Luciani; reviewed by jbellis for CASSANDRA-1367

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1026201 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1367
8319b3909d47022fae3089d7a2bd446c84b28b57,"add memtable settings to CFS mbean.  patch by Jon Hermes; reviewed by jbellis for CASSANDRA-1637

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1026207 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1637
cf1a65498b6c01405e47511df76402a08ab7127d,"avoid initializing DatabaseDescriptor during CFMetadata construction.  patch by Stu Hood; reviewed by jbellis for CASSANDRA-1655

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1026653 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-1655
1db5b3d6cf044e288b14b8e73dee01beca44d3e1,"add NodeProbe close method.  patch by Bill Au; reviewed by jbellis for CASSANDRA-1665

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1027767 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-1665
a2f199fad0f78cc7f10c379b5d1fe629cd853147,"avoid logging when a node's ip/token is gossipped back to it.  patch by jbellis; reviewed by gdusbabke for CASSANDRA-1666

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1028332 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1666
3be62c5ddaa330be97c718ac1d4cae0029bdcf81,"log which memtable threshold caused flush.  patch by Rob Coli; reviewed by jbellis for CASSANDRA-1675

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1028360 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1675
365f20b724b42ed1f27a9beb661f1d63eca33d65,"add INTERNAL_RESPONSE verb to differentiate from responses related to client requests.  patch by jbellis; reviewed by Stu Hood for CASSANDRA-1685

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1029224 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1685
2e27927111b6152ed960119e90ceb2a57053cb6d,"include dead hosts in unreachable. patch by gdusbabek, reviewed by jbellis. CASSANDRA-1678


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1030047 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1678
976ac6a1c6f5b82e6b13cedf7776f5a5feb931c6,"revert r1028360; see CASSANDRA-1675

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1030117 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1675
9c5a6d52399ec3828660e03b5691277a2fb179a2,"fix split of wrapping range centered on a member token
patch by Stu Hood; reviewed by jbellis for CASSANDRA-1700

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1030472 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1700
133e8d5ec50592fe2361e5af1dc287692e668e97,"enable skipping bad rows on LazilyCompacted path.
patch by jbellis; reviewed by Sylvain Lebresne for CASSANDRA-1702

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1030605 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-1702
9dc1572b41cff299f141b08edcc45422b881ea36,"Expose SSTableTracker.estimatedKeys() for quickly estimating CF size.  Patch by Jon Hermes, reviewed by brandonwilliams for CASSANDRA-1721

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1033296 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1721
c720ea584b90dc8bcd5686ab9c2e8e33fdca0661,"Expose SSTableTracker.estimatedKeys() for quickly estimating CF size.  Patch by Jon Hermes, reviewed by brandonwilliams for CASSANDRA-1721

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1033296 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1721
602605f45b42c4d2dfb117cf261129354760c1c3,"special case the special case
> patch by Stu Hood; reviewed by jbellis for CASSANDRA-1722

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1033489 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1722
ae7ddced332068f7920c355ed1b61bd050f402c7,"revert CASSANDRA-1702

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1035047 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-1702
38ff66f408916c1c3de22f369100621dc429c1ad,"fix tombstoning of supercolumns in range queries
patch by jbellis; reviewed by tjake for CASSANDRA-1734

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1035286 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1734
0d78b5c6261171833a4b181823f60876ae6ac883,"add nodetool cfhistogram
patch by Pavel Yaskevich; reviewed by jbellis for CASSANDRA-1698

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1035864 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'NodeProbe.java']",CASSANDRA-1698
da45f1a2d506ac83d0c195eadd7a632ef62dd345,"index scan treats missing columns as not matching secondary expressions
patch by jbellis; reviewed by Stu Hood for CASSANDRA-1745

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1036192 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1745
4e7bcd0d3b8aeaadb470b6f56aac2b8eacab7702,"truncate includes secondary indexes
patch by jbellis; reviewed by gdusbabek for CASSANDRA-1747

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1036273 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1747
74d0af200f4be23db9f80a7adf55ec11cf88ea98,"introduce seed_provider in config. patch by gdusbabek, reviewed by jbellis. CASSANDRA-1669


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036549 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-1669
66d2bd02548a9a70b9d873501715da1dfb4d3d63,"SeedProvider interface and implementation replaces seeds in DD. patch by gdusbabek, reviewed by jbellis. CASSANDRA-1669


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036550 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-1669
893809bdfb3f44bb94a63332056cafd3bbbfd7a6,"fix for bootstrap when no non-system tables are defined
patch by tjake; reviewed by jbellis for CASSANDRA-1732

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1036874 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1732
138d28cd6de07103718afb586749fe922f217650,"clean up token/ring code on first startup
patch by jbellis; reviewed by tjake for CASSANDRA-1758

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1036885 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1758
519afca7922d3b44870d4276edf6796c95ffebe4,"handle replica unavailability in index scan
patch by tjake; reviewed by jbellis for CASSANDRA-1755

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1036886 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1755
edaa958c3f75c61f69aa76ad6b6b3f175eb21861,"take drop off CompactionManager. patch by gdusbabek, reviewe by jbellis. CASSANDRA-1715


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036887 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-1715
186eb9f7b8c05ad2abe9249aaef627334b3abfbf,"compaction lock. patch by gdusbabek, reviewe by jbellis. CASSANDRA-1715


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036888 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-1715
5a0a445bd8eb69ef5bc518a4cffbd34abb81f6b8,"migration uses locks. patch by gdusbabek, reviewe by jbellis. CASSANDRA-1715


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036889 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-1715
439a980be2877153e927dff37c0084dbe9ab3910,"handle moved/dropped CF prior to pending compaction/streams. patch by gdusbabek, reviewe by jbellis. CASSANDRA-1715


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036891 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-1715
96588d4f322dfbb1f5ff9328afe4377babfb1d2c,"CFS.reload() assumes metadata is mutable. patch by gdusbabek, reviewe by jbellis. CASSANDRA-1715


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036892 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1715
2993584fd8b537c192b49d5b3f637f38ed52174a,"replace modifiable CFM members with private fields and public getters. patch by gdusbabek, reviewe by jbellis. CASSANDRA-1715


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036893 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-1715
3dc8066547de9c31be09cba912ddbb3262fd4870,"updateColumnFamily uses reload, remove unneccesary structures, fix bugs. patch by gdusbabek, reviewe by jbellis. CASSANDRA-1715


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036894 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-1715
b0fd9e83b73a88f144f3a9bbe27e06c041e38d1f,"perform index maintenance outside of migration locks during CF update. patch by gdusbabek, reviewe by jbellis. CASSANDRA-1715


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036895 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1715
5ea3dc3f61010ccf8591bc52460a7ba419978eaa,"use avro structures inside UpdateColumnFamily. patch by gdusbabek, reviewe by jbellis. CASSANDRA-1715


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036896 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-1715
3c58e6848ba94b054b7e157f0c9b726d974208f3,"make addIndex asynchronous and race proof. patch by jbellis, reviewed by gdusbabek. CASSANDRA-1715


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036898 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1715
78bfb1ea24927b0daf2c2ab925c123640df3ad2a,"remove locks from UpdateColumnFamily. patch by jbellis, reviewed by gdusbabek. CASSANDRA-1715


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1036899 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1715
53b49b1180dd2299b76709b4e7cf2ac184d2190e,"resolve circular initializer dependency deadlock. patch by Erik Onnen and Gary Dusbabek, reviewed by Jonathan Ellis. CASSANDRA-1756

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1036922 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1756
477eecb1cc5bcc5fa10e130c93a54864d1f56f86,"fix flush and compaction races with schema updates. patch by gdusbabek and jbellis. CASSANDRA-1715

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1036937 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-1715
2bb1021b295c8116db2c0fb3ca7816f282043710,"fix race between snapshot andcompaction
patch by jbellis; reviewed by gdusbabek for CASSANDRA-1736

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1036984 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-1736
2564647db8e97a701072ccedf16218e499a9aa44,"nodetool ring shows the percentage each node owns.  Patch by Jon Hermes, reviewed by brandonwilliams for CASSANDRA-1553

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1037056 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-1553
440f0399b565aaa0450d62e0c45329ecdc545be4,"avoid attempting to delete compacted sstables twice on restart
patch by jbellis to fix regression introduced by CASSANDRA-1736

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1037101 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1736
b37328a090e21857fb163533b85b9a1dcbb556e8,"require index_type to be present when specifying index_name
patch by Jon Hermes; reviewed by jbellis for CASSANDRA-1759

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1038208 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-1759
ac4d0161471bc5bd6971226a30074f3e8ef4879c,"rebuild Strategy during system_update_keyspace
patch by jbellis; reviewed by gdusbabek for CASSANDRA-1762

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1038293 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-1762
e5df4413b23ee1eb9c750ccf5c73a542efd07696,"fix potential int overflows
patch by Dave Brosius for CASSANDRA-1785

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1040184 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1785
0c5abc427c6b9987475f2403a0a67e51d675572f,"reduce log messages on startup when key/row cache saving is off
patch by mdennis; reviewed by jbellis for CASSANDRA-1789

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1040536 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-1789
d3b4d6b622e6ffef305849bab54ec78467d18f4a,"add flush for each append to periodiccommitlog mode; added periodic_without_flush option to disable this
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-1780

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1040691 13f79535-47bb-0310-9956-ffa450edef68",['Config.java'],CASSANDRA-1780
58d05cd57ec5f6d27a3c4dcbc9cf3e944071492e,"move fields to locals or static fields where possible
patch by Dave Brosius; reviewed by jbellis for CASSANDRA-1793

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1041025 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-1793
2f5f0c2c12a2d9c91cad79655b80382a2bd4c132,"fix consistencylevel calculations forNetworkTopologyStrategy
patch by jbellis; reviewed by Jon Hermes for CASSANDRA-1804

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1041250 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-1804
af5e0b7dd449d3cfdd941b54896e6fe7fe623f4a,"r/m out-of-date contrib/maven for CASSANDRA-1805

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1041486 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1805
2c6f56ddcb1248b14a27c6a1462de25c29177acf,"reads at ConsistencyLevel > 1 throwUnavailableException immediately if insufficient live nodes exist
patch by jbellis and tjake for CASSANDRA-1803

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1041951 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-1803
0b5d59ee5169e8f4e40c7b3c8c11f6f9e41ee4a4,"copy bytebuffers forlocal writes toavoid retainingthe entire Thrift frame
patch by tjake; reviewed by jbellis for CASSANDRA-1801

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1041961 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1801
93539ffd2cfe2dd14297bc8b5c13620a6cfcad0d,"fix botched merge of CASSANDRA-1316

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1042100 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1316
2fefb714b51787f8a238ccd759e48c692b6e2f51,"nodetool can display compaction stats.  Patch by Edward Capriolo, reviewed by brandonwilliams for CASSANDRA-1763

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1043201 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-1763
3a63f3e2e00abd7d9c5adcdb185208a96c35a800,"nodetool can display compaction stats.  Patch by Edward Capriolo, reviewed by brandonwilliams for CASSANDRA-1763

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1043201 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-1763
8df1e7887a0985e7478e187ec3af0443fa741180,"expose getNaturalEndpoints in StorageServiceMBean taking byte[] key; RMI cannot serialize ByteBuffer
patch by Kelvin Kakugawa; reviewed by jbellis for CASSANDRA-1833

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1043258 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-1833
1751579be28f0c0460fb01fdd797b7f7e5cc431f,"Restore finishBootstrapping behavior to fix nodetool move.  Patch by Nick Bailey, reviewed by brandonwilliams for CASSANDRA-1829

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1044034 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1829
d32fd5567a164d850e9490347b71624a1a17aadf,"Restore finishBootstrapping behavior to fix nodetool move.  Patch by Nick Bailey, reviewed by brandonwilliams for CASSANDRA-1829

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1044034 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1829
1a37ebf553f39387971fe1f2df2c9da31a21a01d,"fix regression from CASSANDRA-1829
patch by jbellis

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1044161 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1829
115d63cfb466729672e91793da663749f53374a2,"Unregister index Mbeans upon deletion.  Patch by Jon Hermes, reviewed by brandonwilliams for CASSANDRA-1843

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1044546 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1843
8124bdccab47bb10d86ce845ce71da7ec9f9ba73,"Unregister index Mbeans upon deletion.  Patch by Jon Hermes, reviewed by brandonwilliams for CASSANDRA-1843

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1044546 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1843
91133a474934aa9871873368eb9c791cdc011b9a,"make inner classes static where possible
patch by Dave Brosius; reviewed by jbellis for CASSANDRA-1845

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1049194 13f79535-47bb-0310-9956-ffa450edef68","['CompactionManager.java', 'MessagingService.java']",CASSANDRA-1845
3cfbbeacaa570c0be324b2b61bee95432574aa7f,"change exceptionfor readrequests duringbootstrap from InvalidRequest to Unavailable
patch by Nate McCall; reviewed by jbellis for CASSANDRA-1862

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1049580 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1862
fa74f2fbe0633a0af2bfe76f7f27df9c1f4e51fd,"replace valueOf with parse
patch by Dave Brosius; reviewed by jbellis for CASSANDRA-1864

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1050406 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1864
033d51a590ac383d4b0b05faeeb51b24f3980ca7,"flush before repair
patch by thobbs; reviewed by Stu Hood for CASSANDRA-1748

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1050752 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-1748
2c4ac98c9ffa8ea52da801830c7cdb745ddc28f0,"Adds support for columns that act as incr/decr counters. Patch primarily by Kelvin Kakugawa with select parts from Chris Goffinet, Sylvain Lebresne, Rob Coli, Johan Oskarsson, Adam Samet, Jaakko Laine and more. Review by Jonathan Ellis and Sylvain Lebresne. CASSANDRA-1072.

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1051679 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-1072
d6f6285f670e30e5c519e246c1ec05dc9b3c3888,"count timeouts in storageproxy latencies, and include latency
histograms in StorageProxyMBean
patch by Stu Hood; reviewed by jbellis for CASSANDRA-1893

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1052027 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1893
213b4291afb53143263633b9cc62af758a982239,"add FileUtils.closeQuietly and finally-close blocks
patch by Dave Brosius; reviewed by jbellis for CASSANDRA-1886

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1052057 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-1886
a8b89fba35ef51f0b7e649fc4c8f59ece7865b05,"More-efficient cross-DC replication
patch by Joaquin Casares, Jake Luciani, and jbellis for CASSANDRA-1530

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1052123 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1530
f0709a4956392d307219f545dba08c641e99f462,"upgrade to TFastFramedTransport
patch by tjake; reviewed by jbellis for CASSANDRA-1743

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1052335 13f79535-47bb-0310-9956-ffa450edef68",['CassandraDaemon.java'],CASSANDRA-1743
3991fba440756ce5174f54dd544302a0591e61c8,"avoid polluting pagecache with commitlog or sstable writes and seq scan operations
patch by Pavel Yaskevich and Chris Goffinet; reviewed by tjake and jbellis for CASSANDRA-1470

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1052531 13f79535-47bb-0310-9956-ffa450edef68","['CompactionManager.java', 'SSTableReader.java']",CASSANDRA-1470
6cb811b454779ae34df509b09abb69134795a4cf,"add OpenBitSet to support larger bloom filters
patch by Ryan King, Stu Hood, and tjake for CASSANDRA-1555

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1052542 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-1555
5995b48e8263902607fc618c429e2b4ec2be00bf,"Expose index-building status in JMX + cli schema description
patch by Pavel Yaskevich; reviewed by jbellis for CASSANDRA-1871

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1053247 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1871
9b3fbc816c254e3da4f39b45a3e061d31f6926d9,"collect secondary index tombstones immediately
patch by jbellis; reviewed by tjake for CASSANDRA-1914

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1053682 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-1914
e5f87d1d91340db050a9a4efa954a82ee371aafa,"Fix CompactionManager regression from CASSANDRA-1916 and add a better
test and more docs to prevent in the future.
Patch by jbellis, reviewed by brandonwilliams for CASSANDRA-1922

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1053960 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-1916
f7f069f340e82c7e47185cd615aa2a7d95af3a41,"add RMI authentication options to nodetool
patch by mck; reviewed by jbellis for CASSANDRA-1921

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1054137 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-1921
de83a3e83ecf62e962809d09b2ed0ce3cd46cc66,"Make snitches configurable at runtime
patch by Jon Hermes; reviewed by jbellis for CASSANDRA-1374

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1054156 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-1374
bde3781da53adef3929e08e3e51228b0faf0f1bb,"ability to forcibly mark machines failed by disabling gossip via JMX.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-1108

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1054808 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-1108
d718dddd6ea1eb4584c4b17151cfdcb11da9236e,"fix batch mutations post-#1530
patch by tjake; reviewed by jbellis for CASSANDRA-1931

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1055187 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1931
e5477338458c3a0229d4fbe659231002ac154583,"r/m SP.weakRead, rename strongRead to fetchRows.  implement read repair as a second resolve after the initial one for the data
patch by jbellis; reviewed by Daniel Doubleday for CASSANDRA-982

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1055319 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-982
f5236e4aee02b68e26092bc7926001319f127d4a,"allow specifying specific SSTables to compact from JMX
patch by slebresne; reviewed by jbellis for CASSANDRA-1963

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1057723 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-1963
f4f5826338deaa08f776109b796020b6e2cb1d30,"fix race condition in MessagingService.targets
patch by jbellis; reviewed by Folke Behrens for CASSANDRA-1959

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1057929 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-1959
a043125eb54193512c86086fcd90fbe798bc0367,"convert MessagingService into a true singleton
patch by Folke Behrens; reviewed by jbellis for CASSANDRA-1959

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1057930 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageService.java']",CASSANDRA-1959
63c5ee64622db0b90b4556dfa6553e14b4f234fd,"Add ability to invalidate row/key caches from nodetool.
Patch by Jon Hermes, reviewed by brandonwilliams for CASSANDRA-1857

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1058263 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-1857
14b7fd1aa857cb4c7bdf6ae318f2baa57ed7c22b,"Fix regression caused by CASSANDRA-1530
patch by Kelvin Kakugawa; reviewed by Jake Luciani for CASSANDRA-1986


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1059225 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1530
3787d6cfe4ea4ae5dea7542793003885f65cb25a,"zero-copy reads
Patch by Pavel Yaskevich; Reviewed by Jake Luciani for CASSANDRA-1714


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1059227 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java', 'StorageProxy.java', 'CassandraDaemon.java']",CASSANDRA-1714
71ccb7d60ef574e74b57c839d3276499843aee25,"fix read repair on CL.ONE regression
patch by jbellis; reviewed by tjake for CASSANDRA-1985

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1059401 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-1985
27042c2289b690765f3b0e1fa7f95e72ee37f24a,"refuse to open sstables from a future version
patch by Ryan King; reviewed by Stu Hood and jbellis for CASSANDRA-1935

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1059405 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1935
e4d9524efcb4d3e2c0f336a151c86e169975a338,"remove avro rpc source

Patch by eevans; reviewed by Jeremy Hanna for CASSANDRA-926

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1059458 13f79535-47bb-0310-9956-ffa450edef68",['CassandraDaemon.java'],CASSANDRA-926
43d330ddd8facd692502315c3dfe641e788f2733,"move FBUtilities.EMPTY_BYTE_BUFFER to ByteBufferUtil
patch by slebresne; reviewed by jbellis for CASSANDRA-1998

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1060077 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1998
b2024a1a4a86e30b72fd3f358007b91f3802d4ea,"support CL.QUORUM, ALL for counters
patch by slebresne; reviewed by Kelvin Kakugawa and jbellis for CASSANDRA-1944

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1060432 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-1944
fe57cc5e37a1af282d9a0e97ea14876507bca170,"move read methods from FBU to BBU
patch by slebresne; reviewed by jbellis for CASSANDRA-2009

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1060854 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-2009
6350c16e6d32ff318189bc861b25e4677e80a91a,"move FBU.hex methods to BBU
patch by slebresne; reviewed by jbellis for CASSANDRA-2009

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1060857 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-2009
b1c2ce2210b44e5f04768c41acf5beca7629d243,"configurable internode encryption. patch by rnirmal, reviewed by gdusbabek. CASSANDRA-1567

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1060890 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java']",CASSANDRA-1567
c538b9503809aa6221ea498e395f235af721a29c,"fix streaming of multiple CFs during bootstrap
patch by brandonwilliams; reviewed by jbellis for CASSANDRA-1992

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1060921 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1992
78ba84972546d45ed98092b9720be62fad27dec6,"create some padder verb fields. patch by gdusbabek, reviewed by bwilliams. CASSANDRA-2011

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1061062 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2011
c67a22ffe4fc2a86aa43b4d770889b8d3c84f988,"fix messages/endpoints mismatch when RR is disabled
patch by jbellis; reviewed by tjake for CASSANDRA-2010

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1061104 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2010
96e530594a65b2b09abda9ad0716324a39222de6,"Update token metadata for NORMAL state when endpoint has not changed.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-1934

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1061534 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1934
60b848b43f016091c89c77eb1713ea563136dbf2,"Add a configurable maximum amount of time to hint for a dead host.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-1459

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1061557 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-1459
e288eefe597d860232e872467a5ab8dcd273b15a,"added option to specify -Dcassandra.join_ring=false on startup
patch by slebresne; reviewed by jbellis for CASSANDRA-526

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1062875 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-526
4826e8c8a52ffe2f3e01fafee410e7303d464255,"add optimization for local reads to StorageProxy
patch by jbellis and tjake for CASSANDRA-2038

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1062888 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-2038
16cb2f559fb45e8f97c8c6a33e9752b03ead7f3f,"Allow removetoken to be called on nodes already leaving the ring.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-1900

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1063345 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1900
7d567af62cf07e40b8f9f6d600857bdd2f486008,"fix bugs in multi-DC replication
patch by ivancso; reviewed by jbellis for CASSANDRA-2051

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1063361 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2051
4b92b79532fec22e7c0df9676394357354b1fe6f,"clean out forward headers from message between loops
patch by ivancso and jbellis; reviewed by tjake for CASSANDRA-2051

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1063435 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2051
1506731fa04a6d5a1e6d92d53b0fa4796badce38,"turn thrift ports off. patch by Sylvain Lebresne, reviewed by gdusbabek. CASSANDRA-1951

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1063747 13f79535-47bb-0310-9956-ffa450edef68","['CassandraDaemon.java', 'CassandraDaemon.java', 'StorageService.java', 'CassandraDaemon.java']",CASSANDRA-1951
e9f265cee6c4e805d9c40f325977318fdc1922eb,"add JVM shutdownhook to sync commitlog
patch by jbellis; reviewed by gdusbabek for CASSANDRA-1919

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1063751 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1919
86369f8d6310632491ad6d02143c3a69f2504dc8,"CASSANDRA-1855 new default jmx port

Patch by eevans for CASSANDRA-1855

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1063948 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-1855
b45ef3f5928407f2e6be336f4c893bce1f56c7d5,"ignore messages from the future. keep track of nodes in gossip regardless. patch by gdusbabek, reviewed by jbellis. CASSANDRA-1970

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1065664 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-1970
2fdc5ef5e85c6527b9c693adc2b981edf846e734,"Add ability to list hosts for wh ich hints are stored, get a total hint count,
and delete hints for a given host via JMX.
Patch by Jon Hermes, reviewed by brandonwilliams for CASSANDRA-1551

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1066082 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1551
98f9e6db73bc8d60d6d2f627ec97bce065170008,"remove digestMessage reuse to fix regression from #1959
patch by Kelvin Kakugawa; reviewed by jbellis for CASSANDRA-2094

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1066480 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2094
a23547d9aed3a9c29429cbf36be30055bd40c8ad,"fix range slice ConsistencyLevel > ONE
patch by jbellis; tested by Michel Conrad and Thibaut for CASSANDRA-2081

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1066844 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2081
b2978d2fc1b5c2ab0d845ebb99e503f64f9fe5e8,"log exceptions on scheduled executors
patch by jbellis; reviewed by stuhood for CASSANDRA-2061

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1066890 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-2061
15cf72c55f06cbd9fc57ecc0a4decb9f52b59948,"Fix race condition during decommission by announcing for RING_DELAY and
not removing endpoint state until removing the ep from
justRemovedEndpoints.
Patch by brandonwilliams, reviewed by gdusbabek for CASSANDRA-2072

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1066940 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2072
0a03819acf6ab87f356d07626189d26d3ec4fa35,"Refactor gossiper.
Patch by brandonwilliams, reviewed by gdusbabek for CASSANDRA-2092

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1067373 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2092
d935e680aeb430d79c3cbebef9db3a5891f0d7e4,"cache writing moved to CompactionManager to reduce i/o contention and updated to use non-cache-polluting writes
patch by jbellis; reviewed by nickmbailey for CASSANDRA-2053

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1067526 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-2053
f51da9a724bcf584543000f356c8ab13f448eaa8,"avoid re-using Message object in index queries
patch by Aaron Morton; reviewed by jbellis for CASSANDRA-2081

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1067952 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-2081
72a2437bd7eea8ada4397fcc7b8b3b01a31e785b,"bump MessagingService.version_. patch by gdusbabek, reviewed by brandonwilliams. CASSANDRA-1949


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1067972 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-1949
5d02c51253a4f96ae3b116b62594e3685165e336,"introduce version to Message, pt 2. patch by gdusbabek, reviewed by brandonwilliams. CASSANDRA-1949


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1067974 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-1949
1ecdd7f91b6ff5a8b8b3339a21950221450bdd47,"introduce version to ICompactSerializer, convert a few to ICompactSerializer2. patch by gdusbabek, reviewed by brandonwilliams. CASSANDRA-1949


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1067975 13f79535-47bb-0310-9956-ffa450edef68","['SSTableReader.java', 'MessagingService.java']",CASSANDRA-1949
75148e12e9fb32c44c87a85bbfcd0a9221c3b368,"fix incompatible serializations. patch by gdusbabek, reviewed by brandonwilliams. CASSANDRA-1949


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1067976 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-1949
7f4e3ebc31f8ce94d59903c53ad1e04b82b84355,"move id out of Message so we can do cross-DC forwarding again
patch by jbellis; reviewed by gdusbabek for CASSANDRA-1530

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1068101 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-1530
29a8b40ac3e88960c5a09430eb937b16f7b5113e,"Add the ability to enable/disable Thrift through nodetool patch by goffinet; reviewed by slebresne for CASSANDRA-2135


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1068497 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-2135
13bf76c64991ad030babb262f6570b4809faafaa,"enable #1530 only after cluster is all on 0.7.1
> patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2138

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1068532 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-2138
f213c672923062544b8325386804dea029815ff6,"improve can't open sstables from the future message
patch by stuhood; reviewed by jbellis for CASSANDRA-2133

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1068906 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2133
804ce6f41c5e810e9ee63e6fa287574175deaabc,"cache versioned messages in StorageProxy. patch by gdusbabek, reviewed by jbellis. CASSANDRA-2140


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1069035 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2140
4da0aaf2340c15dd0478f62daf756f3ffcb5533c,"fix misspeeling. patch by gdusbabek, reviewed by jbellis. CASSANDRA-2140


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1069036 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2140
5e1820487de0308e22bd8edb756a4e76dd6afdcb,"add flush_largest_memtables_at and reduce_cache_sizes_at options
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2142

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1069119 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-2142
31ca1b42388d8aa59f4fa26f3058011ed905613c,"continue starting when invalid savedcache entries are encountered
patch by mdennis and jbellis for CASSANDRA-2076

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1069211 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2076
fd8e92e00943ee8b9a0a8e3f5106d8226dbdd7eb,"copy DecoratedKey.key when inserting into caches
patch by mdennis; reviewed by jbellis for CASSANDRA-2102

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1069468 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-2102
1339d2e8358eae2236673bf53b71d8091b7420b4,"check for null encryption in MessagingService. patch by Nate McCall, reviewed by gdusbabek. CASSANDRA-2152

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1069520 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-2152
228b65d4e666468f94fd7ff2a95a29335ad279a8,"fix merge
patch by slebresne; reviewed by jbellis for CASSANDRA-2155

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1069879 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2155
dc9992a391f01ef79b74b5d9fc69fb7390184ecf,"no more waiting for RPC_TIMEOUT before finishing RR
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2069

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1070977 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-2069
4db44a486b4c496465a3f73048c709c224dfa830,"read saved caches with DataInputStream
patch by mdennis; reviewed by jbellis for CASSANDRA-2174

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1071390 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2174
f840e42b50f61a8b14a8cdd6401857e6f6b7d6ef,"intern column names to save old-gen heap space
patch by jbellis; reviewed by stuhood for CASSANDRA-1255

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1071428 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-1255
d222de26747e2b6bde3323dc1f8755d36c8c9174,"Use a SynchronousQueue instead of LBQ so when memtable_flush_writers is > 1, it will allow actual parallel flushes. 
patch by goffinet reviewed by jbellis for CASSANDRA-2178



git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1071482 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2178
18084b7933c473c1800fbe8f824338d00bb20cfb,"update memtable_throughput to be a long
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2158

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1072169 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-2158
70688be04093e9076aef261a4722bb17d489596f,"centralize MessageDigest creation and use threadlocals for MD5s
patch by mdennis; reviewed by jbellis for CASSANDRA-2107

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1072173 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-2107
1b18906cff9bae6b6d84d7a8ac96ddc6ea65bcbc,"Better error reporting for sstable problems.
Patch by Kjetil Valstadsve, reviewed by brandonwilliams for
CASSANDRA-2202.

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1072774 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-2202
9efe2f795157267fac53b6791734ca7a7a51fe31,"fix for cleanup writing old-format data into new-version sstable
patch by jbellis; reviewed by slebresne for CASSANDRA-2211

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1073352 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2211
c280e204d1e54188ae930c5fa5784cf8441bea53,"nodetool scrub
patch by jbellis and tjake; reviewed by slebresne for CASSANDRA-2217

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1073586 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-2217
38fc1ffbe302291b1990cbf2a5fee84afd6cf5c5,"clean up cli schema version check
patch by jbellis for CASSANDRA-2187

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1073599 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2187
cd362b94fc0cb5099b9b423b003bdc59d3dd6cb5,"add validateSchemaAgreement call + synchronization to schema modification calls
patch by jbellis; reviewed by gdusbabek for CASSANDRA-2222

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1073768 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2222
e6d74c13466afdcdaa433661245aac67e4a5888a,"fat clients were creating local data. patch by gdusbabek, reviewed by tjake. CASSANDRA-2223

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1073884 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-2223
53286d56f084270a457d8698785a189b8b410cc3,"fix supercolumn de/serialization when subcolumn comparator is different from supercolumn's
patch by slebresne; reviewed by jbellis for CASSANDRA-2104

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1074259 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-2104
09a1dd5e4af316fdacfb93463b20e29fff8d99db,"Cleanup and document EstimatedHistogram
Patch by jbellis, reviewed by brandonwilliams for CASSANDRA-2232

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1074291 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2232
9fd0cd4a0a872a0c942ae1f50420e5372ef69471,"add [get|set][row|key]cacheSavePeriod to JMX
patch by Jon Hermes; reviewed by jbellis for CASSANDRA-2100

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1074685 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2100
159c30feaff7b152833f74027c7e8f6af16a7252,"Add ""join"" command to nodetool
Patch by Pavel Yaskevich, reviewed by Sylvain Lebresne for
CASSANDRA-2160

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1075409 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-2160
0be3189b045bc41211a4dc1d411b8494c9da08c9,"movefile deletions off of scheduledtasks executor
patch by Mikael Sitruk; reviewed by jbellis for CASSANDRA-2253

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1075594 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2253
b065aac226069077d265801e18dc20a6f2b964e6,"avoid aquiring (and contending with flush for) flusherlock on each write
patch by slebresne; reviewed by jbellis and stuhood for CASSANDRA-1954

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1075634 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1954
8097545140716f0cbde4c9112a0de2d0b75698d3,"make nodetool scrub more robust
patch by jbellis and slebresne; tested by Sébastien Giroux for CASSANDRA-2240

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1075870 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2240
133acbb5910a47767adb6bcd198d5671fe1af611,"optimize node movement within the same arc of the ring
patch by Pavel Yaskevich; reviewed by Nick Bailey for CASSANDRA-1427

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1076349 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-1427
ed2a60707a70e21f1a2a61416f6ce3c3f1e0865e,"CFS correctly flushes index CFs.
Patch by jbellis, reviewed by brandonwilliams for CASSANDRA-2244

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1076699 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2244
c5f4f3b2be60652b380806c6928d8ec480d06941,"initialize localendpoint in gossiper earlier. patch by gdusbabek, reviewed by jbellis. CASSANDRA-2228

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1076866 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2228
688ff5bcc0f4c2223eb388ce6199d01403290f5e,"r/m unnecessary BBU.clone calls
patch by jbellis; reviewed by tjake for CASSANDRA-2271

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1077830 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-2271
82dd73b3a549b7d101aea9ee07dd31cf756035c6,"add rpc_[min|max]_threads
patch by tjake and jbellis for CASSANDRA-2176

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1077994 13f79535-47bb-0310-9956-ffa450edef68","['CassandraDaemon.java', 'Config.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-2176
cb71747c88efc7ad3e7dda67316855d6571aadfc,"add incremental_backups option
patch by Yang Yang and jbellis for CASSANDRA-1872

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1078858 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-1872
7eb445bfc9cbec31c239209cc5ca0699a83b9ac4,"move keyspace1 sample config out of cassandra.yaml
patch by Aaron Morton; reviewed by jbellis for CASSANDRA-2007

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1079462 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-2007
5947c5907258c81fce0ff8e8333fa9852ed31eaf,"add asserts to make sure we don't write zero-length rows; see CASSANDRA-2296

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1079650 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2296
0087c38a268d314172f06bcd522210ed8f226409,"avoid writing empty rows when scrubbing tombstoned rows
patch by jbellis; reviewed by slebresne for CASSANDRA-2296

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1079816 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2296
97e82b194dcd1fe585923978169fcd8fc66f4a81,"add ant.test.failure.ignore property to optionally allow codecoverage to complete even if tests error out
patch by Stephen Connolly; tested by jbellis for CASSANDRA-2298

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1079984 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2298
57b83afa0d5a968810ea74b2ab71a163aae3cd4a,"use AbstractType.fromString methods to marshal to BB

Patch by eevans for CASSANDRA-2027

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1080023 13f79535-47bb-0310-9956-ffa450edef68",['SelectStatement.java'],CASSANDRA-2027
45766ede2e16f670e46dbbf3ea602c143d7d59a6,"include secondary index CFs when deciding which CFs to flush under memory pressure
patch by jbellis; tested by Matt Conway for CASSANDRA-2295

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1080310 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-2295
b934e1eca8c62b2929f3c80809306b74a57e79d2,"reduce memory use during streaming of multiple sstables
patch by jbellis; reviewed by mdennis and tested by Joaquin Casares for CASSANDRA-2301

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1080433 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2301
7bc35b88ffcf0e7873bf1757cde7f6b6ff0f7a1d,"purge tombstoned rows from cache after GCGraceSeconds
patch by slebresne; reviewed by jbellis for CASSANDRA-2305

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1080577 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2305
7a0ebb9cb565cc99e80d9a688a385b0cdb0f6294,"fix stress.java column sizes
patch by jbellis; reviewed by Pavel Yaskevich for CASSANDRA-2312

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1080710 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2312
f652c69bf641c4d82d259c7ce81c2da1ea6c3f7c,"makerange queries respect snitch for local replicas
patch by jbellis; reviewed by slebresne for CASSANDRA-2286

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1080713 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2286
6a5baa564e5e6aa0ed361f9092e556e39669f173,"make2ary indexes use parentCF flush thresholds during initial build
patch by jbellis; reviewed by slebresne for CASSANDRA-2294

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1080718 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-2294
541e0b38d33c4035d1241ef8fe38a2c23e054454,"clear Built flag in system table when dropping an index
patch by jbellis; reviewed by mdennis for CASSANDRA-2320

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1081546 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2320
f84aed6d44976b1017b5139e151ac1ed701a0ca7,"Queue secondary indexes for flush before the parent.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-2330

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1081876 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2330
4ef269d017db15ddf83466fa71e2bdb35ee98ab5,"add memtable_flush_queue_size defaulting to 4
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2333

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1081908 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-2333
6184b17aab814bb5d7ea8b68e53e005554b0bb7d,"reduce contention on Table.flusherLock
patch by Stu Hood and jbellis; reviewed by slebresne for CASSANDRA-1954

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1081929 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1954
703e148b88994eeb9327108d642a55412d3b552a,"Refactor row/key cache handling.
Patch by slebresne, reviewed by Matthew Dennis for CASSANDRA-2272

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1082236 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-2272
27619afb03be30c0b5d644810101266a818b1be7,"Allow configured ports and initial token to be overridden by system
properties.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-2343

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1082388 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-2343
ebc7278d7845edb149f3a0169408deefeb86f6a5,"sanitize configuration code. patch by Jon Hermes, reviewed by gdusbabek. CASSANDRA-1906


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1082510 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-1906
a0498517f2feb70db1ad0cad5417577b11cd74cc,"fix comparator used for non-indexed secondary expressions inindex scan
patch by Roland Gude and jbellis for CASSANDRA-2347

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1082807 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2347
09a2667e7de7f85f4c2c0ec9507ec725ae5c5dab,"ensure size calculation and write phase of large-row compaction use the same threshold for TTL expiration
patch by slebresne; reviewed by jbellis for CASSANDRA-2349

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1082820 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-2349
46b0dd5f108502b9abf82e54afda95e42d42df84,"fix race when iterating CFs during add/drop
patch by jbellis; reviewed by gdusbabek for CASSANDRA-2350

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1082910 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2350
4b646596204d70d2943619e07ed72b784f695b6c,"add cache loading to row/key cache tests.
Patch by Pavel Yaskevich and Matthew Dennis, reviewed by Pavel Yaskevich
for CASSANDRA-2227

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1084028 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2227
ec26ee73bf05812cc79af2a3d63ba5bfac7ffd31,"fix encoding bugs in HintedHandoffManager, SystemTable when default charset is not UTF8
patch by slebresne; reviewed by jbellis for CASSANDRA-2367

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1084660 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-2367
2287fe0044117592a38bb07f06672b3a9211d38a,"Atomically switch cfstore memtables and sstables
patch by slebresne; reviewed by jbellis for CASSANDRA-2284 (and CASSANDRA-2105)



git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1086226 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-2284
84acaa2ec51869316b2de0e1c1d3b3bf4ad63be1,"Fix build (for CASSANDRA-2284)


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1086232 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2284
b62b0aedd67a387b8d4b5f8bc083803e2fd99dae,"merge CASSANDRA-2367 from 0.7


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1086266 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-2367
979ce41ef44a0444188f73ab0ab4ce8253d1c3fe,"fix migration race vs flush
patch by jbellis; reviewed by gdusbabek for CASSANDRA-2381

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1086343 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2381
92da3e2d60a37999110648528fc7cb7659dd66e6,"add actual dropped check to Memtable.flush for CASSANDRA-2381
patch by jbellis

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1086350 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2381
323ee4606cf4bd20cc98d2a2e7986386e9a83822,"r/m unnecessary isDropped check from maybeSwitchMemtable (the one in Memtable.writeSortedContents it the important one)
patch by jbellis for CASSANDRA-2381

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1086351 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2381
4d1af49b98e6c0cb6b1908645d321bd21b448e4c,"introduce ICache, InstrumentingCache, IRowCacheProvider
patch by jbellis, Jon Hermes, and Vijay for CASSANDRA-1969

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1089078 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java', 'NodeProbe.java']",CASSANDRA-1969
9c9e79b357fd78a142cef4123e8f56333ff79032,"fix sstable read count regression
patch by Stu Hood; reviewed by jbellis for CASSANDRA-2422

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1089276 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2422
80d3decdfe70b12422c24cd71405aecc5a02b97e,"add SerializingCacheProvider
patch by Vijay and jbellis for CASSANDRA-1969

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1089555 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-1969
381401af7095c9244abe81ff2c13617c1fdf975a,"remove unnecessary copy during range/index scans
patch by jbellis; reviewed by slebresne for CASSANDRA-2425

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1089920 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2425
2e7ecdb6819d5e6f087097680ef4f60de41c8067,"Support a byte[] key for getNaturalEndpoints so clustertool get_endpoints does not throw exception
patch by goffinet; reviewed by stuhood for CASSANDRA-2437



git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1089955 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-2437
22fc25b9a223205f89293c7143aeb15de3ce6cfb,"Use {Lazy|Pre}CompactedRow for CommutativeRowIndexer
patch by slebresne; reviewed by stuhood for CASSANDRA-2313


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1089993 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-2313
48a072dac26e89991bed9e0a0226d3880389db99,"Don't all cleanup if ring is not joined (since this wiped all data)
patch by slebresne; reviewed by jbellis for CASSANDRA-2428


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1090007 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2428
f4b3c01dffa486f881b98ee83556fc372de59850,"add a server-wide cap on memtable memory usage
patch by jbellis; reviewed by Stu Hood for CASSANDRA-2006

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1090064 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-2006
47cd73ef46ba851731491381582027966f590a27,"thrift 0.6 tweaks. patch by gdusbabek, reviewed by tjake. CASSANDRA-2412


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1090075 13f79535-47bb-0310-9956-ffa450edef68",['CassandraDaemon.java'],CASSANDRA-2412
dc89826fd89720da0c5ad2de9fb54afeb712136a,"Make repair work on a token range instead of the full ring
patch by slebresne; reviewed by stuhood for CASSANDRA-2324


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1090840 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-2324
8c7bc2fe8718d612fdbcf0f8b7e33554f17efcaa,"push replication_factor into strategy_options
patch by jhermes and jbellis; reviewed by jhanna for CASSANDRA-1263

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1090905 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-1263
570ac26fc657950c1eedbf0b31e580e8c47bc7e8,"give snapshots the same name on each node
patch by Nick Bailey; reviewed by jbellis for CASSANDRA-1791

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1090925 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-1791
1e5f900646ab3e30de807e2f512cc6eec3ad4ae0,"re-set bootstrapped flag after move finishes
patch by jbellis; reviewed by Peter Schuller and Nick Bailey for CASSANDRA-2435

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1090926 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2435
beac419bd36a033c6376d3b91455abdeddc85685,"Multithreaded compactions
patch by stuhood; reviewed by slebresne for CASSANDRA-2191


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1090978 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-2191
32ac6ee760c979b0094c8f9e9a710bf27326253b,"Compaction throttling
patch by stuhood; reviewed by slebresne for CASSANDRA-2156


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1090979 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-2156
ce39c95457b3268ccd0dfe79d04ce1a7096d77b6,"r/m nodetool loadbalance
patch by Nick Bailey; reviewed by jbellis for CASSANDRA-2448

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1091139 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-2448
f33c4fdc5d883f5dc2252c0d0dfbd6dfa73deefc,"r/m unnecessary declaration of IOException from IColumnIterator.getColumnFamily
patch by Stu Hood; reviewed by jbellis for CASSANDRA-2446

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1091447 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2446
643ef396d7c95b0930cf4528a78182f8550736fd,"Make clean compactions cleanup the row cache
patch by slebresne; reviewed by jbellis for CASSANDRA-2451


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1091503 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2451
b4682e26627ae81abb3f1145f75b177f5054bf08,"Merge CASSANDRA-2451 from 0.8


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1091513 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2451
4ba0e3c89db1c038f1e17f7d340aa4b1140654f1,"madeCompactionInfo.getTaskType return an enum
patch by nickmbailey; reviewed by jbellis for CASSANDRA-2482

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1092523 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2482
21015c435b6af5c11ca10961ad484d5eb501984b,"fix possible counter deadlock
patch by Kelvin Kakugawa, Stu Hood, and slebresne for CASSANDRA-2454

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1092525 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2454
b553e773310deb0f17a0ded6424fac1e03614859,"fix duplicate results from CFS.scan
patch by Pavel Yaskevich and jbellis for CASSANDRA-2406

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1092722 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2406
2828cb4ecfe3f3efb1372d9008f702ea301af2c5,"make DD.defsVersion volatile
patch by Jeffrey Wang; reviewed by jbellis for CASSANDRA-2490

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1094011 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-2490
aaef16ed122fa3cac60f9e7ac7448ce9f062c574,"Update row cache post streaming
patch by slebresne; reviewed by jbellis for CASSANDRA-2420


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1094481 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2420
98eaa99a6c0ed581108174dc32d426c5294f8e1c,"Merge CASSANDRA-2420 from 0.8


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1094484 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2420
86f6184d0d09f3f3a2c6d080c88e31810f373020,"avoid caching token-only decoratedkeys
patch by jbellis; reviewed by slebresne for CASSANDRA-2416

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1094647 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-2416
7dbb7983c248419e2d43ad11296f6d8f3e7e87dc,"preserve version when streaming data from old sstables
patch by jbellis; reviewed by Stu Hood for CASSANDRA-2283

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1094789 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2283
606c9d9baa095e393304ed20ebb770164ae47217,"Fix batch_mutate with mixed counter/standard mutations
patch by slebresne; reviewed by stuhood for CASSANDRA-2457


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1095334 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2457
20cdc0f4751b8b140498316a7be80c05a02932c6,"merge CASSANDRA-2457 from 0.8


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1095335 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2457
6dc75ce2f3305d9568f9a7e7078bd87c04009218,"Fix updating column metadata validation class
patch by jbellis; reviewed by slebresne for CASSANDRA-2512


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1095696 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-2512
64621c76a3b99a9655bb708f88f434b6f158795e,"merge CASSANDRA-2512 from 0.7


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1095699 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-2512
c948fd286495616988cf707b043baf63540b4585,"merge CASSANDRA-2512 from 0.8


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1095701 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-2512
2a20c799e41969ca29892a92039d8aa5c4cb5379,"centralize timeout logging in StorageProxy, and preserve the timeoutexception message
patch by Stu Hood; reviewed by jbellis for CASSANDRA-2532

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1096483 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2532
1b24a02c4cf8d4fce042e3f9b2f34945b729fcef,"force GC to reclaim disk space on flush, if necessary
patch by jbellis; reviewed by slebresne for CASSANDRA-2404

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1096531 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2404
8832e7bcc394cc8b48ebbc167b2b7aefc84fae23,"nodetool print compaction percent complete
patch by Chris Burroughs; reviewed by jbellis for CASSANDRA-2551

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1096612 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2551
d9d4176fdf352633c8f6bab9f5df987dea26b312,"Fix sending mutation messages multiple times
patch by skamio; reviewed by slebresne for CASSANDRA-2557


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1096675 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2557
21ee75efc14bce1e55d08d96489fe0c7ea418fe5,"merge CASSANDRA-2557 from trunk


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1096676 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2557
f05d1881ae392b0f18cac927d7e7202dc0728dc8,"movegossip heartbeat back to its own thread
patch by jbellis; reviewed by slebresne for CASSANDRA-2554

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1096805 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-2554
6ef7817d568845cde8a0bde12af1eabfc8d4426c,"make forceUserDefinedCompaction always try to attempt what is requested
patch by jbellis; reviewed by slebresne for CASSANDRA-2575

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1097530 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2575
4f3e4cca2a9ecf609d7119da8c5c6901c0a06ee6,"Add option to configure number of compaction thread
patch by slebresne; reviewed by stuhood and jbellis for CASSANDRA-2558


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1097887 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java']",CASSANDRA-2558
7a49fb07979f7f8edaa638e5decce2366dda4102,"merge CASSANDRA-2558 from 0.8


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1097889 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java']",CASSANDRA-2558
ffb82b0539248644062d50543f5f555017cb6996,"remove unframed Thrift transport option
patch by jbellis; reviewed by eevans for CASSANDRA-2586

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1098622 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-2586
c473679a233ba60e18be3daeb327becc439939cd,"add liveOnly flag to SSTable.componentsFor
patch by Aaron Morton; reviewed by jbellis for CASSANDRA-2602

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1099624 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-2602
282bd51f64772e9208c2bcc1751b8e1abe321ad0,"include indexes in snapshot
patch by jbellis; reviewed by slebresne for CASSANDRA-2596


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1099816 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2596
d383294daf148e7246786313706917fadc6ad50a,"snapshot_before_compaction directoryname fix
patch by jbellis; reviewed by mck for CASSANDRA-2598

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1099849 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2598
3b907655c78131cc2950c2f7f36ea62d8a341e31,"improve ignoring of obsoletemutations in index maintenance
patch by jbellis; reviewed by slebresne for CASSANDRA-2401

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1099892 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2401
5f8991c73a6f43fbe9c7e0d8906e751c21d54412,"recognize attempt todrop just the index while leaving the column definition
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2619

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1100464 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2619
8d3922771b1b593b79445058f26b9c9da568fcb2,"fix CQL treatment of> and <operators in range slices
patch by Pavel Yaskevich and jbellis for CASSANDRA-2592

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1100657 13f79535-47bb-0310-9956-ffa450edef68",['SelectStatement.java'],CASSANDRA-2592
dec698f840e56ecf32e0c813cd5183e6051aa869,"fix potential double-application of counter updates on commitlog replay
patch by slebresne and jbellis for CASSANDRA-2419

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1100671 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-2419
a1c1abfba6989872ac354ff9528c0f088cff4887,"add support for presenting row key as a column in CQL result sets
patch by jbellis; reviewed by thobbs for CASSANDRA-2622

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1101182 13f79535-47bb-0310-9956-ffa450edef68",['SelectStatement.java'],CASSANDRA-2622
c8f2414688e11b457be8305017fe34db0e85ffe5,"Fix regression where boostrapping a node without schema defined fails
patch by slebresne; reviewed by jbellis for CASSANDRA-2625


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1101772 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2625
d2c98b024d85bf72a6ce3e03d0b8d2994199c254,"avoid using cached position of a keywhen GTis requested
patch by Richard Low and slebresne; reviewed by jbellis for CASSANDRA-2633

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1101933 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-2633
61adae4fdcb34e303a07ec34c8ff05726ed5de13,"fix counting bloom filter true positives
patch by jbellis; reviewed by slebresne for CASSANDRA-2637

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1101940 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-2637
4a604fbebc1d06ee569749f69a5cd608e26e4c89,"Avoid wrong empty result with secondary index when limit=1
patch by slebresne; reviewed by jbellis for CASSANDRA-2628


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1102337 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2628
50b490e046bdc23b23fbb268400abcc41a0de72c,"add quote-escaping via backslash to CLI
patch by pyaskevich; reviewed by jbellis for CASSANDRA-2623

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1102352 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-2623
5f38849a240b778627e4177d2b849c592d0f372b,"switch purge-compacted-sstables-at-startup logging to DEBUG level
patch by jbellis; reviewed by rcoli for CASSANDRA-2411

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1102873 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2411
050d129179b99fa88d25a65afed78d0fedb24f1e,"don't perform HH to client-mode
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2668

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1125002 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2668
83fc44b2950e738ad3dd49c1a6e158b2f5192f80,"Add sstable bulk loading utility
patch by slebresne; reviewed by jbellis for CASSANDRA-1278


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1126477 13f79535-47bb-0310-9956-ffa450edef68","['SSTableReader.java', 'StorageService.java']",CASSANDRA-1278
e496f0deb44a71fdea8512405bfbd33e7907bbd0,"add special case message for attempted compaction of < 2 sstables
patch by jbellis for CASSANDRA-2697

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1127034 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2697
8610e8d7409e68d89e272bb4c8c3c65ca33e6cfe,"Show rack and dc in nodetool ring/info.
Patch by Alex Araujo, reviewed by brandonwilliams for CASSANDRA-2531

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1127336 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-2531
840c56cb6b330f8de8754991828e577519719e93,"close scrub file handles
patch by jbellis; reviewed by slebresne for CASSANDRA-2669

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1127589 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2669
4e96cc9d41bccc9781cbe3008db6e72c91c7d5f1,"fix NPE	when bypassing commitlog during	memtable flush

Patch by tjake;	 reviewed by Sylvain Lebresne for CASSANDRA-2718


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1128306 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-271
a6be23463d4c0edbbfb709a88481e3ea04911816,"Don't throw exception if daemon isn't running, just return false for isRPCServerRunning()
patch by goffinet; reviewed by slebresne for CASSANDRA-2721


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1129049 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2721
04ef1ea9d1c0a2282765e7f1b5d832e7550c2ac6,"Merged from trunk (CASSANDRA-2721)


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1129088 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2721
992cc99cec0a94c0df9c0119f252d5973711565c,"Added statusthrift to nodetool to report if thrift server is running.
patch by goffinet; reviewed by slebresne for CASSANDRA-2722


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1129094 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-2722
3d9305b505471db21bd73d79a95d7d4a4981433b,"Reset SSTII in EchoedRow iterator (see CASSANDRA-2653)


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1129151 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2653
7e40e39a4e42d13887f4bb6771238ccd8f11f05c,"Fixed rows being cached if they do not exist.
patch by goffinet; reviewed by stuhood for CASSANDRA-2723


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1129462 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2723
cd60613ae03642a841c0fd460205bcf78b10249c,"fix truncate/compaction race
patch by jbellis; reviewed by slebresne for CASSANDRA-2673

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1130191 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-2673
3f72d0906f17b948f2650018136bc3a449cb5f8c,"Support passing tableName and cfName to RowCacheProviders
Patch by goffinet, reviewed by stuhood for CASSANDRA-2702


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1130863 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2702
592634c6460624fe58adaf53f5ad39635f629a17,"restrict repair streaming to specific columnfamilies
patch by stuhood and jbellis; reviewed by slebresne for CASSANDRA-2280

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1133167 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageService.java']",CASSANDRA-2280
129d80a4743c5fb431e22e2b4782c092f0703b98,"extract AbstractCompactionStrategy, AbstractCompactionTask
patch by Alan Liang and Ben Coverston; reviewed by jbellis for CASSANDRA-1610

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1134460 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-1610
e70e73352d8d9d49b88bd9a71d666328cae2cad6,"rename minor -> background, major -> maximal
patch by Alan Liang for CASSANDRA-1610

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1134461 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-1610
41510386fcd4edcada3713890a66115758bc4e28,"add cql key alias support
patch by pyaskevich; reviewed by jbellis for CASSANDRA-2480

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1134502 13f79535-47bb-0310-9956-ffa450edef68",['SelectStatement.java'],CASSANDRA-2480
e1a1ec5dbed98b5215682fce82a1e9cf2ae4b7fa,"r/m memtable_flush_after_mins
patch by Patricio Echague; reviewed by jbellis for CASSANDRA-2427

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1134504 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-2427
eafd19e59b2f8fde3b4e13b6835fa2b30b9c0056,"remove active-pull schemarequests
patch by jbellis; reviewed by jbellis for CASSANDRA-2715

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1135116 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2715
a3e292648541aeac51be5df40238fde8abed6747,"r/m binarymemtable
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2692

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1135249 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-2692
67949f63f19f6397f4aaac7bf0f199b136d4addb,"Don't skip rows in scub for counter column families
patch by slebresne; reviewed by jbellis for CASSANDRA-2759


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1135426 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2759
102546162af4d26f0baa85ac96dc85a47c36fb28,"add commitlog_total_space_in_mb
patch by Patricio Echague; reviewed by jbellis for CASSANDRA-2427

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1135809 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-2427
45d1dc7d2a1ffc2380f93bfd22aeb556c15a60b6,"removed commitlog_rotation_threshold_in_mb configuration
patch by Patricio Echague; reviewed by jbellis for CASSANDRA-2771

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1135869 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-2771
27f189c6d244a7601a6587d37e89870b03c9c0c8,"Avoids unmarking compacting sstable prematurely during cleanup
patch by slebresne; reviewed by jbellis for CASSANDRA-2769


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1136135 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2769
d8b1fc3952caa22be53e20d0e145aa3137ffc58e,"replace CollatingIterator, ReducingIterator with MergeIterator
patch by stuhood; reviewed by jbellis for CASSANDRA-2062

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1136287 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-2062
63fa8711a3764951ac5ffe0cff4623c665ab6885,"Fixed the ability to set compaction strategy in cli using create column family command
patch by alanliang; reviewed by goffinet for CASSANDRA-2778


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1136662 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2778
dc76b2764a6b70cfd3d41862e413a0f8e6f095f4,"r/m last references to commons-collections
patch by stuhood; reviewed by jbellis for CASSANDRA-2784

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1136679 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2784
33983738fabb4624881a1cca2d2b4406c2ea6330,"Fix compaction of the same sstable by multiple thread
patch by slebresne; reviewed by jbellis for CASSANDRA-2769


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1136904 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2769
5d2e61dc45cf62072564b021081f1b7d4b34821c,"Add startup flag to renew count node id
patch by slebresne; reviewed by jbellis for CASSANDRA-2788


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1137550 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2788
e17513b927522a4182e9812100979bb37ccb51d9,"clean up tmpfiles after failed compaction
patch by Aaron Morton; reviewed by slebresne and Stu Hood for CASSANDRA-2468

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1138740 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-2468
a6de715c07c380e6b967fb690a3c88a614d56c85,"Expose number of threads blocked on submitting a memtable for flush
patch by slebresne; reviewed by jbellis for CASSANDRA-2817


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1138996 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-2817
d12de23b4c8e4fadfd9512cf5cf908571722d10c,"add ""nodetool endpoints""
patch by Patricio Echague; reviewed by jbellis for CASSANDRA-2776

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1139264 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-2776
5ab85a6c375343f0388f07afb13efaa06f6cc6b4,"don't bother persisting columns shadowed by a row tombstone
patch by Aaron Morton; reviewed by jbellis for CASSANDRA-2589

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1140935 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2589
1f75bfa1a854fdf9a6a635cba6ff6abd9d9dd814,"Fix scan wrongly throwing assertion errors
patch by slebresne; reviewed by jbellis for CASSANDRA-2653


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1141129 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2653
2c8d2013950575eaff87941073a5fc769328fcff,"Reset CF and SC deletion time after gc_grace
patch by slebresne; reviewed by jbellis for CASSANDRA-2317


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1142690 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2317
bc4dd9335f947eceb90f00581b01bd6533ff523e,"Handle row tombstones correctly in EchoedRow
patch by slebresne; reviewed by jbellis for CASSANDRA-2786


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1143352 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2786
c2106fa776293f865975e9e591807f1b0213be9b,"add MessagingService.get[Recently]DroppedMessages and StorageService.getExceptionCount
patch by jbellis and Ryan King; reviewed by slebresne for CASSANDRA-2804

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1143428 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-2804
6a9a336ad4a4621aeb7bf73a4e6cd15aaf74323d,"ensure that string tokens do not contain commas
patch by jbellis; reviewed by slebresne for CASSANDRA-2762

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1143476 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-2762
da6369b4daae24e3114b0501929b3605c7a3a3ce,"track max client timestamp per-sstable
patch by Alan Liang; reviewed by jbellis for CASSANDRA-2753

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1143627 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-2753
ab42d9825016f0c4daa5d92df7f7574027fab6a7,"support spaces in path to log4j configuration
patch by David Allsopp; reviewed by jbellis for CASSANDRA-2383

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1145849 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-2383
ed18ee0c728ae069b7e41161bb301c9688491cbf,"single-pass streaming
patch by Yuki Morishita; reviewed by jbellis for CASSANDRA-2677

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1146117 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-2677
fcb7e7a7c51778cac7f5e82461b968bfffaefd3c,"Expose data_dir through JMX.
Patch by Mike Bulman, reviewed by brandonwilliams for CASSANDRA-2770

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1147248 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2770
5616b0235aa4e32e49b58d707de2c98310cf0b9d,"Fix JMX bulkload call
patch by slebresne; reviewed by jbellis for CASSANDRA-2908


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1147838 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2908
466ff41a7d9449330dfd869f309c25988671090d,"ensure that we never estimate 0 keys when streaming non-empty ranges
patch by Stu Hood; reviewed by jbellis for CASSANDRA-2916

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1148029 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-2916
b6eb2ac24d81b1832d88b99de8f2b0c0ab3ad4e9,"CQL: include only one row per unique keyfor IN queries
patch by Jim Ancona; reviewed by pyaskevich for CASSANDRA-2717

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1148425 13f79535-47bb-0310-9956-ffa450edef68",['SelectStatement.java'],CASSANDRA-2717
7f9f79622aad20cb65349c9765fb43b0e0fa72b6,"fix re-using index CF sstable names after drop/recreate
patch by jbellis; reviewed by slebresne for CASSANDRA-2872

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1148466 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2872
d20f76251e63b0f763df130152f46942a653a5e7,"Don't sample the system table keys when choosing a bootstrap token.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-2825

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1148866 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2825
152ee37e22dd31c150021f57adbbc3e39a184dd1,"fix hint replay
patch by brandonwilliams and jbellis for CASSANDRA-2928

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1149015 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-292
04c0b8143e90d5470823fc35ed1ff5f83371ed72,"Use reference counting to delete sstables instead of relying on the GC
patch by slebresne; reviewed by jbellis for CASSANDRA-2521


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1149085 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-2521
365f11ce06c5b196f08851a9d89c122c24941743,"Properly synchronize merkle tree computation
patch by slebresne; reviewed by jbellis for CASSANDRA-2816


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1149121 13f79535-47bb-0310-9956-ffa450edef68","['CompactionManager.java', 'StorageService.java']",CASSANDRA-2816
d3890470cf71fbad887a5c4bc256bbdce92c654a,"split BRAF into RandomAccessReader and SequentialWriter
patch by pyaskevich and jbellis for CASSANDRA-2921

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1149628 13f79535-47bb-0310-9956-ffa450edef68","['CompactionManager.java', 'SSTableReader.java']",CASSANDRA-292
14f82e900d43f54ff8a1a0a74d5c8c0375f244f1,"Don't include tmp file as sstable when creating cfs
patch by slebresne; reviewed by jbellis for CASSANDRA-2929


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1149716 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-292
97630596fb983d10c8259f299ce0d6ef649c219a,"add ability to drop local reads/writes that are going to timeout
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2943

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1150837 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2943
b9dc6a60049118c2949ec4dc122ddc779a4973c6,"Gossip handles dead states, token removal actually works, gossip states
are held for aVeryLongTime.
Patch by brandonwilliams and Paul Cannon, reviewed by Paul Cannon for
CASSANDRA-2496.

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1150847 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageService.java']",CASSANDRA-2496
ea44997bd223d8da580cf93fbc54f13ba8011815,"Remove SSTableWriter.Builder
patch by jbellis and stuhood; reviewed by Yuki Morishita for CASSANDRA-2920

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1150984 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-292
e688815e5a05ba75b7a78c2da58d11a22d95b65c,"add row_cache_keys_to_save CF option
patch by Chris Burroughs; reviewed by jbellis for CASSANDRA-1966

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1151205 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-1966
474547cf16aad0d97bfa455d864340ee1c44e1a4,"stop reading cache after max size-to-save is reached
patch by Chris Burroughs; reviewed by jbellis for CASSANDRA-2082

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1151211 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2082
3ac8f2fe5eb30d2c18bdd42c1c565da07968c16e,"check column family input validity in nodetool repair
patch by yukim; reviewed by slebresne for CASSANDRA-2933


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1151497 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2933
2b3e73da724ba172a561e1ca7e4988e4c53aec1f,"Gossiper notifies of local state changes.
Patch by Sam Overton, reviewed by brandonwilliams for CASSANDRA-2948

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1151659 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2948
bc5478678494a5ae957ac5842d587157c53868fc,"Add asynchronous and half-sync/half-async thrift servers.
Patch by Vijay Parthasarathy, reviewed by brandonwilliams for
CASSANDRA-1405

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1152233 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-1405
b043d68211052e31dac24ab2f27dde16d356a784,"Add asynchronous and half-sync/half-async thrift servers.
Patch by Vijay Parthasarathy, reviewed by brandonwilliams for
CASSANDRA-1405

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1152238 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-1405
5762dd08de4ddd1450da681e304a0e684baff2da,"Flush memtables on shutdown when durable writes are disabled
patch by jbellis; reviewed by tjake for CASSANDRA-2958

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1152419 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2958
51be0c068dd07a9a3e0e943309ddf29f1b5061f2,"log full MS address on startup
patch by Jackson Chung; reviewed by jbellis for CASSANDRA-2971

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1152420 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-2971
5f474da8ee68a306816d2134190996b118b65d96,"split rpc_timeout into read,write, scan, and ""other"" timeouts
patch by Melvin Wang; reviewed by jbellis for CASSANDRA-2819

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1152541 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java']",CASSANDRA-2819
c918570674c2c0106b3df328cc5aa89fb41372dc,"Ignore system tables during repair
patch by norman; reviewed by slebresne for CASSANDRA-2979


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1152870 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2979
e51401b2b755b74384a17276e3a05913e5df05ea,"Don't sample the system table keys when choosing a bootstrap token.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-2825

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1152876 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2825
76d625d5094807a10e6e2f10c5e314c957053170,"avoid NPE when flushing in shutdown hook
patch by jbellis for CASSANDRA-2958

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1152891 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2958
388c690c228b3e93ca870d5f6bdfe3554bd5c6e0,"fix ""short reads"" in [multi]get
patch by Byron Clark; reviewed by jbellis for CASSANDRA-2643

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1153115 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2643
1ecabe6842472f1793eafe2492b648823d8e4f83,"Add optional compression for sstables
patch by xedin; reviewed by slebresne for CASSANDRA-47


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1153210 13f79535-47bb-0310-9956-ffa450edef68","['CompactionManager.java', 'SSTableReader.java']",CASSANDRA-47
c715b6d9be15c637dddd156456616bb4cf598c47,"Reduce copies on read/write paths.
Patch by jbellis reviewed by brandonwilliams for CASSANDRA-1788

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1153678 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-1788
5dc93856fd052607bfbfd8c394fbc57ee44e87d9,"describe_ring returns the interface thrift is bound to instead of the
one the storage proto is bound to.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-1777

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1153683 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-1777
bc756792aa4cef31e4274045ec14768b8375674b,"Fix NPE in getRangeToRpcaddressMap
patch by slebresne; reviewed by jbellis for CASSANDRA-2996


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1154219 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-2996
2e25600fabab058b642a301d92bc2732e0b3d560,"prune index scan resultset back to original request
patch by jbellis; tested by Roland Gude for CASSANDRA-2964

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1154267 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2964
53dc854ba75612213f88ce50c48c5874205a3868,"refactor CompactionIterator -> CompactionIterable
patch by jbellis; reviewed by slebresne for CASSANDRA-2901

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1154635 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2901
016068ab27cd6735309e44837b09d77a2387d4c2,"Make ColumnFamily backing column map pluggable and introduce unsynchronized ArrayList backed map for reads
patch by slebresne; reviewed by jbellis for CASSANDRA-2843


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1155426 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2843
c9ff755776931c8d999699401b3a73bc796fcf3c,"avoid doing read forno-op replicate-on-write at CL=1
patch by slebresne and jbellis for CASSANDRA-2892

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1155460 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2892
8fdc12e5e3da9ba229cd91fb2bb6dd1bc1385a36,"switch back to only logging recent dropped messages
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3004

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1155558 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-3004
00f6a2495ff3e73bfad05b7c74d3df18e322a431,"ignore saved replication_factor strategy_option for NTS
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3011

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1156244 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3011
daf3b012c77483480e4df0970126186e5dbff483,"Use broadcastAddress instead of localAddress.
Patch by Vijay, reviewed by brandonwilliams for CASSANDRA-3000

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1156254 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-3000
621d1f98639369717b6d09f8dd066b2a2d129e09,"Refactoring of the secondary index api
patch by Jake Luciani; reviewed by Pavel Yaskevich for CASSANDRA-2982

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1156567 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-2982
dfcb62163b6cfba75714357ee4f63f1b59f9e87a,"fix NPE when encryption_options is unspecified
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3007

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1156749 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-3007
453a67130bed7990fe018561f292ece899a5e3a0,"provide monotonic read consistency
patch by jbellis; reviewed by slebresne for CASSANDRA-2494

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1156758 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2494
4069d8af44241b84cfdfa60dc362868ef5241ecf,"make sure truncate clears out the commitlog
patch by jbellis; reviewed by slebresne for CASSANDRA-2950

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1156763 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2950
9ede4975ba35136763a2fcf36c5447d9bf1e2290,"cache invalidate removes saved cache files
patch by Ed Capriolo; reviewed by jbellis for CASSANDRA-2325

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1156772 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2325
2c2419ea1fac39602f1728b1d94103d13bcca7eb,"change auto_bootstrap default to true and remove from example config file
patch by jbellis as suggested by Peter Schullerfor CASSANDRA-2447

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1156837 13f79535-47bb-0310-9956-ffa450edef68",['Config.java'],CASSANDRA-2447
e987e3b88fb8ca88d1c69bbe48235dd770d8042a,"default auto_bootstrap to true and remove from example configuration
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2477

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1158005 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2477
24bf5a20ea168e387b9537654b169f1156a32c1b,"Add 'load new SSTables' functionality to JMX and corresponding ""refresh"" command to the nodetool
patch by Pavel Yaskevich; reviewed by Brandon Williams for CASSANDRA-2991

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1158008 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-2991
01883da5fc68b6570fac934fbfe5e5340b5b98de,"Re-introduce FastByteArrayInputStream (and Output equivalent)
Patch by Paul Loy, reviewed by brandonwilliams for CASSANDRA-2820

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1158410 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2820
41d83e0157e8d51787d5db2925c9e86f51bf77b7,"Make cleanup and normal compaction able to skip empty rows (rows containing nothing but expired tombstones).
patch by Jonathan Ellis; reviewed by Pavel Yaskevich for CASSANDRA-3039

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1158425 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-3039
4deb77971a43cf5a55bd2e2835255ff044137fc5,"Fix missing logging for some exceptions
patch by Jonathan Ellis; reviewed by Pavel Yaskevich for CASSANDRA-2061

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1158439 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2061
4ce338af735fdde13ec2a77be7ec9b97a804c04d,"Refactor and optimize ColumnFamilyStore.files(...) and Descriptor.fromFilename(String) and few other places responsible for work with SSTable files
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-3040

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1158452 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3040
79ec1bf35269139cbeae15cf17529aab4a32f261,"Add 'load new SSTables' functionality to JMX and corresponding ""refresh"" command to the nodetool
patch by Pavel Yaskevich; reviewed by Brandon Williams for CASSANDRA-2991

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1158642 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-2991
b95a49c5f9e22225fc0ebc703fd62bd8241bd9d7,"Arena allocation for memtables
patch by jbellis and stuhood for CASSANDRA-2252

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1158927 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-2252
266a213453b85b4293e566d87cfd6419c0c08c19,"update enum comparison to use ==
patch by dbrosius; reviewed by jbellis for CASSANDRA-3046

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1158932 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3046
db2d62c22ab514efcb3c137f3b09f2270df84aa6,"Fix sstable file scan when one ColumnFamily starts with the name of another
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-3040

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1159780 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3040
5001907f77a0c5f70bf1cdd6acd50242b37b47b5,"javadoc corrections
patch by dbrosius; reviewed by jbellis for CASSANDRA-3063

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1159832 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'MessagingService.java']",CASSANDRA-3063
791a78f92c8318991cd9207bbca99b470174044a,"Stop reading from sstables once we know we have the most recent columns
patch by Daniel Lundin and jbellis for CASSANDRA-2498

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1159942 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2498
34e2ae59a9f8040d8c33a274fd0dd35822beee5c,"Add ""install"" command to cassandra.bat
patch by Ben Coverston; reviewed by jbellis for CASSANDRA-292

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1160429 13f79535-47bb-0310-9956-ffa450edef68",['CassandraDaemon.java'],CASSANDRA-292
8deaa64751c6db3bdb8b3ef5920ab6cca9cbd50a,"avoid retaining references to dropped CFS objects in CompactionManager.estimatedCompactions
patch by Dan LaRocque; reviewed by jbellis for CASSANDRA-2708

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1160436 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-2708
2e0a805f15bcbb6fbaa6c08a01efc4dc99a28648,"expose rpc timeouts per host in MessagingServiceMBean
patch by Melvin Wang; reviewed by jbellis for CASSANDRA-2941

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1160449 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-2941
7b532bcada7959f6ba04618f427f1b9dfe17ecd1,"Refactoring of the DatabaseDescriptor/CFMetadata/Table to support o.a.c.config.Schema which will be handling all schema quering/mutations
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-1391

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1160494 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'SelectStatement.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-1391
ab04470b27eba55c270280a5efc1d19a7edcd558,"Remove gossip state when a new IP takes over a token.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-3071

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.7@1160825 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3071
5d7e2fba24f99939e44dd082864c1dad55b3726f,"allow sstable2json to work on index sstable files
patch by jbellis and tjake for CASSANDRA-3059

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1161137 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-3059
428eaec33857126b2fe32e0918ee809e868fe8d4,"Fix NPE in describe_ring with a mixed cluster.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-3032

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1161189 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3032
ed0df5f4786854a7cc9596c43925156629fd1ba2,"add LeveledCompactionStrategy
patch by Ben Coverston; reviewed by jbellis for CASSANDRA-1608

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1162217 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-1608
f0ee59d4c08d97119da4acd8815eef4f93311a3f,"add LeveledCompactionStrategy (take 2)
patch by Ben Coverston; reviewed by jbellis for CASSANDRA-1608

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1162223 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-1608
015c94c60313cbad00336f8ed14f922cb315f9eb,"Always hint counters
patch by slebresne; reviewed by jbellis for CASSANDRA-3099


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1162844 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3099
86cbff7af6df6a3eea2f27b7ba01ad57e8436990,"reduce window where dropped CF sstables may not be deleted
patch by jbellis; reviewed by slebresne for CASSANDRA-2942

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1162849 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2942
58e29caa2882defad24e6617667b39ef52da97d6,"fix log4j initialization in EmbeddedCassandraService
patch by jbellis; reviewed by tjake for CASSANDRA-2857

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1162851 13f79535-47bb-0310-9956-ffa450edef68",['CassandraDaemon.java'],CASSANDRA-2857
8fd5ed8014837ddccbb1d5dd794257038e052eec,"fix race condition in sstable reference counting
patch by jbellis; reviewed by slebresne for CASSANDRA-3085

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1162988 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3085
7457120730a374e73d506a2bc7400024abe4232e,"Expose gossip/FD info to JMX
patch by Patricio Echague; reviewed by brandonwilliams for CASSANDRA-2806

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1163201 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-2806
ffdfe1b102c164cb46885befb845057aa07102a4,"Fix streaming over SSL when compressed SSTable involved
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-3051

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1163207 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-3051
64f933791b022fe356e2d55fd668683068dacc84,"r/m compaction_thread_priority setting
patch by jbellis; reviewed by slebresne for CASSANDRA-3104

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1163657 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java', 'MessagingService.java']",CASSANDRA-3104
dec9eec41f7a1c060db8a6bc946aa012c81b73f0,"Make repair report failure when a participating node dies
patch by slebresne; reviewed by jbellis for CASSANDRA-2433


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1163677 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2433
9361543f8021c5e8c2156fdb8b6b9a39ce852667,"fix race that allowed multiple simultaneous leveled compaction tasks
patch by jbellis; reviewed by Ben Coverston for CASSANDRA-3087

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1163688 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-3087
7ee366f5fb5a61ce86e89aa56a144e19295a296b,"add CompactionInfo.id field
patch by Stu Hood; reviewed by jbellis for CASSANDRA-3107

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1163691 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-3107
3893f24098c3d82dc31571f0b6841e2d5821ea74,"generate hints for replicas that timeout
patch by Patricio Echague and jbellis for CASSANDRA-2034

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1163760 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-2034
8a538e89b74aeeda389fcc2afa089461a7141e43,"Restore getRangeToEndpointMap.
Patch by Nick Bailey, reviewed by brandonwilliams for CASSANDRA-3106

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1163772 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3106
dd7c8552c330e4d8a8d147ae7f31e39f3a6de62e,"Fix typo introduced by CASSANDRA-2941


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1164068 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-2941
273dc7e6dbfa9d8db717b9d90e6b8f117e982e7e,"Add throttling for internode streaming
patch by Stu Hood; reviewed by Pavel Yaskevich for CASSANDRA-3080

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1164075 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java']",CASSANDRA-3080
b87e2a7582de7fd5f87c6aa64150fd3e7f7e230a,"add missing mbean method

Patch by eevans; reviewed by jbellis for CASSANDRA-3117


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1164127 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-311
e4e19931e228d24988b37c2dd21429126551ddf0,"Make repair of a range sync all replica pairs for this range
patch by slebresne; reviewed by jbellis for CASSANDRA-2610


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1164463 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageService.java']",CASSANDRA-2610
333a24d90d24b05443f9b6ac9d00674616fd6a1a,"expose ability to only repair the primary range of a node
patch by slebresne; reviewed by jbellis for CASSANDRA-2606


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1164602 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-2606
f6937766a283389a28ddddb5e6320cac9b605a8b,"Don't try to build secondary indexes when there is none
patch by slebresne; reviewed by jbellis for CASSANDRA-3123


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1164634 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3123
62cc775015c5da79b6bc94ef40ad78d7b504571c,"convenience workflow for replacing dead node
patch by Vijay; reviewed by Nick Bailey for CASSANDRA-957

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1165468 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-957
fbf32cae91705cad2a000ce6e9745f14804175c2,"parallel compaction
patch by jbellis; reviewed by slebresne for CASSANDRA-2901

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1166255 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java']",CASSANDRA-2901
476cecf9a717bb39eee80db1bb12856791f7a550,"fix IntervalTree max calculation
patch by Paul Cannon; reviewed by Ben Coverston for CASSANDRA-3145

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1166302 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3145
b788d192ffd106bb4f5adec0408dc99de13eb090,"remove explicit per-CF memtable thresholds
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2449

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1166520 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-2449
f1cfc316e9a6ca4ec1f0fb64198c4f6ad89ac1b9,"After a ""short read"", the wrong read command may be used
patch by slebresne; reviewed by jbellis for CASSANDRA-3157


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1166716 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3157
31358f11583ed799f71b5f47e147f518431f62a2,"Improve caching of same-version Messages on digest and repair paths
patch by jbellis; reviewed by slebresne for CASSANDRA-3158

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1166774 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3158
ceabffaa22ece914c989a40a2e4e852cf26d91fe,"remove isMajor compaction designation
patch by jbellis; reviewed by Tupshin Harper and Ben Coverston for CASSANDRA-3154

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1166822 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-3154
345a263db47796a3d145f877af14ee42666d3137,"Remove wrongly added import (by CASSANDRA-3154)

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1167078 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3154
be1c748396697f9d0bc4bc1b985bce822a4a9a02,"Make sure we preserve backing map during CF.cloneMeShallow
patch by slebresne; reviewed by jbellis for CASSANDRA-3165


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1167185 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3165
f5f0b8ada4c1f7148e0b96c1db04fc65719e0774,"cleanup read path (StorageProxy side)
patch by jbellis; reviewed by slebrense for CASSANDRA-3161


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1167254 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3161
2acbcb768adb276e673bcaf97423ebfff7d1ca87,"clean up (StorageProxy side of) read path, take 2
patch by jbellis; reviewed by slebresne for CASSANDRA-3161

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1167300 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3161
4befd97237e0e8426555af441316705860b073c7,"re-clone slab-allocated keys in indexsummary
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3163

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1167317 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-3163
a4b1e10ef5e2b49d6c97840cc7d2d732ed5d9ffa,"remove gratuitious and sometimes dangerous overriding of default buffer sizes
patch by brandonwilliams and jbellis for CASSANDRA-3171

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1167365 13f79535-47bb-0310-9956-ffa450edef68","['CompactionManager.java', 'SSTableReader.java']",CASSANDRA-3171
c7cdc317c9a14e29699f9842424388aee77d0e1a,"Add RowLevel support to secondary index API
patch by Jason Rutherglen; reviewed by Pavel Yaskevich for CASSANDRA-3147

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1169861 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-3147
83418fa80613c37461c47ee61e02b6c489bbb6c8,"Randomize choice of first replica for counter increments
patch by slebresne; reviewed by jbellis for CASSANDRA-2890


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1170219 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-2890
6a958a90a8e95028fca55bd8f2e2ddcee7e1ce6a,"Return both listen_address and rpc_address through describe_ring.
Patch by Nick Bailey, reviewed by brandonwilliams for CASSANDRA-3187

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1170284 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3187
effb653450a11abd5e0fdc221f9b2c7a046e829a,"Return both listen_address and rpc_address through describe_ring.
Patch by Nick Bailey, reviewed by brandonwilliams for CASSANDRA-3187

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1170285 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3187
1f7ff16210dbdb96ac387341bdf3350e52c3208b,"Avoid streaming data to nodes that already have it, on move as well as decommission
patch by Nick Bailey and jbellis for CASSANDRA-3041

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1170306 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3041
d23655b4c416970c494b6ab5e3946da97ac116ef,"keep shutdown from waiting for the compaction kickoff
patch by jbellis; reviewed by slebresne for CASSANDRA-3181

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1170608 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-3181
f68d748efc29b0c0eba7f3d6e85fbc9efe77809b,"Make ColumnFamily.cloneMeShallow doesn't respect the insertionOrdered flag
patch by slebresne; reviewed by jbellis for CASSANDRA-3205


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1170641 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3205
10cd1da033ad721a883df3241758b79756887161,"remove unnecessary copy whenadding to row cache
patch by Yang; reviewed by jbellis for CASSANDRA-3223

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1172198 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3223
3a6ae395ea6263ad69f8f218f43beab5a2b7579e,"Log message at INFO when a global or keyspace level repair operation completes
patch by slebresne; reviewed by jbellis for CASSANDRA-3207


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1172591 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3207
5018e3099dfeb2067eb05354bcd8021423ee4467,"Remove dynamic_snitch boolean from example configuration
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3229

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1172698 13f79535-47bb-0310-9956-ffa450edef68",['Config.java'],CASSANDRA-3229
59217ad0962b14f68f6f9c69e0bd4490a1d4756e,"Base choice of random or ""balanced"" token onbootstrap on whether schema definitions were found
patch by slebresne; reviewed by jbellis for CASSANDRA-3219

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1172701 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3219
aab97ff162882476f968c059846e3120f6fe2a94,"LeveledCompactionStrategy fixes
patch by jbellis; tested by brandonwilliams for CASSANDRA-3224

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1173131 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3224
c0f6905eedc1ff934ec62e07fa26b5cb221c390f,"parallelize sstable open at server startup
patch by Melvin Wang and jbellis; reviewed by pyaskevich for CASSANDRA-2988

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1173606 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-2988
1b0df3897595cf62426e4811670d092b823d3455,"parallelize sstable open at server startup
patch by Melvin Wang and jbellis; reviewed by pyaskevich for CASSANDRA-2988

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1173615 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-2988
84acd4adb257a0601f6bd385ad8bea8f37380a7c,"use Array backed columns in compaction
patch by jbellis; reviewed by slebresne and tested by brandonwilliams for CASSANDRA-3234

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1174367 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3234
3ad3e73f59276f166720939902435ca17cbf9ad1,"avoid echoedRow when checking shouldPurge is more expensive than just de/serializing
patch by jbellis; reviewed by slebresne for CASSANDRA-3234

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1174770 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3234
5056f05a3235cddf96fb8daf197f932ee19bac12,"Fix Scrub compaction finishing
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for (CASSANDRA-3255)

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1176926 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-3255
5e4d3055e9fafd052638099d77b102d81ad67317,"Fix bootstrap process
patch by slebresne; reviewed by jbellis for CASSANDRA-3285


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1177706 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3285
dc23a33efda97e95233c071dc5317cd6d0d27487,"Evict gossip state immediately when a token is taken over.
Patch by vijay, reviewed by brandonwilliams for CASSANDRA-3259

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1177847 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3259
ce09666e53ba17a821828bf16e67898f0b522979,"use correct ISortedColumns for time-optimized reads
patch by jbellis; reviewed by slebresne for CASSANDRA-3289

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1178007 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3289
064ac93da28e61ca87f6cbc81cece3c6243dc489,"add system.versions ColumnFamily
patch by jbellis; reviewed by Paul Cannon for CASSANDRA-3140

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1178599 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-3140
59dfe48638d864e5be5512ec8db9e516de205be9,"fix truncate allowing data to be replayed post-restart
patch by jbellis; reviewed by slebresne for CASSANDRA-3297

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1179359 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3297
5310620826fadd5f68975feb77e01d87b386b19a,"close scrubbed sstable fd before deleting it
patch by jbellis; reviewed by slebresne for CASSANDRA-3318

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1179662 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-3318
305a06ec0e08b6826d43a36858402f86499b8b3f,"avoid including compaction cache-warming in keycache stats
patch by Fabien Rousseau; reviewed by jbellis for CASSANDRA-3325

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1179676 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-3325
78446d67ac40ac3ba39c181a6c41587482c18c42,"run compaction and hinted handoff threads at MIN_PRIORITY
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3308

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1179757 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-3308
e3812748ecb0b02436ebf82b7169c2c1c75b6627,"default hsha thrift server to cpu core count in rpc pool
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3329

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1179931 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-3329
d790ed1bc871a9bd3a8c8640629532c0bed77656,"Fix places where uncompressed sstable size is used in place of the compressed one.
patch by slebresne; reviewed by jbellis for CASSANDRA-3338


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0.0@1180970 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-3338
ab95f980f4ea13a60a03b0bdf90479c7c36c54e8,"Expire dead gossip states based on time.
Patch by Jérémy Sevellec, reviewed by Paul Cannon and brandonwilliams
for CASSANDRA-2961

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1182457 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-2961
84eeb28e3c60fee44597f4e4c663472ef147c811,"ICompactSerializer* -> I[Versioned]Serializer
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3333

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1182652 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-3333
787f9d65a3f5d3b0dfcf6751e6a076c60aa21526,"reduce network copies
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3333

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1182653 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3333
122da04f989673b3c912929b2d88ff8cbc811509,"Only count compaction as active (for throttling) once the compaction lock has been acquired.
patch by Fabien Rousseau and slebresne; reviewed by jbellis for CASSANDRA-3344


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1183241 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-3344
5faba469bb2adfd109c7f989e0e28b461df7cf9d,"add debug log of mutations + consistencylevel in SP.mutate
patch by Jackson Chung; reviewed by jbellis for CASSANDRA-3361

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1183509 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3361
642ff8f07921e40f4b24c3ef811c98754862bb21,"Don't stutter exception message when failing to unregister CFS mbean.
Patch by Dave Brosius, reviewed by brandonwilliams for CASSANDRA-3365

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1185294 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3365
5d1768a1cf03af2ae226c2b223105de60ee83e23,"Snapshot to include manifest under LeveledCompactionStrategy
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-3359

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1185362 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3359
25faad4e09eaf41dbc2b832e98b5465590198b90,"(CQL) SELECT query should allow CF name to be qualified by keyspace
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-3130

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1185905 13f79535-47bb-0310-9956-ffa450edef68",['SelectStatement.java'],CASSANDRA-3130
055cabc36c56faeb27158db9f0bd51275787cb7a,"add KSM.systemKeyspace and cloneWith methods
patch by jbellis; reviewed by pyaskevich for CASSANDRA-3292

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1185961 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-3292
358769548a9fa451bce605aa518876da53a3dd10,"finish fixing changing durable_writes keyspace option during CF creation
patch by jbellis; reviewed by pyaskevich for CASSANDRA-3292

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1185963 13f79535-47bb-0310-9956-ffa450edef68",['DatabaseDescriptor.java'],CASSANDRA-3292
7804c69f2901d6a843a251dda09478ba6dde3ccc,"correct dropped messages logging
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3377

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1186204 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-3377
368aa0e965cfc1dac1da5736ba6329cf55f2a867,"acquire references during index build
patch by jbellis; reviewed by slebresne for CASSANDRA-3314

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1186208 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3314
118513ad9db5de929d450b40d73971a3dd30ff63,"fix assertion error during repair with ordered partitioners
patch by slebresne; reviewed by jbellis for CASSANDRA-3369


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1187333 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-3369
3bf9c79d8d073e49e1f4a89be9b4b3155b0c142e,"CompactionManager is now responsible for checking for new candidates post-task execution
patch by jbellis; reviewed by slebresne for CASSANDRA-3363

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1187456 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-3363
1518af16073cf4cafbe20e564a2b7ab3a11eba40,"use CF/KS names as snapshot prefix for drop + truncate operations
patch by Yuki Morishita and jbellis for CASSANDRA-2997

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1187844 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-2997
5a439b23b19e4b73ac4e0511b619886cc57fc6f4,"remove incorrect optimization from slice read path
patch by jbellis; reviewed by slebresne for CASSANDRA-3390

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1188353 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3390
9d455d1018e466de3766bf60c018141754a7e702,"fix log message for schema disagreement
patch by Tommy Tynja and Jackson Chung for CASSANDRA-3381

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1188437 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3381
cb5d567086b6fd28a8e5f3dda1ce96f903f4e145,"push down assignments to scopes where they are needed
patch by dbrosius; reviewed by slebresne for CASSANDRA-3396


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1188757 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3396
fa70ed507492951c850f5f3d7fc178d4731b0a4d,"Allow encryption only between datacenters.
Patch by Vijay, reviewed by brandonwilliams for CASSANDRA-2802

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1189448 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java']",CASSANDRA-2802
5455e5446cf80ba726600d99a937cce09a41d520,"Make reloading the compaction strategy safe
patch by slebresne; reviewed by jbellis for CASSANDRA-3409


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1189831 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3409
b04b0a6e2293f64685ce5b69be0e0977cc552fb7,"Cleanup usage of StorageService.setMode()
patch by slebresne; reviewed by thobbs for CASSANDRA-3388


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1190461 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3388
609bc4e123f08b8f65dbb45da3243719b7ccfdde,"replace compactionlock use in schema migration by checking CFS.isInvalidD
patch by jbellis; reviewed by slebresne for CASSANDRA-3116

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1195542 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-3116
09188c9e28d158589025f332cfeabe4be991f4c7,"acquire compactionlock during truncate
patch by jbellis; reviewed by slebresne for CASSANDRA-3399

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1195695 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-3399
59e2f30a553dd9678f833a699e1ec461c00cb3a2,"Add JMX call to remove failed repair sessions
patch by yukim; reviewed by slebresne for CASSANDRA-3316


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1197123 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3316
981ee774eb1d6efd5971569ca29890817d0271ea,"Fix CASSANDRA-3427

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1197130 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-3427
58092a393dc064df1ac259c1000bb5d1c7d15445,"recognize that ""SELECT first ... *"" isn't really ""SELECT *""
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-3445

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1197270 13f79535-47bb-0310-9956-ffa450edef68",['SelectStatement.java'],CASSANDRA-3445
6faf3410447ae81f5b77ce0570d6dbcb99bc8abf,"Never return more columns than requested
patch by byronclark; reviewed by slebresne for CASSANDRA-3303 and 3395


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1197426 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3303
287601d7f4d894687721aa54be8e822f3346d45a,"patch by slebresne; reviewed by yukim for CASSANDRA-3178


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1198725 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-3178
9bf951eb464b3d4c75d6e19ddae20b5e34d9aa3d,"fix invalidate-related test failures
patch by jbellis; reviewed by slebresne for CASSANDRA-3437

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1198830 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3437
222d414bc1aabd9a68b90c9061d2547291ece2ad,"r/m unused renameSSTables code
patch by Marcus Eriksson; reviewed by jbellis for CASSANDRA-3464

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1198842 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3464
61109407ddacdf2031cde711d25f3a1cc8e78bbf,"Fix bug preventing the use of efficient cross-DC writes
patch by slebresne; reviewed by jbellis for CASSANDRA-3472


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1199284 13f79535-47bb-0310-9956-ffa450edef68","['StorageProxy.java', 'StorageService.java']",CASSANDRA-3472
84a03abdcea3c893a975f34ee75f436a4dcc99c7,"Report compression ratio in CFSMBean
patch by vijay; reviewed by xedin for CASSANDRA-3393

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1199427 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-3393
74459de4dd1b9e55e502f2b7296bc2fcaca365fa,"add sstable forward-compatibility
patch by jbellis; reviewed by ymorishita for CASSANDRA-3478

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1200100 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3478
0b54c99e22f53042d04df449d38ae91548df752d,"report compression ratio in CFSMBean
patch by Vijay; reviewed by Pavel Yaskevich for CASSANDRA-3393

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1200251 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-3393
d5723b08bd22e1ea2e8a3abe0485b6d4e96c205c,"Fix incomplete deletion of delivered hints
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3466

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1201037 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3466
192cc7dc838b9ec003d0a3594591db637a897d1d,"Avoid rescheduling compaction when no compaction was executed
patch by Dan Hendry; reviewed by slebresne for CASSANDRA-3484


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1201039 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-3484
3b944ed78a186d3fc16ae3d0d8330b133b14aa60,"record partitioner in sstable metadata component
patch by Yuki Morishita and jbellis for CASSANDRA-3393

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1202904 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-3393
bafa3059cc404045c570050081f7263f3fcc35a9,"add new upgradesstables nodetool command
patch by slebresne; reviewed by jbellis for CASSANDRA-3406


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1203117 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-3406
be1b02b95bd9c847cdfb01a0979d1cce7c581845,"update size-tiered compaction to prioritize small tiers
patch by jbellis; reviewed by slebresne for CASSANDRA-2407

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1203729 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-2407
181ca1bc548c54a29e74f6fa5c81d097ec8df557,"canonicalize paths exposed through JMX
patch by thobbs; reviewed by jbellis for CASSANDRA-3504

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1203873 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3504
55624ad6044d4e5448c71f567623efa9bbea2977,"expose bloom filter sizes via JMX
patch by Vijay; reviewed by jbellis for CASSANDRA-3495

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1205601 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-3495
48d1284a6438f1d6d7858a147149fff0f560f691,"fix self-hinting of timed out read repair updates and make hinted handoff less prone to OOMing a coordinator
patch by jbellis; reviewed by slebresne for CASSANDRA-3440

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1205969 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-3440
789aa15fc1990643a1162e0ac93f1487446328db,"Avoid race in OutboundTcpConnection in multi-DC setups
patch by jbellis; reviewed by slebresne for CASSANDRA-3530


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1206095 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3530
d655e7868f8521d726cf6a854c13a41a61341a1a,"avoid race in OutboundTcpConnection in multi-DC setups
patch by jbellis; reviewed by slebresne for CASSANDRA-3530


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1206098 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3530
c1a6e5da9e630b8d5377dc02ff75e32098d13c62,"Shutdown CL after having flushed non-durable CF
patch by slebresne; reviewed by jbellis for CASSANDRA-3520


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1207262 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3520
5fc19f48c6defc6c0fe8f33c2857735474e33252,"New command to stop running compactions
patch by vijay2win; reviewed by slebresne for CASSANDRA-1740


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1207810 13f79535-47bb-0310-9956-ffa450edef68","['CompactionManager.java', 'NodeProbe.java']",CASSANDRA-1740
37e16faaf6f3f8b804b8cae1a1caad793a0e4329,"Fix assertion error while forwarding writes to local nodes
patch by slebresne; reviewed by jbellis for CASSANDRA-3539


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1207969 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3539
cd8612121d81c1feea4d3da5bca95d1af27caf3b,"Bulk loader is no longer a fat client, hadoop bulk loader output format.
Patch by brandonwilliams, reviewed by Yuki Morishita for CASSANDRA-3045

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1208499 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-3045
554223b4a65c7839c36e8a17e36636b92f4f15a0,"remove assumption that key and token are in bijection
patch by slebresne; reviewed by jbellis for CASSANDRA-1034


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1208993 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-1034
5ae93209f29aab470dbe159eadc040bee073c5f5,"Prevent NPE when encryption options are missing.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-3489

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1209229 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'MessagingService.java']",CASSANDRA-3489
a795eb936deea623d7d521da6ed2fc371c0d925a,"fix race between cf flush and its 2ndary indexes flush
patch by slebresne; reviewed by jbellis for CASSANDRA-3547


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1209397 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3547
cef35c0c68f8eae76fbb99424fa0cc8712e4d7d8,"fix adding to leveled manifest after streaming
patch by jbellis; reviewed by Ben Coverston and tested by Joe Siegrist for CASSANDRA-3536

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1209543 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-3536
41ef1b550ac0c3fc94f05cf50afd26f7c64bf4ea,"use cannonical host for local node in nodetool info
patch by Rick Branson; reviewed by jbellis for CASSANDRA-3556

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1209608 13f79535-47bb-0310-9956-ffa450edef68",['NodeProbe.java'],CASSANDRA-3556
41a8903cfb77d3521e02e176bd7f8b3683026e35,"JMX-enabled incremental_backups setting.
Patch by brandonwilliams reviewed by jbellis for CASSANDRA-3561

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1209622 13f79535-47bb-0310-9956-ffa450edef68","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-3561
eaca5341522a079dcecc181d229728da418ff2d6,"Optimize componentsFor method for compaction and startup time
patch by jbellis and Eric Parusel; reviewed by slebresne for CASSANDRA-3532

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1209689 13f79535-47bb-0310-9956-ffa450edef68","['CompactionManager.java', 'SSTableReader.java']",CASSANDRA-3532
c2626cdf241ff1e380255eab58155ac45fa1d4ce,"include CL in getRangeSlice debug logging
patch by Pedro Rafael; reviewed by jbellis for CASSANDRA-3562

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1209726 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3562
fe1e7fce60fbe2652a44e535e9bbd9bf04a0ef39,"multithreaded streaming
patch by Peter Schuller; reviewed by yukim for CASSANDRA-3494

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1210748 13f79535-47bb-0310-9956-ffa450edef68",['MessagingService.java'],CASSANDRA-3494
8480f06e324e0bc2e042b7c1c483e08132d81eb4,"remove nonlocal DC write optimization
patch by Vijay; reviewed by jbellis for CASSANDRA-3577

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1210902 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3577
8623bfb19f52a83472c673b1ad5acf06b40795c9,"'describe ring' moved from CLI to nodetool and available through JMX
patch by Jackson Chung; reviewed by Pavel Yaskevich for CASSANDRA-3220

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1211581 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-3220
e21cda43ca924e8aba692f7992abb6e8181e4961,"add back partitioner in sstable metadata
patch by yukim; reviewed by slebresne for CASSANDRA-3540


git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1211848 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-3540
ec624f50957776a444c28d6fea028786fe97640c,"Improve memtable slice iteration performance
patch by slebresne; reviewed by jbellis for CASSANDRA-3545


git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1211999 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3545
d016a08ada8707f221fc1b27e19af8a461254c81,"multi-dc replication optimization supporting CL > ONE
patch by Vijay and jbellis for CASSANDRA-3577

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1212088 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-3577
508503d1672a9ec876cf9134cea0a1099c6d9070,"improve UserInterruptedException encapsulation (and renamed to CompactionInterruptedException)
patch by jbellis; reviewed by slebresne for CASSANDRA-3582

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1212092 13f79535-47bb-0310-9956-ffa450edef68",['CompactionManager.java'],CASSANDRA-3582
a7d0cdef578aabf18fca804343400e6fa03b5fd0,"range and index scans now only send requests to enough replicas to satisfy requested CL + RR
patch by Vijay and jbellis for CASSANDRA-3598

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1212552 13f79535-47bb-0310-9956-ffa450edef68",['StorageProxy.java'],CASSANDRA-3598
96d92fb5d9e16e1d7b5871e0c1117f00e2e166c6,"Prevent gossiper from adding itself to saved endpoints.
Patch by brandonwilliams reviewed by Paul Cannon for CASSANDRA-3485.

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-0.8@1212624 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3485
8cf9f2deda1fa2d1300813b6a0a4f3a23e00f011,"Allow overriding RING_DELAY.
Patch by brandonwilliams reviewed by slebresne for CASSANDRA-3600

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1213346 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3600
5fa71cce0be9dc8a86cee957c00fd890fd660237,"Bootstrapping nodes ensure schema is complete before continuing.
Patch by brandonwilliams reviewed by jbellis for CASSANDRA-3629

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1214399 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3629
9bec1e42a60e4e7e8c3d16cd45ac44447704ef65,"CQL support for prepared statements

Patch by Rick Shaw; reviewed by eevans for CASSANDRA-2475

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1214520 13f79535-47bb-0310-9956-ffa450edef68",['SelectStatement.java'],CASSANDRA-247
f59ca1d045c7d2c7c42053533409f7e5416c3c89,"review-related code-style fixes and cleanups

Patch by eevans; reviewed by Rick Shaw for CASSANDRA-2475

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1214523 13f79535-47bb-0310-9956-ffa450edef68",['SelectStatement.java'],CASSANDRA-247
e3c5d5d4335150e76b3e7e5ea7147f33ddc49910,"stop thrift service in shutdown hook so we can quiesce MessagingService
patch by jbellis; reviewed by Brandon Williams for CASSANDRA-3335

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1221467 13f79535-47bb-0310-9956-ffa450edef68","['MessagingService.java', 'StorageService.java']",CASSANDRA-3335
8cb9aa4e3e724e6b4b8229de05c2301bf3588067,"Flush non-cfs backed secondary indexes along with memtables
Patch by tjake; reviewed by xedin for: CASSANDRA-3659



git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1222317 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3659
a9c820b43238abbef0636660d67ea76871ce4aca,"add nodetool setstreamthroughput
patch by Peter Schuller; reviewed by yukim for CASSANDRA-3571

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1222419 13f79535-47bb-0310-9956-ffa450edef68","['StorageService.java', 'NodeProbe.java']",CASSANDRA-3571
1cde4ac54dfb9f015d7bf95059caf2c54c3c1e4a,"Allow setting compaction strategy via JMX.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-3452

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1222423 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3452
acfacbd8d4e79ddb1285a1cb65c8ec8b61b99d2b,"Add 'write survey' mode that bootstraps but does not join.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-3452

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1222425 13f79535-47bb-0310-9956-ffa450edef68",['StorageService.java'],CASSANDRA-3452
23e1aa4c047061da3ab32f222f2172979967fd45,"attempt hint delivery every ten minutes; hint handoff throttle delay default changed to 1ms, from 50
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3554

git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1222467 13f79535-47bb-0310-9956-ffa450edef68","['ColumnFamilyStore.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-3554
295aedb278e7a495213241b66bc46d763fd4ce66,"global key/row caches
patch by Pavel Yaskevich; reviewed by Sylvain Lebresne for CASSANDRA-3143

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1222715 13f79535-47bb-0310-9956-ffa450edef68","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-3143
3150815d271fe9e656ef19e2f4fa5438344b273e,"Secondary Indexes should report memory consumption
Patch by tjake; reviewed by jbellis for CASSANDRA-3155



git-svn-id: https://svn.apache.org/repos/asf/cassandra/branches/cassandra-1.0@1222806 13f79535-47bb-0310-9956-ffa450edef68",['ColumnFamilyStore.java'],CASSANDRA-3155
23785c37360e04cead8a2f036f7ee79a4d6eaaab,"Optimize key count estimation when opening sstable on startup
patch by Melvin Wang and jbellis; reviewed by slebresne for CASSANDRA-2988

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1224679 13f79535-47bb-0310-9956-ffa450edef68",['SSTableReader.java'],CASSANDRA-2988
2eacaf737832f60c8b92b0a48a7df3a523e274f3,"fix javadoc problems
patch by Dave Brosius; reviewed by jbellis for CASSANDRA-3664

git-svn-id: https://svn.apache.org/repos/asf/cassandra/trunk@1224680 13f79535-47bb-0310-9956-ffa450edef68","['CassandraDaemon.java', 'StorageService.java']",CASSANDRA-3664
952c6e536b90abe94874813030033975e33672a4,"clean up streamExecutors map
patch by jbellis; reviewed by pschuller for CASSANDRA-3679",['MessagingService.java'],CASSANDRA-3679
c0af7f604189f9e2a21fed397ad32c43a8aff89f,"avoid returning internal Cassandra classes over JMX
patch by Nick Bailey; reviewed by yukim for CASSANDRA-2805","['CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-2805
b9813ed388f9672ac4099d4a72c6362edc442ede,"a way to deactivate global key/row cache on per-CF basis
patch by Pavel Yaskevich; reviewed by Sylvain Lebresne for CASSANDRA-3667","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-3667
eca0c4856fbc42d833aead796c82fc2939cbfd5b,"Allow setting rpc_timeout via JMX.
Patch by Ruben Terrazas, reviewed by brandonwilliams for CASSANDRA-2940","['DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-2940
89e54091fd2b55363f3a4917d0883d688c9e8a9c,"Fix assertionError for CF with gc_grace = 0

patch by slebresne and jbellis for CASSANDRA-3579",['ColumnFamilyStore.java'],CASSANDRA-3579
185eca5d1fa7e384bb888c144d06abbced0fd577,"prevent slow clients from postponing shutdown indefinitely
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-3727","['MessagingService.java', 'StorageService.java']",CASSANDRA-3727
9ad560d2fbb7f4a9a2cbac5741fe9301919b6319,"Bootstrapping nodes never use the hibernation state.
Patch by brandonwilliams, reviewed by vijay for CASSANDRA-3737",['StorageService.java'],CASSANDRA-3737
9f04f3e16ecb2a52c91afe21309e496dbfde3070,"Bootstrapping nodes never use the hibernation state.
Patch by brandonwilliams, reviewed by vijay for CASSANDRA-3737",['StorageService.java'],CASSANDRA-3737
0456b7eb231275fba368d35fb861b09096fdd8fb,"Allow doing a range slice with a limit of columns instead of rows

patch by slebresne; reviewed by jbellis for CASSANDRA-3742","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-37
35f7bc597a8d26ca88526cf0d5208c13bdda523d,"Allow rangeSlice queries to be start/end inclusive/exclusive

patch by slebresne; reviewed by jbellis for CASSANDRA-3749","['ColumnFamilyStore.java', 'SSTableReader.java', 'StorageProxy.java']",CASSANDRA-37
9bfdb01f00bdd88165fac9d07e7f6b60700ca40b,"use entryset looping instead of key + get
patch by Dave Brosius; reviewed by jbellis for CASSANDRA-3688",['StorageService.java'],CASSANDRA-3688
2bc0d4db9d1b8fe074c7f79e90420072d5890ace,"clean up AbtractType generics treatment
patch by Dave Brosius; reviewed by jbellis for CASSANDRA-3689",['ColumnFamilyStore.java'],CASSANDRA-3689
492d44e1586eb6f73090ec29e7e997940cde314a,"allow using sstable2json on secondary index data

patch by yukim and jbellis for CASSANDRA-3738",['SSTableReader.java'],CASSANDRA-373
d51d6f0b43b006b40ec3c1d6d13e2155b58136c0,"propagate range filter to ColumnFamilyRecordReader
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2878",['ColumnFamilyStore.java'],CASSANDRA-2878
37b079352d412bb67036aa4130107728b9c8ae0d,"Allow concurrent schema migrations
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-1391","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-1391
86a7a3d1a0ba38e9c1f110814517f1b7630cfa51,"Reduce memory used by primary index sample
patch by Radim Kolar and yukim; reviewed by jbellis for CASSANDRA-3743",['SSTableReader.java'],CASSANDRA-3743
8142a2fe93d1ac517e2056b61d4c53c6a4da57ea,"Add snapshot command to trigger snapshot on remote node

patch by vijay; reviewed by slebresne for CASSANDRA-3721 (first part)",['StorageService.java'],CASSANDRA-3721
655ccc3abfc0f3fbe974d3f52cd38bf0d6afe2a9,"CQL 3.0 beta

patch by slebresne; reviewed by jbellis and urandom for CASSANDRA-3761","['SelectStatement.java', 'StorageService.java']",CASSANDRA-3761
e0aec20f451515d23c84d1ce61666b43dd928f11,"Clean up isMarkedForDelete to avoid relying on the current time where possible
patch by slebresne; reviewed by jbellis for CASSANDRA-3716",['ColumnFamilyStore.java'],CASSANDRA-3716
f5f3065843da6d5d1ba173f433873c10f9a27f80,"fix bad comparison of column name against * or 1
patch by dbrosius; reviewed by jbellis for CASSANDRA-3787",['SelectStatement.java'],CASSANDRA-3787
e10eb19e85834aeea4514a968613d41e1dc0d247,"Update CqlPreparedResult to provide type information

patch by slebresne; reviewed by jbellis for CASSANDRA-3753",['SelectStatement.java'],CASSANDRA-37
b10d5bd705fbbf07c567f61b2d6f68a4c8d22b0b,"synchronize BiMap of bootstrapping tokens
patch by Peter Schuller and jbellis for CASSANDRA-3417",['StorageService.java'],CASSANDRA-3417
4fb3963197761244e86eab7e92883fa0ca0bb687,"fix build
patch by Peter Schuller for CASSANDRA-3806",['StorageService.java'],CASSANDRA-3806
2deee7a4e70c3e17344f7bbd53e9a72a8ac99dba,"Add command to rebuild node without merkle tree calculations

patch by scode; reviewed by jbellis and slebresne for CASSANDRA-3483","['StorageService.java', 'NodeProbe.java']",CASSANDRA-348
3d55a2b033ee7c7333230af5ef7c83b44bd8c8f7,"respect not only row cache capacity but caching mode when trying to read data
patch by Yuki Morishita; reviewed by Pavel Yaskevich for CASSANDRA-3812",['ColumnFamilyStore.java'],CASSANDRA-3812
cba4087cf696e6520082313bc575d88858f5e260,"Allow OutboundTcpConnectionPool to bind any interface.
Patch by brandonwilliams, reviewed by Vijay for CASSANDRA-3839",['Config.java'],CASSANDRA-3839
a35f8787cfbfb2ad60ee7795c104ee05661227dd,"Add optional socket timeout for streaming

patch by vijay2win; reviewed by slebresne for CASSANDRA-3838","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-383
8eccb80a317082897dc04d033fce500ac43e70aa,"Don't read saved row cache when it's disabled

patch by xedin; reviewed by slebresne for CASSANDRA-3849","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-384
099f04e609487a4e01b2e21758593a820869f8d9,"Fix ""Unable to create hard link"" SSTableReaderTest error messages

patch by jbellis and scode; reviewed by slebresne for CASSANDRA-3735",['ColumnFamilyStore.java'],CASSANDRA-373
3459c38d7b0183752e2dcd1cb497d1e502096838,"Support query by names for compact CF (CQL3)

patch by slebresne; reviewed by urandom for CASSANDRA-3791",['SelectStatement.java'],CASSANDRA-379
54528835775460f427989138529624f8a6b6e34c,"fix truncate not to leave behind non-CFS backed secondary indexes
patch by Pavel Yaskevich; reviewed by Jake Luciani for CASSANDRA-3844","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-3844
252287897f18349df3340dbfb3c6040acdcf9ee5,"make SS.getTokenToEndpointMap to sort tokens in ascending order.
Patch by Yuki Morishita, reviewed by brandonwilliams for CASSANDRA-3863",['StorageService.java'],CASSANDRA-3863
a277fbedb9ac5d109527848a77f470f22ea1ff00,"Fix streaming too much data during move operations
patch by Fabien Rousseau; reviewed by Paul Cannon for CASSANDRA-3639",['StorageService.java'],CASSANDRA-3639
ad80cf4c20977f68cea047d9d03b5e927668db12,"SuperColumn may ignore relevant tombstones

patch by slebresne; reviewed by jbellis for CASSANDRA-3875",['ColumnFamilyStore.java'],CASSANDRA-387
63da8815aa93a84919c9bf359d5277324025b6fd,"Fix inconsistent state after forced removetoken.
Patch by Sam Overton, reviewed by brandonwilliams for CASSANDRA-3876",['StorageService.java'],CASSANDRA-3876
ba637b4d1f1b0c48c62498cc35ac6f5665cf4f27,"add getRangeKeySample and refactor key sampling to use more-efficient CFS.keySamples
patch by Sam Tunnicliffe and jbellis for CASSANDRA-2917","['ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-2917
22b8a9725b384c0fbee9356ef15e0728bbfd2a58,"change snapshot-before-compaction to only snapshot (w/o flush) CFS being compacted
patch by jbellis; reviewed by slebresne for CASSANDRA-3803",['ColumnFamilyStore.java'],CASSANDRA-3803
a85bbdf633d302ded4861ed95a69375d50566904,"Fix typo in cql3 SelectStatement

patch by Dave Brosius; reviewed by slebresne for CASSANDRA-3879",['SelectStatement.java'],CASSANDRA-387
c3dc7894159ad413f9c8fa0cc0024c6ed0984831,"avoid including non-queried nodes in rangeslice read repair
patch by jbellis; reviewed by Vijay for CASSANDRA-3843",['StorageProxy.java'],CASSANDRA-3843
e5be9520b7f9f7f18739f00d4f265a3a3e0adfe2,"avoid including non-queried nodes in rangeslice read repair
patch by jbellis; reviewed by Vijay for CASSANDRA-3843",['StorageProxy.java'],CASSANDRA-3843
12d26f869d966a842e6b01b13e338051c9c85f68,"add nodetool rebuild_index
patch by Vijay; reviewed by jbellis for CASSANDRA-3583","['ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-3583
b55ab4f3b23b9f3f056ffcc526d2b06989e024fb,"fix unsynchronized use of TokenMetadata.entrySet
patch by Peter Schuller; reviewed by jbellis for CASSANDRA-3417",['StorageService.java'],CASSANDRA-3417
79050449e7e953a301e275a755a2b5f3a5b0d06a,"fix unsynchronized use of TokenMetadata.entrySet
patch by Peter Schuller; reviewed by jbellis for CASSANDRA-3417",['StorageService.java'],CASSANDRA-3417
4ab6fad945cada90497a8cf523a4c868932834c2,"fix unsynchronized use of TokenMetadata.entrySet
patch by Peter Schuller; reviewed by jbellis for CASSANDRA-3417",['StorageService.java'],CASSANDRA-3417
9ca84786b5be14b0a881268e3649b697f7f893b9,"fix race between cleanup and flush on secondary index CFSes
patch by yukim and jbellis for CASSANDRA-3712",['CompactionManager.java'],CASSANDRA-3712
82a75d4ae7e7c21aa6e4106ed5457c4dfc2634cb,"Finish cleanup up tombstone purge code

patch by slebresne; reviewed by jbellis for CASSANDRA-3872",['ColumnFamilyStore.java'],CASSANDRA-387
d2c22a855c260a9c4e51ac41f42b7b3de46a0a7b,"BulkOutputFormat no longer unnecessarily looks for cassandra.yaml.
Patch by brandonwilliams, reviewed by Chris Goffinet for CASSANDRA-3740","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-3740
1ae32c93eca24a5bdab7332a56418a12b4e6586b,"Staggering repair
patch by Vijay and Sylvain Lebresne; reviewed by Sylvain Lebresne for CASSANDRA-3721","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-3721
212fd417f3e622449725d83e8dacab9506318dff,"Improve MessagingService assertion.
patch by scode; reviewed by jbellis for CASSANDRA-3887",['MessagingService.java'],CASSANDRA-3887
ddee43e8463777b0419fac2423a59511202c8fab,"Staggering repair
patch by Vijay and Sylvain Lebresne; reviewed by Sylvain Lebresne for CASSANDRA-3721","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-3721
064adba2e158c762a5d3bfec10f32cc0528a9f29,"Enable compression setting adjustment via JMX.
Patch by brandonwilliams, reviewed by xedin for CASSANDRA-3815.",['ColumnFamilyStore.java'],CASSANDRA-3815
0dea8dc56b170e8ad0d2b69a74a2f7b3e2284770,"Show Effective Owership
patch by Vijay; reviewed by Brandon Williams for CASSANDRA-3412","['StorageService.java', 'NodeProbe.java']",CASSANDRA-3412
14d57389bf4bead6e52d3d0b45ac536b9ff232ed,"Show Effective Owership
patch by Vijay; reviewed by Brandon Williams for CASSANDRA-3412","['StorageService.java', 'NodeProbe.java']",CASSANDRA-3412
058307b65ebf6d85027c8960e26ed10a4f4bfd80,"Update ORDER BY syntax for CQL3

patch by slebresne; reviewed by jbellis for CASSANDRA-3925",['SelectStatement.java'],CASSANDRA-392
527d590d435073ebefab7369f77e7d3a04d5b651,"Update gossip with schema version when merging from remote.
Patch by brandonwilliams, reviewed by xedin for CASSANDRA-3931",['StorageService.java'],CASSANDRA-3931
f943a6edf20a62f08c17cdb1c392478fc9846987,"Remove wait on hint future from writes

patch by slebresne; reviewed by amorton for CASSANDRA-3870",['StorageProxy.java'],CASSANDRA-387
e376bc02eca6f75489d2aff41e0cc36105eb8567,"add a convenient way to reset a node's schema
patch by Yuki Morishita and Pavel Yaskevich; reviewed by Pavel Yaskevich for CASSANDRA-2963","['StorageService.java', 'NodeProbe.java']",CASSANDRA-2963
5888fcd6aff4e8c00ad7f4c629c5feb1cf9663a0,"Avoids some exception when doing migration in a mixed 1.0-1.1 cluster

patch by xedin; reviewed by slebresne for CASSANDRA-3804",['StorageService.java'],CASSANDRA-380
38ee718ee6edc0116a3727d9186b64272daa1018,"pre-size ArrayLists
patch by Dave Brosius; reviewed by jbellis for CASSANDRA-3949","['SelectStatement.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-3949
eac19fee0384fdab25ae6d4eaa065199ce04fb4d,"Add a wrapper to the Runnables executed by DSTPE to prevent exceptions from killing the tasks. Replace ExpiringMap's timer with a DSTPE.
patch by jbellis; reviewed by slebresne for CASSANDRA-3537",['MessagingService.java'],CASSANDRA-3537
185e0250ab7e21462149f337497ea24d5da01719,"Minor javadoc tweaks

patch by dbrosius; reviewed by slebresne for CASSANDRA-3956",['CassandraDaemon.java'],CASSANDRA-395
cbd46f11c1ba0597d6d66842619b7c133e24570c,"Minor javadoc tweaks

patch by dbrosius; reviewed by slebresne for CASSANDRA-3956",['CassandraDaemon.java'],CASSANDRA-395
24939a58b381589461677e03c2b19a2035d9c727,"Make SS.hasSameReplication safer/more readable

patch by dbrosius; reviewed by slebresne for CASSANDRA-3971",['StorageService.java'],CASSANDRA-3971
f7629d8498d4d857128ee1697428d9d5fd9c9273,"update hasSameReplication to use the List passed to it
patch by dbrosius; reviewed by jbellis for CASSANDRA-3971",['StorageService.java'],CASSANDRA-3971
0d40edb40f695dbda1e5da6787424ac067a8f081,"update hasSameReplication to use the List passed to it
patch by dbrosius; reviewed by jbellis for CASSANDRA-3971",['StorageService.java'],CASSANDRA-3971
c9270f4e3ae5f94d46070f1c7e585c90bc68df7c,"Fix race between writes and read for cache

patch by jbellis and slebresne; reviewed by jbellis and slebresne for CASSANDRA-3862",['ColumnFamilyStore.java'],CASSANDRA-3862
3f8db24e4ae5d17442e15ad485d03021628e91c1,"perform static initialization of StorageProxy on start-up
patch by jbellis and scode for CASSANDRA-3797",['StorageService.java'],CASSANDRA-3797
9483e147ec675c6024b5f1a55c799cc15aa2239e,"identify and blacklist corrupted SSTables from future compactions
patch by Benjamin Coverston and Pavel Yaskevich; reviewed by Brandon Williams for CASSANDRA-2261",['SSTableReader.java'],CASSANDRA-2261
ba7b0bddfd381be2262111cb6c3351ee31b94c78,"support trickling fsync() on writes

patch by scode; reviewed by xedin for CASSANDRA-3950","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-395
7e4ef1cc29d472db773375802cb1e70e95fe9556,"remove generification from DecoratedKey
patch by dbrosius; reviewed by jbellis for CASSANDRA-3978","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-3978
9c5ac8ff69db65dd5197062bbf60c10dc2371390,"expose counters for unavailable/timeout exceptions given to thrift clients

patch by scode; reviewed by driftx, eevans for CASSANDRA-3671","['StorageProxy.java', 'StorageService.java']",CASSANDRA-3671
154daa03a660a62b228000354319390305568b21,"expose counters for unavailable/timeout exceptions given to thrift clients

patch by scode; reviewed by driftx, eevans for CASSANDRA-3671","['StorageProxy.java', 'StorageService.java']",CASSANDRA-3671
048c8a98d83b41d463b557ede8a0bf98d3def022,"Don't promote sstables for cleanup, scrub and updateSSTables

patch by slebresne; reviewed by jbellis for CASSANDRA-3989","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-3989
f2399074465357fefd60521da644d65adc54651d,"Fix race leading to super column assertion failure

patch by slebresne; reviewed by jbellis for CASSANDRA-3957",['ColumnFamilyStore.java'],CASSANDRA-395
6b2ea264702f80518a1147ab0aac44e0cf40dfc3,"Track tombstone expiration
patch by yukim; reviewed by jbellis for CASSANDRA-3442",['SSTableReader.java'],CASSANDRA-3442
65059cf48e0794e0459b1882961616f55382c756,"Don't promote sstables for cleanup, scrub and updateSSTables

patch by slebresne; reviewed by jbellis for CASSANDRA-3989","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-3989
008cc7ebdf39b844f130403400b111ef6d7d58a4,"Fix race leading to super column assertion failure

patch by slebresne; reviewed by jbellis for CASSANDRA-3957",['ColumnFamilyStore.java'],CASSANDRA-395
ccb0028931c9de665d521b4798a9f63f7dee7497,"Add type information to new schema_ columnfamilies and remove thrift validation

patch by jbellis and slebresne; reviewed by jbellis and slebresne for CASSANDRA-3792",['SelectStatement.java'],CASSANDRA-379
6423bfe791fb7fc9f1b84cd18e614c7725797aaa,"skip reading saved key cache if CF's caching strategy is NONE or ROWS_ONLY
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-3954",['ColumnFamilyStore.java'],CASSANDRA-3954
837ee0ec5659afae2d3f138ee55d3bc7a60bdebf,"rename new sstables with correct generation at load time
patch by jbellis; reviewed by slebresne for CASSANDRA-3967",['ColumnFamilyStore.java'],CASSANDRA-3967
d765b246e72e7bb455e9ec9440ae735b1ee8543f,"update MurmurHash to version 3
patch by Vijay; reviewed by Pavel Yaskevich for CASSANDRA-2975",['SSTableReader.java'],CASSANDRA-2975
438acfc8c4b58e05791ebc232e4517c71a4631e7,"Unify migration code

patch by slebresne; reviewed by xedin for CASSANDRA-4017","['DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-401
c573c46e34b952e3147e36e8a7b097f701f2b0e4,"Expose secondary indexes to cfhistograms.
Patch by brandonwilliams, reviewed by Nick Bailey for CASSANDRA-4063",['NodeProbe.java'],CASSANDRA-4063
fbdf7b03c7a8138ae9621bf9bacaada906a2530d,"ensure that directory is selected for compaction
patch by Aaron Morton; reviewed by Pavel Yaskevich for CASSANDRA-3985",['DatabaseDescriptor.java'],CASSANDRA-3985
1e18538c9868e92622e9e0acf87b2e88b9bd6182,"only deserialize keys we need in the sample
patch by yukim; reviewed by jbellis for CASSANDRA-4023",['SSTableReader.java'],CASSANDRA-4023
f11e4f2a1c3387083637efc85bcfa7a9d0c3248a,"Report lifetime bytes compacted and number of compactions.
Patch by brandonwilliams, reviewed by Nick Bailey for CASSANDRA-4067",['CompactionManager.java'],CASSANDRA-4067
c38d32638eea94114c578c3c9f400fd581aade39,"Expose schema version in nodetool.
Patch by Sam Tunnicliffe, reviewed by brandonwilliams for CASSANDRA-3937","['StorageService.java', 'NodeProbe.java']",CASSANDRA-3937
b4af12b43ba9aef71613274a12d037b0caaffd4b,"fix getOverlappingSSTables for streaming's skeleton compaction controller
patch by yukim; reviewed by jbellis for CASSANDRA-4080",['ColumnFamilyStore.java'],CASSANDRA-4080
417b175fa4bfc80994b3d4e85c9f8d93f3d9ab60,"fix NPE in index summarization
patch by yukim; reviewed by dbrosius for CASSANDRA-4023",['SSTableReader.java'],CASSANDRA-4023
46689e51b4c5479e7875bf918a820c5e74c3b418,"Shut down thrift on decommission.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-4086",['StorageService.java'],CASSANDRA-4086
731af1a4323314dc31020deec9fd04b97a79519c,"Adds posibility to autoconfigure size of the KeyCache
patch by Pavel Yaskevich; reviewed by Yuki Morishita for CASSANDRA-4087","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-4087
3ee8682eb8e32f04979f44984911cf3547ead206,"Add max_streaming_retries instead of relying solely on the FD.
Patch by brandonwilliams and yukim, reviewed by brandonwilliams for
CASSANDRA-4051","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-4051
25828cacef62576faf247a2ef4f7ae261bb1250f,make autoconfiguration happen only if key_cache_size_in_mb value was left blank in conf/cassandra.yaml (CASSANDRA-4087),"['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-4087
5bd78edcce19720d2664780323b35898abeacc1b,"Add max_streaming_retries instead of relying solely on the FD.
Patch by brandonwilliams and yukim, reviewed by brandonwilliams for
CASSANDRA-4051","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-4051
a59a5f59ce3042324b68a37b2392775cb191712e,"Adds posibility to autoconfigure size of the KeyCache
patch by Pavel Yaskevich; reviewed by Yuki Morishita for CASSANDRA-4087","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-4087
e12840e2182dfd12cb70df9a5aca4111a3a13217,make autoconfiguration happen only if key_cache_size_in_mb value was left blank in conf/cassandra.yaml (CASSANDRA-4087),"['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-4087
190e27bb5cc910d020b3828c1fbe83f009534b89,"Broadcast shutdown message when cleanly stopping gossip.
Patch by brandonwilliams, reviewed by vijay for CASSANDRA-3936",['StorageService.java'],CASSANDRA-3936
08345fabbc7536051d57ec4cde615704e5426788,"Expose SP histograms via nodetool.
Patch by brandonwilliams, reviewed by vijay for CASSANDRA-3722","['StorageProxy.java', 'NodeProbe.java']",CASSANDRA-3722
98a70bdebb26955ea629fe3a21212253fc7b7d17,"Dsnitch uses 'severity', latency, and time since last reply for scores.
Patch by vijay and brandonwilliams, reviewed by vijay for CASSANDRA-3722","['CompactionManager.java', 'MessagingService.java', 'StorageService.java']",CASSANDRA-3722
68dc7d0e393b587fd93d4efa0dbb55e74fe71981,"add asserts for intervaltree creation
patch by Paul Cannon; reviewed by jbellis for CASSANDRA-4078",['SSTableReader.java'],CASSANDRA-4078
1a42cf3f8e3ef33b22c3f7cf32c981eb2eb3de93,Backport CASSANDRA-3600 to 0.8,['StorageService.java'],CASSANDRA-3600
016244785802c29cace8d89b6c3f022af668ee1b,"allow short snitch names & update snitch comments
patch by jbellis; reviewed by vijay for CASSANDRA-4130",['DatabaseDescriptor.java'],CASSANDRA-4130
5923d32959ff419821dbb7fb36114a0604324498,"add commitlog archiving and pitr
patch by Vijay and jbellis for CASSANDRA-3690","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-3690
092dc586f556b1c2bef048d9ee8672240a31f442,"Make scrub and cleanup operations throttled
patch by Vijay; reviewed by yukim for CASSANDRA-4100",['CompactionManager.java'],CASSANDRA-4100
f774b7fc396f4fec611247159023c58863de5f85,"Make scrub and cleanup operations throttled
patch by Vijay; reviewed by yukim for CASSANDRA-4100

resolved Conflicts in:
	src/java/org/apache/cassandra/db/compaction/CompactionController.java",['CompactionManager.java'],CASSANDRA-4100
142e8c1a2967947a3ed5314e4577f4be3cfe4bd3,"add auto_snapshot option allowing disabling snapshot before drop/truncate
patch by dbrosius; reviewed by jbellis for CASSANDRA-3710","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-3710
d49113fad1bf7a15ca052156b872b9bdc01b6d73,"CQL3: Support slice with exclusive start and stop

patch by slebresne; reviewed by jbellis for CASSANDRA-3785",['SelectStatement.java'],CASSANDRA-378
34c1fc0b7cbdf568ec7869a564fe614f96dcbe9b,"Add failure callbacks for outgoing streams.
Patch by Yuki Morishita, reviewed by brandonwilliams for CASSANDRA-4051",['StorageService.java'],CASSANDRA-4051
20bd8281fab66852659201a76a9c525cdf64b710,"make cache skipping optional
patch by harishd; reviewed by Vijay for CASSANDRA-2635","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-2635
f3d3b43940b53bb6a90411ffec96abdf20929618,"make cache skipping optional
patch by harishd; reviewed by Vijay for CASSANDRA-2635","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-2635
e48b94098efca6d1abea86c07210492315359737,"optimize truncate when autosnapshot is disabled
patch by Christian Spriegel; reviewed by jbellis for CASSANDRA-4153",['ColumnFamilyStore.java'],CASSANDRA-4153
57b9a346cb023da3d3a2cea09d9fed9298be7cc9,"remove sstables efficiently during cleanup that contain no keys that belong on this node
patch by jbellis; reviewed by slebresne and Ben Coverston for CASSANDRA-4079",['CompactionManager.java'],CASSANDRA-4079
4797b40339e101d829e8ad15c923d36ce0e0ce8f,"add -cf option to nodetool snapshot
patch by dbrosius; reviewed by jbellis for CASSANDRA-556","['StorageService.java', 'NodeProbe.java']",CASSANDRA-556
726f6827dfd2059a793ec433653b2fe2ddc74266,"add time remaining estimate to nodetool compactionstats
patch by Fabien Rousseau; reviewed by jbellis for CASSANDRA-4167",['NodeProbe.java'],CASSANDRA-4167
04874186892c86a20181a2f64c5dc24285021b2c,"Save IndexSummary into new SSTable 'Summary' component
patch by Vijay and Pavel Yaskevich; reviewed by Pavel Yaskevich for CASSANDRA-2392",['SSTableReader.java'],CASSANDRA-2392
150b3167f2f9952a4537e0d3c754d094a9a097b2,"avoid generating redundant compaction tasks during streaming
patch by yukim; reviewed by jbellis for CASSANDRA-4174",['ColumnFamilyStore.java'],CASSANDRA-4174
263f192b65db18e3cfb5126e86358f374a0be5fa,Cleanup DTPE usage after CASSANDRA-3494,"['SSTableReader.java', 'MessagingService.java']",CASSANDRA-3494
1686a36ed54686584bc4d11a9ca8eb2c733f870a,"Fix cql3 order by for reversed queries

patch by slebresene; reviewed by jbellis for CASSANDRA-4160",['SelectStatement.java'],CASSANDRA-4160
46e422a9417b5b513ceae4c9652ba413e2ede474,"Open one sstableScanner per level for leveled compaction
patch by slebresne and jbellis for CASSANDRA-4142","['CompactionManager.java', 'SSTableReader.java']",CASSANDRA-4142
712ffeb4a518e1758c127da80beb3a6b1cb9928d,"(lazily )create and persist a host ID if none exists

Patch by eevans; reviewed by Brandon Williams for CASSANDRA-4120",['DatabaseDescriptor.java'],CASSANDRA-412
ad685c4615b08725488fdf26c1dd248cfe196cf8,"gossip host ID; Maintain a mapping of endpoint to ID

Patch by eevans; reviewed by Brandon Williams for CASSANDRA-4120","['MessagingService.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-412
0a5267e5c9c5b8282a4ccf056be1f203f83b687b,"store hints by host ID, instead of token

Patch by eevans; reviewed by Brandon Williams for CASSANDRA-4120",['StorageProxy.java'],CASSANDRA-412
dfd05673cd59dcd18ffea6c7f26dec4f880d5085,"removeNode (by ID) instead of token

Patch by eevans; reviewed by Brandon Williams for CASSANDRA-4120","['StorageService.java', 'NodeProbe.java']",CASSANDRA-412
5b024bd256fa4ca9a19dab0dc4dd77f6e47a5019,"Add support for ReversedType in CQL3

patch by slebresne; reviewed by jbellis for CASSANDRA-4004","['SelectStatement.java', 'SelectStatement.java']",CASSANDRA-400
5f1c5ad393a0ce5e455f865a7883303ca5e51690,"Minor fixes for CQL3

patch by slebresne; reviewed by jbellis for CASSANDRA-4185

- Fix float parsing
- Refuse more invalidate create statements
- Fix count in select
- Disallow counters in primary keys",['SelectStatement.java'],CASSANDRA-418
abb39c2bc4f985b848c07d181b45efd378b4795c,"fix compaction NPE when out of disk space and assertions disabled
patch by jbellis; reviewed by xedin for CASSANDRA-3985",['DatabaseDescriptor.java'],CASSANDRA-3985
8b81c8f2fb93a051fbd317c03af727ab919034f2,"Allow paging through non-ordered partitioner results in CQL3

patch by slebresne; reviewed by xedin for CASSANDRA-3771",['SelectStatement.java'],CASSANDRA-377
5a6f0b852935e7da957e5cfc397fd0a55b9516b6,"Introduce MessageOut class, which wraps an object to be sent in the ""payload"" field.  The old Header class is inlined into the ""parameters"" map.
patch by jbellis; reviewed by yukim for CASSANDRA-3617","['MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-3617
a06be23fbe7859063039767ce0dff64922445f39,"Rewrite IncomingTcpConnection to deserialize w/o extra copies to byte[]. MessageIn now has a payload field, and uses the Verb to look up the correct deserializer. REQUEST_RESPONSE deserializer is not uniquely determined by Verb, so we look those up by their callback instead.

patch by jbellis and yukim for CASSANDRA-3617","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-3617
4d7e703561bc68a79d856e28b3f710455b1c70bf,"avoid blocking additional writes during flush
patch by jbellis; reviewed by slebresnse and tested by brandonwilliams for CASSANDRA-1991",['ColumnFamilyStore.java'],CASSANDRA-1991
08848e7956f5fd08525a08498205637b2652f2a7,"avoid blocking additional writes during flush
patch by jbellis; reviewed by slebresnse and tested by brandonwilliams for CASSANDRA-1991",['ColumnFamilyStore.java'],CASSANDRA-1991
783e5d4c5fab46b1e5964f2743e053351bfe85d1,"fix SecondaryIndex LelevedManifest save upon snapshot
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-4230",['ColumnFamilyStore.java'],CASSANDRA-4230
5979bce8ec6338f3aaf88ce193da01e10249b12e,"calculate exact size required for cleanup operations
patch by yukim; reviewed by jbellis for CASSANDRA-1404","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-1404
7dae25d87e77208c471c59b1851981bf34acaafb,"log number of rows read from saved cache
patch by Sankalp Kohli; reviewed by jbellis for CASSANDRA-4249",['ColumnFamilyStore.java'],CASSANDRA-424
a0e0e2c13cbce65c1eaee47ed0d0286e82da5178,"Add parameters name to CqlPreparedResult

patch by Pierre Chalamet; reviewed by slebresne for CASSANDRA-4242",['SelectStatement.java'],CASSANDRA-424
fd92c09d95a53d582cb8c4b0e77ac47fdd884935,"Correctly validate order by queries

patch by slebresne; reviewed by jbellis for CASSANDRA-4246",['SelectStatement.java'],CASSANDRA-424
827de3f2099065c2b6ebff3907155d42861dc5b1,"log MOVING mode earlier
patch by jbellis; reviewed by Nick Bailey for CASSANDRA-4252",['StorageService.java'],CASSANDRA-4252
d90f0f3e7a2597a4327d39b3047bd34ab9af0c70,"ignore min/max compactions settings in LCS
patch by slebresne and jbellis for CASSANDRA-4233",['ColumnFamilyStore.java'],CASSANDRA-4233
4d34917d2f0ceddd86dbed285391b05df19d46e9,"Add support for range tombstones

patch by slebresne; reviewed by yukim for CASSANDRA-3708","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-3708
39dd8550194676766a260e4bc92edebf17cf8162,"fix split generation regression
patch by Bartomiej Romaski; reviewed by jbellis for CASSANDRA-4259",['SSTableReader.java'],CASSANDRA-4259
02672936f635c93e84ed6625bb994e1628da5a9b,"update clhm to 1.3
patch by Vijay; reviewed by jbellis for CASSANDRA-4150","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-4150
b5f99a3364a6b0a8531d8bb1c240a8f0603b4f56,"Don't convict dead states.
Patch by brandonwilliams, reviewed by Vijay for CASSANDRA-4115.",['StorageService.java'],CASSANDRA-4115
bd32d4f0b9f0f88fed97e8ddf2ee41b5b048d31d,"StorageProxy throws NPEs for when there's no hostids for a target
patch by dbrosius reviewed by jbellis for CASSANDRA-4227",['StorageProxy.java'],CASSANDRA-4227
cc112ae30a2ac7afa09930929db0b6adc8f64ca0,"actually bail when storing hints for pre-1.2 node (as advertised)

Patch by eevans; reviewed by jbellis for CASSANDRA-4227",['StorageProxy.java'],CASSANDRA-4227
cbf0436181fe1f47eff98f54aa161dd5fbca0479,"Fix range queries with secondary indexes

patch by slebresne; reviewed by xedin for CASSANDRA-4257",['SelectStatement.java'],CASSANDRA-425
00a553438623945117066d4adfc2826c17d59ccb,"kick off background compaction when min/max thresholds change
patch by jbellis; reviewed by slebresne for CASSANDRA-4279",['ColumnFamilyStore.java'],CASSANDRA-4279
1bfb68518a20abdfd7fd1c3e3422df9214df6b05,"kick off background compaction when min/max thresholds change
patch by jbellis; reviewed by slebresne for CASSANDRA-4279",['ColumnFamilyStore.java'],CASSANDRA-4279
9383aebfcb911ff64787be750815193715f14900,"kick off background compaction when min/max thresholds change
patch by jbellis; reviewed by slebresne for CASSANDRA-4279",['ColumnFamilyStore.java'],CASSANDRA-4279
1d9b7f5597f2cd090e312e270431ab56c81de9d9,"Try to stop all compaction upon Keyspace or ColumnFamily drop
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-4221",['CompactionManager.java'],CASSANDRA-4221
90170d1594c3a88f0a7b6a25da7161bb7af2e552,"Avoid ID conflicts from concurrent schema changes
patch by Pavel Yaskevich; reviewed by Sylvain Lebresne for CASSANDRA-3794","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-3794
f4f9802c41828ff1da0c5bc9097f95ef23bc899c,"Make thrift HSHA thread limit unlimited by default

patch by scode; reviewed by slebresne for CASSANDRA-4277",['DatabaseDescriptor.java'],CASSANDRA-427
cfe585c2c420c6e8445eb4c3309b09db8cf134ac,"AutoSaving KeyCache and System load time improvements
patch by Vijay; reviewed by xedin and jbellis for CASSANDRA-3762","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-3762
5cda764a9f956c35feba0a4cf3138037fcf39a76,"Add getsstables command to nodetool. Patch by Brandon Williams, reviewed by yukim for CASSANDRA-4199","['ColumnFamilyStore.java', 'SSTableReader.java', 'NodeProbe.java']",CASSANDRA-4199
267690a140ae7d6dfba169448654f9d15ba2b98e,"fix Summary component and caches to use correct partitioner
patch by Sam Tunnicliffe and Pavel Yaskevich; reviewed by Pavel Yaskevich for CASSANDRA-4289",['SSTableReader.java'],CASSANDRA-4289
90ce0257827a93cbdfab893c21bd0b5b31c02ec8,"enforce 1m min keycache for auto
patch by dbrosius reviewed by slebresne for CASSANDRA-4306",['DatabaseDescriptor.java'],CASSANDRA-4306
625e61396b9e91d86ca989761c43da726f2e71b2,"add inter-node compression
patch by Marcus Eriksson; reviewed by jbellis for CASSANDRA-3127","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-3127
383a608e7ff73befaaf34ad7cc0aab4cc26d1316,"only load key cache when caching is ALL/KEYS_ONLY, fix by yukim, reviewed by slebresne for CASSANDRA-4313",['ColumnFamilyStore.java'],CASSANDRA-4313
8fd3f49e8469f0123a58b37243b3a2e1147fa51f,"ex msg for cql3 order by constraints says primary filter can be an IN clause which is misleading
patch by dbrosius reviewed by slebresne for CASSANDRA-4319",['SelectStatement.java'],CASSANDRA-4319
6352edb3fe0a3a678e83ba11002e4cdde2cac468,"fix NPE in compactionstats
patch by jbellis; reviewed by xedin for CASSANDRA-4318",['CompactionManager.java'],CASSANDRA-4318
21aef92905678f98675fc34aeb4edb0e34a1d6af,"directly stream compressed sstable with java nio. patch by yukim,
reveiwed by jbellis for CASSANDRA-4297",['MessagingService.java'],CASSANDRA-4297
b993eecfb033d01345718d396a2c32c5120b5e0e,"multithreaded hint replay
patch by vijay; reviewed by jbellis for CASSANDRA-4189","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-4189
c82a9d9b96667cc2afeb2609fbff955b4232fc2b,"update MessagingService protocol to allow version handshake with broadcast address identification
patch by jbellis; reviewed by brandonwilliams and Marcus Eriksson for CASSANDRA-4311",['MessagingService.java'],CASSANDRA-4311
8ea2d2a6a15bc1f791711d55b4345c233020d753,"Add column metadata to system column families

patch by jbellis; reviewed by slebresne for CASSANDRA-4018","['DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-4018
d1171ddc10e75d34f7fb503accc718acc5720512,"Support multiple ranges in SliceQueryFilter

patch by dr-alves and slebresne; reviewed by vijay, dr-alves and slebresne for CASSANDRA-3885",['SelectStatement.java'],CASSANDRA-388
e6530cc3723a7d2fdc84400bf8cd722474eed589,"Gossip protocol version, use it to determine if new host id should be
used.
Patch by brandonwilliams, reviewed by Vijay for CASSANDRA-4317","['MessagingService.java', 'StorageService.java']",CASSANDRA-4317
e6610e4692800485501e316df3dab53a6e9e34b2,"split up rpc timeout by operation type
patch by Melvin Wang and jbellis; reviewed by vijay for CASSANDRA-2819","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java', 'StorageProxy.java']",CASSANDRA-2819
9cf915fd464b6f8a6aa9d54a762ad8796872681a,"parallelize fetching rows for low-cardinality indexes
patch by David Alves; reviewed by Vijay for CASSANDRA-1337",['StorageProxy.java'],CASSANDRA-1337
f17fbac1934721c4a90c86745f8481b2d8a8b223,Fix typo in CASSANDRA-1337,['StorageProxy.java'],CASSANDRA-1337
f422b98140dcec99d93858148415d43f01fa70d1,"fix timeout reporting to dsnitch
patch by vijay; reviewed by jbellis for CASSANDRA-2819",['MessagingService.java'],CASSANDRA-2819
eacdca02dd400c514278a2e0665f3878298f2c7f,"SS.bulkLoad specifies the partitioner.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-4368",['StorageService.java'],CASSANDRA-4368
0627c8aaec966d01500f2bb957aaefb9873fff38,"Use correct partitioner when saving + loading caches
patch by jbellis; reviewed by xedin for CASSANDRA-4331",['ColumnFamilyStore.java'],CASSANDRA-4331
54c647ffe07f51f6c237f33f7214898bdf8338bb,"CQL3: fix range query containing unqueryed results

patch by slebresne; reviewed by jbellis for CASSANDRA-4372",['SelectStatement.java'],CASSANDRA-437
8a3bb80e0dfff6bfc0fba195a38baf9be7d443ca,"Fix cleanup not deleting index entries
patch by jbellis; reviewed by slebresne for CASSANDRA-4379",['CompactionManager.java'],CASSANDRA-4379
75453d0179b841ef2e63475f81484661c2e502cb,"Improve scrub and allow to run it offline

patch by slebresne; reviewed by jbellis for CASSANDRA-4321","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-432
893d1da990b4f31462ad241dc0c4b6a91cf3dbee,"add Topology to TokenMetadata and clean up thread safety design
patch by Sam Overton; reviewed by jbellis for CASSANDRA-3881",['StorageService.java'],CASSANDRA-3881
be969899c954751f861b3861b3b709be56270ccd,"avoid using global partitioner to estimate ranges in index sstables
patch by jbellis; reviewed by yukim for CASSANDRA-4403",['ColumnFamilyStore.java'],CASSANDRA-4403
e7d323009526fd3ef7347537eddb168809cbc5a6,"Fix #4329

patch by slebresne; reviewed by xedin for CASSANDRA-4329",['StorageProxy.java'],CASSANDRA-4329
6d3a3eed27af0b6dd398da5bdd342d5bbd5340c0,"Custom CQL protocol

patch by slebresne; reviewed by yukim and norman for CASSANDRA-2478","['Config.java', 'DatabaseDescriptor.java', 'SelectStatement.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-247
aa2c28eadea7009361b46d95ee86a46fff291c0b,"update default commitlog segment and total size
patch by jbellis; reviewed by vijay for CASSANDRA-4422","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-4422
2e7d1f83f53d0aa2ffc52af6d8531c0355318484,"improve ""nodetool ring"" handling of multi-dc clusters
patch by dralves; reviewed by jbellis for CASSANDRA-3047","['StorageService.java', 'NodeProbe.java']",CASSANDRA-3047
4fd6fe3fa6a1371f5f9c16a7199fbf81320d98c7,"(cql3) Support ORDER BY when IN condition is given in WHERE clause
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-4327",['SelectStatement.java'],CASSANDRA-4327
2ff33abebf2520cbff50f4ade8a717568349edd6,"(cql3) Support ORDER BY when IN condition is given in WHERE clause
patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-4327",['SelectStatement.java'],CASSANDRA-4327
df8f823ef4c73920f2b52085c5235e214bfa3bf8,changes required for CASSANDRA-4327 with 1.2 changes to CQL3,['SelectStatement.java'],CASSANDRA-4327
c22dd08218ba4ef35b90d491fdd2e78c8e28f067,"fixes for #3047
patch by Sam Overton; reviewed by jbellis for CASSANDRA-4429",['StorageService.java'],CASSANDRA-4429
e85afdc5b6a691591834bd32f766087560c60a39,"update TokenMetadata in support of many tokens per node

Patch by Sam Overton; reviewed by jbellis for CASSANDRA-4121",['StorageService.java'],CASSANDRA-412
200ba86477f49939630b75f989afe07a2d91185a,"change SP to throw UE when hint queue is full instead of TOE, since we guarantee that no changes are performed
patch by jbellis; reviewed by slebresne for CASSANDRA-4414",['StorageProxy.java'],CASSANDRA-4414
c9a13c3c452d3e9e49bca158da93f9a9bbae7379,"add ack count to TimedOutException on writes
patch by jbellis; reviewed by slebresne for CASSANDRA-4414",['StorageProxy.java'],CASSANDRA-4414
91bdf7fb4220b27e9566c6673bf5dbd14153017c,"Add lists, sets and maps support

patch by slebresne; reviewed by jbellis for CASSANDRA-3647","['SelectStatement.java', 'ColumnFamilyStore.java']",CASSANDRA-364
ff1ba870726d9c0de24ff8dad3e23aa96465290e,"Convert bootstrap state from boolean to 3-way value; detect and retry
partial bootstraps on restart.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-4427",['StorageService.java'],CASSANDRA-4427
66b96ee5357b639729b6f220b1d5453027b866c6,"virtual nodes support for bootstrap and decommission

Patch by Sam Overton and eevans; reviewed by Brandon Williams for CASSANDRA-4122","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-412
1a3661f641e62d3fdc03eae32c60b2b33a5d90bb,"support for node removal with virtual nodes

Patch by Sam Overton and eevans; reviewed by Brandon Williams for CASSANDRA-4122",['StorageService.java'],CASSANDRA-412
8c09e87e40020139611088cf836f8f079bffb0ce,"group stream out ranges

Patch by Sam Overton; reviewed by Brandon Williams for CASSANDRA-4122",['StorageService.java'],CASSANDRA-412
4f9fd76db3b63cea98426097e424524dc07237ad,"jmx / nodetool support for virtual nodes

Patch by eevans; reviewed by Brandon Williams for CASSANDRA-4125","['StorageService.java', 'NodeProbe.java']",CASSANDRA-412
201fe94413db0125d73e01afff45fa6bd7b295a0,"migration support for virtual nodes

Patch by Sam Overton; reviewed by Brandon Williams for CASSANDRA-4127",['StorageService.java'],CASSANDRA-412
2b62df244cb9e047d13c9c6dadcf44a26505b036,"Refactor set/list/map CQL3 code

patch by xedin; reviewed by slebresne for CASSANDRA-3647",['SelectStatement.java'],CASSANDRA-364
aba1f16be8bf45b3efefe4a42d604dea155b2595,"Fix assertion error in getOverlappingSSTable during repair

patch by slebresne; reviewed by jbellis for CASSANDRA-4456",['CompactionManager.java'],CASSANDRA-44
795174611b7a9bea4ee2d64f8640c8bfebe07cfb,"(CQL3) Allow definitions with only a PK

patch by slebresne; reviewed by jbellis for CASSANDRA-4361",['SelectStatement.java'],CASSANDRA-436
06bdd3ea8e6ec8ebf47b7bd813041550f99fa48b,"rename getRangeKeySample to sampleKeyRange
patch by Jan Prach; reviewed by jbellis for CASSANDRA-4452","['StorageService.java', 'NodeProbe.java']",CASSANDRA-4452
cc0be1b40007ef4b653e4ad6bc4dbe0438b97785,"fix nodetool's setcompactionthreshold command
patch by Aleksey Yeschenko; reviewed by Pavel Yaskevich for CASSANDRA-4455","['ColumnFamilyStore.java', 'NodeProbe.java']",CASSANDRA-4455
6a6b7ec1f00d8084fb29379111a798c09c35e6d6,"Ensure compacted sstables are never used

patch by slebresne; reviewed by jbellis for CASSANDRA-4436","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-4436
7ff8e3c384df32eaca361cbb77632d04cc64060b,"Don't purge columns during upgradesstables

patch by slebresne; reviewed by jbellis for CASSANDRA-4462",['CompactionManager.java'],CASSANDRA-44
debb15ed14aeff1f9bd1fc859cff10ee7248cf8c,"clean up ioexceptions
patch by Aleksey Yeschenko and jbellis for CASSANDRA-2116","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-2116
0819ad144c8e3e4c035f8254743ec9cd1f82b919,"seed status no longer affects bootstrap setting
patch by jbellis; reviewed by slebresne for CASSANDRA-4427",['StorageService.java'],CASSANDRA-4427
ef2333590787e9b72ad08ff8a2abbfacf9382d9b,"handle maxIsColumns for parallel range fetch
Patch by Vijay, reviewed by David Alves for CASSANDRA-1337",['StorageProxy.java'],CASSANDRA-1337
916acd4910da5943271d189597ef1908b3bf29d8,"handle ApplicationState.SCHEMA not present
patch by jbellis for CASSANDRA-4427",['StorageService.java'],CASSANDRA-4427
c517c628f882593c46ba467d4f7a0f4dcb308ab2,"handle ApplicationState.SCHEMA not present
patch by jbellis for CASSANDRA-4427",['StorageService.java'],CASSANDRA-4427
652ae9a6456dd8cdd38e3eebdfbbfad51b2ad197,"improve DynamicEndpointSnitch by using reservoir sampling
patch by Pavel Yaskevich; reviewed by Brandon Williams for CASSANDRA-4038",['MessagingService.java'],CASSANDRA-4038
988c4132d77b40740b93a9eaca8fb54318bf8a97,"Fix bootstrap instajoin, take three.
Patch by jbellis and brandonwilliams, reviewed by jbellis for
CASSANDRA-4427.",['StorageService.java'],CASSANDRA-4427
8e6962f018aa9e5ec0ce38bd9c6ebbd972d8a515,"fix awaitTermination logic for streamExecutors
patch by Christopher Porter; reviewed by jbellis for CASSANDRA-4484",['MessagingService.java'],CASSANDRA-4484
afb2c00e5864e9a7b60a1ff4b60740c321faee28,"fix awaitTermination logic for streamExecutors
patch by Christopher Porter; reviewed by jbellis for CASSANDRA-4484",['MessagingService.java'],CASSANDRA-4484
5e5fbc6853468e47abe5d25817be1220e90c980f,"generify collection types
patch by slebresnse; reviewed by Paul Cannon for CASSANDRA-4453",['SelectStatement.java'],CASSANDRA-4453
29fed1f18188cfcd71c817db394c1087e0698dbd,"revert CASSANDRA-1337
comprising commits ef23335, f17fbac, 9cf915f.",['StorageProxy.java'],CASSANDRA-1337
5577ff626bb38d419a3540e0c0ccb1a9d8b8680f,"run local range scans on the read stage
patch by jbellis; reviewed by vijay for CASSANDRA-3687",['StorageProxy.java'],CASSANDRA-3687
9d2b26dac6115c2b6226c3aaebf5bae5cd381e44,"make de/serializers agree to use a short length for index expression value
patch by jbellis; reviewed by David Alves for CASSANDRA-4555",['SelectStatement.java'],CASSANDRA-4555
aa81f84c38f2c1fcad08eae955bec031341f8f75,"change cache write progress check to cache type basis; patch by yukim,
reviewed by jbellis for CASSANDRA-4533",['CompactionManager.java'],CASSANDRA-4533
e1fef724889a498e0297de897592276b9f86c5cd,"Make compaction, flush JBOD-aware
patch by yukim; reviewed by jbellis for CASSANDRA-4292","['ColumnFamilyStore.java', 'CassandraDaemon.java']",CASSANDRA-4292
dbf99d6740917cdecc342d84e1e3bec03613d8ba,"Change nodetool setcachecapcity to manipulate global caches
patch by Pavel Yaskevich; reviewed by Brandon Williams for CASSANDRA-4563",['NodeProbe.java'],CASSANDRA-4563
3925aba84260063618bf85db6d51b409116f4050,"Make jmx setters consistent with yaml config.
Patch by Chris Merrill, reviewed by brandonwilliams for CASSANDRA-4479","['Config.java', 'DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-4479
99605d9f8db9a64ce58a738de5aa236103ec8f66,"add disk_failure_policy
patch by Aleksey Yeschenko; reviewed by jbellis for CASSANDRA-2118","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SSTableReader.java', 'CassandraDaemon.java']",CASSANDRA-2118
08b3091914e99cc3c4ebded66184bb0882e5dd8a,"parallelize row cache loading
patch by jbellis; reviewed by vijay for CASSANDRA-4282",['DatabaseDescriptor.java'],CASSANDRA-4282
5c94432b239547ef3ee8326e9543200f67a2ed2f,"add request tracing
patch by David Alves; reviewed by jbellis for CASSANDRA-1123","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-1123
5b6a2b11bc8a9499ac012d745869e3d814cc91ad,"fix NPE
patch by David Alves for CASSANDRA-1123",['ColumnFamilyStore.java'],CASSANDRA-1123
0525ae25f82ea132727b395da973b06fd1733011,"log related to Murmur3Partitioner
patch by vijay; reviewed by Pavel Yaskevich for CASSANDRA-4282","['DatabaseDescriptor.java', 'SSTableReader.java']",CASSANDRA-4282
69cedbfcaad18f40dcf97648c8adf129614054db,New metrics; patch by yukim reviewed by brandonwilliams for CASSANDRA-4009,"['ColumnFamilyStore.java', 'CompactionManager.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-4009
8a1b93d79f39b80979f5403de1fac4f7e8d7cb02,"redesign KEYS indexes to avoid read-before-write
patch by Sam Tunnicliffe, jbellis, and Philip Jenvey for CASSANDRA-2897",['ColumnFamilyStore.java'],CASSANDRA-2897
b475bc69b7e6d08e6d12527578552e67e8c0f88a,"Binary encoding of tokens.
Also promotes new gossip states: HOST_ID and TOKENS
Patch by brandonwilliams, reviewed by eevans for CASSANDRA-4383",['StorageService.java'],CASSANDRA-4383
8eb2fed1ebcbb9a1dd6d64673e8b9aede577660e,Respect 5min flush moratorium after CL replay; patch by yukim reviewed by jbellis for CASSANDRA-4474,['ColumnFamilyStore.java'],CASSANDRA-4474
978d7bb7d59492129aee2747308d55f949003b02,"fix clientutil.jar dependencies
patch by dbrosius and eevans reviewed by eevans for CASSANDRA-4566",['MessagingService.java'],CASSANDRA-4566
0e3a9a55e484707addf32f73d18014df61c8d8f9,"include message initiation time to replicas
patch by jbellis; reviewed by vijay for CASSANDRA-2858",['MessagingService.java'],CASSANDRA-2858
4177b58f1099cb9f8de87b9432014b0afac90da0,"Improve ORDER BY validation (CQL3)

patch by slebresne; reviewed by jbellis for CASSANDRA-4624",['SelectStatement.java'],CASSANDRA-462
7371e10be40d9a01167d36eb2db69526b6b0ce50,"Fix potential deadlock during counter writes

patch by slebresne; reviewed by jbellis for CASSANDRA-4578",['StorageProxy.java'],CASSANDRA-4578
ceca1997d045c8f09b198e73a956bfaddc11485a,"Fix update of CF comparator

patch by slebresne; reviewed by jbellis for CASSANDRA-4493",['ColumnFamilyStore.java'],CASSANDRA-44
76e092b2d3785ac1549f1af16702839bee570c69,"Fix cql error with ORDER BY when using IN
patch by Pavel Yaskevich; reviewed by Sylvain Lebresne for CASSANDRA-4612",['SelectStatement.java'],CASSANDRA-4612
b38ca2879cf1cbf5de17e1912772b6588eaa7de6,"add atomic_batch_mutate
patch by Aleksey Yeschenko; reviewed by jbellis for CASSANDRA-4542","['ColumnFamilyStore.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-4542
aba5a37650232dbf10b505c04b257f73b6c9b579,"Improve IAuthority interface by introducing fine-grained access permissions and grant/revoke commands
patch by Pavel Yaskevich; reviewed by Yuki Morishita for CASSANDRA-4490","['DatabaseDescriptor.java', 'SelectStatement.java']",CASSANDRA-4490
e681a1a62280dca648b8dd1b6a1d386cb1a2788e,"Fix cql error with ORDER BY when using IN
patch by Pavel Yaskevich; reviewed by Sylvain Lebresne for CASSANDRA-4612",['SelectStatement.java'],CASSANDRA-4612
bcec7a5e225ccc5be16c224b397abab267fe2a46,"Improve IAuthority interface by introducing fine-grained access permissions and grant/revoke commands
patch by Pavel Yaskevich; reviewed by Yuki Morishita for CASSANDRA-4490","['DatabaseDescriptor.java', 'SelectStatement.java']",CASSANDRA-4490
c64d975cdf9eebddb04801573035a7272f779fed,Add SSTable count per level to cfstats patch by yukim; reviewed by jbellis for CASSANDRA-4537,['ColumnFamilyStore.java'],CASSANDRA-4537
aa8989d9b98f35a95c988f0b664a0b4ffd232bac,"(cql3) Allow defining default consistency levels

patch by slebresne; reviewed by yukim for CASSANDRA-4448",['SelectStatement.java'],CASSANDRA-44
1f365196f3e08c201c7e985ed0a7c0abb9a8c84e,"p/4443/010_refactor_range_move

Break out common code from SS.move(Token) for later use in range
relocation.

Patch by eevans; reviewed by Brandon Williams for CASSANDRA-4559",['StorageService.java'],CASSANDRA-455
9f643a4ae62200d47fbe64f2b44260b767449767,"p/4443/020_calculate_pending

Wire a collection of relocating tokens into the calculation
of endpoints for pending ranges.

Patch by eevans; reviewed by Brandon Williams for CASSANDRA-4559",['StorageService.java'],CASSANDRA-455
a02bbf50eb09f1364de21eb41d91e6521610092b,"p/4443/030_relocate_token

Implement token/range relocation.

Patch by eevans; reviewed by Brandon Williams for CASSANDRA-4559",['StorageService.java'],CASSANDRA-455
398b1d263379a5b3ae080b3d985e00b032ca1ddf,"p/4443/050_process_queued_xfers

Read queued token ranges transfers from a column family, and initiate
relocations.

Patch by eevans; reviewed by Brandon Williams for CASSANDRA-4559",['StorageService.java'],CASSANDRA-455
6fc30803e13e9d73f3d1a8141bc306f251e734d4,"(cql3) Fix queries using LIMIT missing results

patch by slebresne; reviewed by xedin for CASSANDRA-4579",['SelectStatement.java'],CASSANDRA-457
b43cc362aa568a46bc53e545c68518b0bd350b76,"Backport proxyhistograms to 1.1, print zero instead of blank values.
Patch by Alexey Zotov, reviewed by brandonwilliams for CASSANDRA-4656","['StorageProxy.java', 'NodeProbe.java']",CASSANDRA-4656
a4c397b49c08f543fd42ddc21a6312bce5571947,"fix error when using ORDER BY with extended selections
patch by Pavel Yaskevich; reviewed by Sylvain Lebresne for CASSANDRA-4689",['SelectStatement.java'],CASSANDRA-4689
9df0ed97c64847df8264d6c71ea7986b2275aff8,"optimize single-row PK lookups
patch by Daniel Norberg; reviewed by jbellis for CASSANDRA-4710",['SSTableReader.java'],CASSANDRA-4710
ee4a26d8659f4ab09d2646de0b68d39db958bdb9,"Fix validation for IN queries with non-PK cols

patch by slebresne; reviewed by jbellis for CASSANDRA-4709",['SelectStatement.java'],CASSANDRA-47
9c88ad16a69ccc8603c1be9d6253075549fb270f,"Fix validation for IN queries with non-PK cols

patch by slebresne; reviewed by jbellis for CASSANDRA-4709",['SelectStatement.java'],CASSANDRA-47
1078e6f514bcfbcaadb2517099baab5f3d21d510,"Avoid ConcurrentModificationExceptions on relocateTokens
patch by dbrosius reviewed by jbellis for CASSANDRA-4727",['StorageService.java'],CASSANDRA-4727
6ca75ef9ba0fff52741f25b1b1350a0c10f17b68,"remove vestiges of Thrift unframed mode
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-4729",['DatabaseDescriptor.java'],CASSANDRA-4729
0b94b191d803f2a59e39c0e14fca45f5fb2ceb65,"add PBSPredictor consistency modeler
patch by Peter Bailis and Shivaram Venkataraman; reviewed by jbellis for CASSANDRA-4261","['MessagingService.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-4261
5dc8ba837a706be7f4f8e180b9bafdb61aa4ccac,"Add support for batchlog in CQL3

patch by iamaleksey; reviewed by slebresne for CASSANDRA-4545",['StorageProxy.java'],CASSANDRA-454
d41d5f6db29721726765723a1cba8d38bb52ce22,"include metadata for system keyspace itself in schema tables
patch by jbellis; reviewed by slebresne for CASSANDRA-4416",['DatabaseDescriptor.java'],CASSANDRA-4416
5eb53085398af4d30002785ee21f50b894208735,"Allow repairing only the node in the local DC

patch by Alexey Zotov; reviewed by slebresne for CASSANDRA-4747","['StorageService.java', 'NodeProbe.java']",CASSANDRA-47
6ddcf0388b5e968b52ec3dee5b2d9a4482e371e5,"Fix CQL3 'is reversed' logic

patch by slebresne; reviewed by tjake for CASSANDRA-4716",['SelectStatement.java'],CASSANDRA-47
0e0213b60468232b43b3d9661c75b1021564a853,"Don't return ReversedType in CQL3 resultSet

patch by slebresne; reviewed by tjake for CASSANDRA-4717",['SelectStatement.java'],CASSANDRA-47
d170a7a99dfc04499e8bb8cbca0fc4e14aa1fc26,"Fix inconsistencies between yaml and code defaults.
Patch by Alexey Zotov, reviewed by brandonwilliams for CASSANDRA-4754",['Config.java'],CASSANDRA-4754
e863c2b71cbf917dde2d0c5f236b749f0070c1dc,"Use rpc_address for binary protocol and change default port

patch by slebresne; reviewed by jbellis for CASSANDRA-4751","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-47
eff4b686653fb15593c7fecd2033f60b65c9ee8f,"CQL3 Predicate logic bug when using composite columns

patch by slebresne; reviewed by tjake for CASSANDRA-4759",['SelectStatement.java'],CASSANDRA-47
d5ec013cee4f3d923d9618694716a265ab04fe1b,"Store more informations in peers table

patch by slebresne; reviewed by jbellis for CASSANDRA-4351",['StorageService.java'],CASSANDRA-435
e3f642b8c50db3af3f398d40dbad26f4c417eb16,"clean up unnecessary copy on KeyCache lookup
patch by jbellis; reviewed by yukim for CASSANDRA-4732",['SSTableReader.java'],CASSANDRA-4732
8264eb21ccb20423ff7bdae0fbef6d88fe2b2529,"Add ability to use custom TServerFactory implementations
patch by Jason Brown; reviewed by Pavel Yaskevich for CASSANDRA-4608","['DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-4608
801d7d3f5c5ce31e1335d2633e82111faa512716,"handle empty flushes of batchlog memtable
patch by jbellis; tested by Aleksey Yeschenko for CASSANDRA-4667",['ColumnFamilyStore.java'],CASSANDRA-4667
ee5aafe6a4cb409f16c48edcb3a1682c7d6b400e,"Improve write timeout exceptions

patch by slebresne; reviewed by jbellis for CASSANDRA-4723",['StorageProxy.java'],CASSANDRA-47
2a3076bf77d063402c5d3afa93e1398a1f03833b,"Run leveled compaction in parallel; patch by yukim, reviewed by jbellis for CASSANDRA-4310",['CompactionManager.java'],CASSANDRA-4310
d525cf969c042b21a9375446f5449ee82d7d1484,"update startup log messages
Patch by Vijay, reviewed by brandonwilliams for CASSANDRA-4802",['StorageService.java'],CASSANDRA-4802
c8a7618763f59372d291f928d996d2593b93872b,"Fix potential NPE during CFS reload

patch by slebresne; reviewed by xedin for CASSANDRA-4786",['ColumnFamilyStore.java'],CASSANDRA-47
18acbef1356e1130f816eceacdff49c9ebf3c50c,"Fix composite index missing results

patch by slebresne; reviewed by jbellis for CASSANDRA-4796",['SelectStatement.java'],CASSANDRA-47
297f530c246a8dcfa3372d33204f17c2edee7b45,"Move consistency level to the protocol level

patch by slebresne; reviewed by jbellis for CASSANDRA-4734",['SelectStatement.java'],CASSANDRA-47
eb775fe7c225699a8ea61901b6dc887716780909,"Always gossip DC and Rack information

patch by slebresne; reviewed by driftx for CASSANDRA-4814",['StorageService.java'],CASSANDRA-481
c9b249b2a83512844a2ec2611a919d4567212ee8,"Make SerializingCacheProvider the default when absent from the yaml.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-4828",['Config.java'],CASSANDRA-4828
8495560c2ba71621ab4326de7a87e9f3222ab8e4,"Support client Thrift SSL socket
patch by Jason Brown; reviewed by Vijay for CASSANDRA-4239","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java']",CASSANDRA-4239
e400d0eca27f3c00e36e3871a30ac5c97891abbe,"fix possible stackoverflow when compacting 1000s of sstables
patch by jbellis; reviewed by yukim for CASSANDRA-4765",['ColumnFamilyStore.java'],CASSANDRA-4765
a28a2ba93764c602268d17ce4e5604ba179428f4,"Require enabling cross-node timeouts
patch by Vijay; reviewed by jbellis for CASSANDRA-4812","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-4812
533bf3f6a8c3a1802c5a88a79dba34027a60075a,"add describe_splits_ex providing improved split size estimate
patch by Piotr Kolaczkowski; reviewed by jbellis for CASSANDRA-4803",['StorageService.java'],CASSANDRA-4803
69ad77d8c6a1e2c78255d54477798d5619a3a84d,"remove vestiges of STREAM stage
patch by jbellis; reviewed by yukim for CASSANDRA-4764","['MessagingService.java', 'StorageService.java']",CASSANDRA-4764
269c0cdac3d0457e6f00f6f055b5aa280a21e8b2,"make TRACE verb droppable
patch by David Alves; reviewed by jbellis for CASSANDRA-4672",['MessagingService.java'],CASSANDRA-4672
3b8bff78d40804b37fa0658b0a8e4342dd98366f,"Fix assertion error in cql3 select

patch by slebresne; reviewed by jbellis for CASSANDRA-4783",['SelectStatement.java'],CASSANDRA-47
fb15aa9f635f837093812fb0640dc53199f7270e,"remove vestiges of STREAM stage, take 2
patch by jbellis; reviewed by yukim for CASSANDRA-4764","['MessagingService.java', 'StorageService.java']",CASSANDRA-4764
db3c198ad0ce46e255202d03ead7ad44df127070,"fix BulkLoader NPE caused by #4732
patch by jbellis; reviewed by yukim for CASSANDRA-4846",['SSTableReader.java'],CASSANDRA-4846
63a8bfe030ece2497c839bb34148b73e416466f4,"Fix binary protocol NEW_NODE event

patch by slebresne; reviewed by yukim for CASSANDRA-4679","['CassandraDaemon.java', 'StorageService.java']",CASSANDRA-467
b74a00b289f7c6c7287b68db870409bc598ed287,Fix potential infinite loop in tombstone compaction; patch by yukim reviewed by Sylvain Lebresne for CASSANDRA-4781,['SSTableReader.java'],CASSANDRA-4781
dc37dea745fe89d70819d649c823d9bfcb0d7577,"off-heap bloom filters for row keys
patch by vijay; reviewed by jbellis for CASSANDRA-4865",['SSTableReader.java'],CASSANDRA-4865
353309f01313c2f7fd7ce882444b175dcd62baef,"Fix short read protection for CQL3

patch by slebresne; reviewed by jbellis for CASSANDRA-4882",['StorageProxy.java'],CASSANDRA-488
37cf942c1128dfff392ce2947cc4c652a957c318,"LCS defaults to AlwaysPresentFilter
patch by jbellis; reviewed by vijay for CASSANDRA-4876",['SSTableReader.java'],CASSANDRA-4876
73f479c287d3f8b399926abea7d771e34c79f623,"Fix deadlockin mutation state underconcurrent, CL > ONE writes to counters
backport of CASSANDRA-4578",['StorageProxy.java'],CASSANDRA-4578
110f69c3b857483162c7e86c7ad63061a13dab7f,"Remove nodes in total on restart.
Patch by brandonwilliams, reviewed by Vijay for CASSANDRA-4840","['MessagingService.java', 'StorageService.java']",CASSANDRA-4840
f32110c6c3ad53aa18aff02565722af82f68533a,"remove IAuthority2
patch by Aleksey Yeschenko; reviewed by jbellis for CASSANDRA-4875","['DatabaseDescriptor.java', 'SelectStatement.java']",CASSANDRA-4875
d564a2f02bcbfd850b51e9eea5297b79a4bd369c,"Don't share slice query filter in SelectStatement

patch by slebresne; reviewed by jbellis for CASSANDRA-4928",['SelectStatement.java'],CASSANDRA-492
f09a89f4cd13af2087fcc92f09f6cf1ee4785feb,"acquire references on overlapped sstables
patch by jbellis; reviewed by vijay for CASSANDRA-4934","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-4934
a05f6766e292769fde3b7536e5586cf324a1cb17,"expunge row cache post-truncate
patch by jbellis; reviewed by slebresne for CASSANDRA-4940",['CompactionManager.java'],CASSANDRA-4940
38bfc6dca06bd0192167ae5e9bd51d593542f03e,"avoid flushing everyone on truncate; save truncation position in system table instead
patch by jbellis; reviewed by yukim for CASSANDRA-4906","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-4906
a2ca30e79510a04ca1f6b9c5a342ee9467176a9f,"reset getRangeSlice filter after finishing a row forget_paged_slice
patch by Piotr Kołaczkowski; reviewed by jbellis for CASSANDRA-4919",['StorageProxy.java'],CASSANDRA-4919
60027c4ccabaab390dbf4c4bba83ac3a843b3a48,"add memtable_flush_period_in_ms
patch by yukim; reviewed by jbellis for CASSANDRA-4237",['ColumnFamilyStore.java'],CASSANDRA-4237
309666b4dddd7e0292d8dfc5661901d9cb9fc549,Skip repair on system_trace and keyspaces with RF=1; patch by yukim reviewed by Sylvain Lebresne for CASSANDRA-4956,['StorageService.java'],CASSANDRA-4956
dd1633ba0bf0e15547f5b7048271ab7334e862f0,"Fix endless loop/compaction of schema_* CFs due to broken timestamps
patch by Pavel Yaskevich; reviewed by Brandon Williams for CASSANDRA-4880",['MessagingService.java'],CASSANDRA-4880
a8e848241a5eab8947cb521dd631da91deaa1d5d,"Make SerializingCache Memory Pluggable
Patch by vijay, reviewed by jbellis for CASSANDRA-3997","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-3997
9366fb32305a59822c7b914788995f2b11d92064,"Fix unit test failures

patch by slebresne; reviewed by yukim for CASSANDRA-4980",['StorageService.java'],CASSANDRA-498
8c24d019fced1bb6039310c192208721462d280a,Remove cassandra specific exceptions from JMX interface; patch by yukim reviewed by dbrosius for CASSANDRA-4893,"['ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-4893
6fb751240013799a13890282e1af1f7dc85d9e8d,"Prevent inefficient queries (CQL3)

patch by slebresne; reviewed by jbellis for CASSANDRA-4915",['SelectStatement.java'],CASSANDRA-491
b44abadafb5e54e579c2e726036ca07c8f74b3f4,"Refuse ttl/writetime function on collection

patch by slebresne; reviewed by yukim for CASSANDRA-4992",['SelectStatement.java'],CASSANDRA-499
24cf1d1256dd837cfb9b310195c83f9bb1aa697a,"client_encryption_options to use enabled 
Patch by aleksey reviewed by vijay for CASSANDRA-4994","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java']",CASSANDRA-4994
e3f48f2e341fe7425401c42d45bec1e23bd4eae5,"client_encryption_options to use enabled
Patch by aleksey reviewed by vijay for CASSANDRA-4994","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java']",CASSANDRA-4994
7b4639ab26d6c1f174bab07a32eb7838c1c51c09,"improve error message on partitioner mismatch
patch by jbellis; reviewed by slebresne for CASSANDRA-4843",['SSTableReader.java'],CASSANDRA-4843
5a3eb1a6c3e61bd217e23e5d1e7c27f03fab4f08,"Replace IAuthority with new IAuthorizer; patch by Aleksey Yeschenko,
reviewed by Jonathan Ellis for CASSANDRA-4874","['Config.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-4874
6a5c9ed87995059e8cb824608fd5907432fa7ab4,"make index_interval configurable per columnfamily
patch by Radim Kolar; reviewed by jbellis for CASSANDRA-3961","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-3961
8a96ec702168430eea7400d41fc476b93c7e7404,"rename rpc_timeout settings to request_timeout
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-5027","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java']",CASSANDRA-5027
5abeecc8b51b896742403d48019300b68caceecb,"Allow overriding available processors with
-Dcassandra.available_processors
Patch by brandonwilliams, reviewed by iamaleksey for CASSANDRA-4790","['Config.java', 'DatabaseDescriptor.java', 'SSTableReader.java', 'StorageProxy.java', 'CassandraDaemon.java']",CASSANDRA-4790
2f3b5bfb2da968b408062d56b9d41ab420b95ba2,"Allow overriding available processors with
-Dcassandra.available_processors
Patch by brandonwilliams, reviewed by iamaleksey for
CASSANDRA-4790","['Config.java', 'DatabaseDescriptor.java', 'SSTableReader.java', 'StorageProxy.java']",CASSANDRA-4790
d6d4151ee24791aa35a983de1c39cc4f895d6a55,"Allow overriding available processors with
-Dcassandra.available_processors
Patch by brandonwilliams, reviewed by iamaleksey for CASSANDRA-4790","['Config.java', 'DatabaseDescriptor.java', 'SSTableReader.java', 'StorageProxy.java', 'CassandraDaemon.java']",CASSANDRA-4790
7322f8238bb53efbac2a078585c4582cb1fc5e4a,"Load host_ids when adding saved endpoints
Patch by brandonwilliams, reviewed by tjake for CASSANDRA-5032",['StorageService.java'],CASSANDRA-5032
442a7b3a60c5cc765221cc6f07add3546a8e9c3d,"Pull schema immediately when bootstrapping.
Patch by Chris Herron and brandonwilliams, reviewed by jbellis for
CASSANDRA-5025",['StorageService.java'],CASSANDRA-5025
c9ce1f0111202044d686f335fc2ebf0fe771ed79,"Pull schema immediately when bootstrapping.
Patch by Chris Herron and brandonwilliams, reviewed by jbellis for
CASSANDRA-5025",['StorageService.java'],CASSANDRA-5025
5b511b62136d3bcb230a282fa433a122d061ee22,"reduce log spam from invalid counter shards
patch by slebresne and jbellis for CASSANDRA-5026",['CompactionManager.java'],CASSANDRA-5026
bddfa9e120bdafc204bde97bb51de1f86bf9695b,"Update IAuthenticator to match the new IAuthorizer;
patch by Aleksey Yeschenko, reviewed by Jonathan Ellis for CASSANDRA-5003","['DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-5003
26e71c1ce476b74f7fc209d829b5d7e3896ff6c8,"Fix race condition in default superuser setup;
patch by Sylvain Lebresne and Aleksey Yeschenko for CASSANDRA-5049",['StorageService.java'],CASSANDRA-5049
158376963b10f2cba75d76f9d0f4f330dfeb53e7,"apply disk_failure_policy to bad disks on initial directory creation
patch by Kirk True; reviewed by jbellis for CASSANDRA-4847","['DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-4847
3e70d3ac41af9167a7e883c3989a1e69703437eb,"off-heap cache doesn't need mutable column container
patch by jbellis; reviewed by slebresne for CASSANDRA-5057",['ColumnFamilyStore.java'],CASSANDRA-5057
d67816bee5271a4f65116561950bbd2b6fcf51a4,"fix nodetool ownership display with vnodes
patch by jbellis; reviewed by yukim for CASSANDRA-5065",['StorageService.java'],CASSANDRA-5065
1a66ee9a94d67ae475ae287b280517aa9e3cc318,"fix specifying and altering crc_check_chance;
patch by Marcus Eriksson and Aleksey Yeschenko, reviewed by Aleksey
Yeschenko for CASSANDRA-5053",['ColumnFamilyStore.java'],CASSANDRA-5053
de2495c2c9bf8d8387d241df2962ae52f092b145,"fix hinting for dropped local writes
patch by jbellis and aleksey for CASSANDRA-4753","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-4753
34630f6447c188ca02ecb8276c5fcc6a505f75fa,"Don't expire columns sooner than they should with 2ndary indexes

patch by amorton; reviewed by slebresne for CASSANDRA-5079",['CompactionManager.java'],CASSANDRA-507
ac9f4786e4d7b3b1a414838eec465f8553bf43b2,"Improve removal of gcable tomstones during minor compaction
patch by Vijay; reviewed by Yuki Morishita for CASSANDRA-4671","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-4671
8219195d0af457a5343c989496fca2edc4f53ff7,"add threadpool size adjustment methods to JMXEnabledThreadPoolExecutor and CompactionManagerMBean
patch by Carl Yeksigian; reviewed by jbellis for CASSANDRA-5044",['CompactionManager.java'],CASSANDRA-5044
3a005df39797bd7b785d76830e72f3487dc9fa4e,"Replace supercolumns internally by composites

patch by slebresne; reviewed by Vijay for CASSANDRA-3237","['SelectStatement.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'MessagingService.java', 'StorageProxy.java']",CASSANDRA-323
0d6131c400cc296796f132f802f4156408e84ace,"Validat correctly selects on composite partition key

patch by slebresne; reviewed by jbellis for CASSANDRA-5122",['SelectStatement.java'],CASSANDRA-512
0906b7cc5173770e04932432d40503f7c39eb61f,Show progress on nodetool repair command; patch by yukim reviewed Sylvain Lebresne for CASSANDRA-4767,"['StorageService.java', 'NodeProbe.java']",CASSANDRA-4767
945853076c44d071ba5b554ecb69a080e5719d32,"Handle states for non-vnode clusters correctly.
Patch by brandonwilliams reviewed by slebresne for CASSANDRA-5127",['StorageService.java'],CASSANDRA-5127
9ccaaadec636b63f63d3206fc66ef4d035f6a311,"Add jmx/nodetool methods to enable/disable hint storage/delivery
Patch by Alexey Zotov and brandonwilliams, reviewed by Alexey Zotov for
CASSANDRA-4750",['NodeProbe.java'],CASSANDRA-4750
1c2a69c3580c0f093e48e06aea06408fe6e9d942,"fix validation compaction of empty rows
patch by Carl Yeksigian; reviewed by jbellis for CASSANDRA-5136",['CompactionManager.java'],CASSANDRA-5136
f481a39167086ee4958d88b49e87ade091d4d858,Fix user defined compaction; patch by yukim reviewed by jbellis for CASSANDRA-5118,['CompactionManager.java'],CASSANDRA-5118
3cc8656f8fbb67c7e665fe27642076ae0109c2b5,better handling for amid compaction failure; patch by yukim reviewed by slebresne for CASSANDRA-5137,['ColumnFamilyStore.java'],CASSANDRA-5137
6487bc50bbe91b559906d90695c91f3d7f54fd2f,"add inter_dc_tcp_nodelay option
patch by Marcus Eriksson; reviewed by jbellis for CASSANDRA-5148","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-5148
713bba5af085273650b8202b4a7c225b5a094b5f,"Calculate pending ranges asynchronously.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-5135",['StorageService.java'],CASSANDRA-5135
b153d45644b1af0e645fcb3cdc1c835949289e41,"Upgrade thrift version to 0.9.0

Patch by jfarrell; reviewed by tjake for CASSANDRA-3719",['StorageService.java'],CASSANDRA-37
1fac06a848013863f47067f8ff7f769a2a08e276,"drain should flush system CFs too
patch by jbellis; reviewed by yukim for CASSANDRA-4446",['StorageService.java'],CASSANDRA-4446
79764f743f98a890f4484b83b26b5972283f65ff,"Exclude all system-related CFs from CFS.allUserDefined()
Patch by Jason Brown, reviewed by brandonwilliams for CASSANDRA-5160",['ColumnFamilyStore.java'],CASSANDRA-5160
ec35427fdfbc46a8adeafc042651f552b9bcc1a0,"Don't remove tokens for node we know in System.peers

patch by slebresne; reviewed by driftx for CASSANDRA-5121",['StorageService.java'],CASSANDRA-512
4495736227a2f610262a26162ed93d64f321d0e1,"Fix bogus sharing of SliceQueryFilter when using superColumn

patch by slebresne; reviewed by jbellis for CASSANDRA-5123",['SelectStatement.java'],CASSANDRA-512
205a9939c19b5fe10b59589c41c37f04543c8ad8,"Expose droppable tombstone ratio stats over JMX
patch by meriksson reviewed by dbrosius for CASSANDRA-5159","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-5159
e6b6eaa583e8fc15f03c3e27664bf7fc06b3af0a,"Remove endpoints from system.peers correctly.
Patch by brandonwilliams reviewed by slebresne for CASSANDRA-5167",['StorageService.java'],CASSANDRA-5167
f930eb79cd4567efaeca44142bf8ea93a181f37e,fix saved key cache not loading at startup; patch by yukim reviewed by jbellis for CASSANDRA-5166,['SSTableReader.java'],CASSANDRA-5166
43c9e8156a5b9ae3fd5fce07f885365538d6ca50,"Preload essential gossip states before startup.
Patch by brandonwilliams, reviewed by slebresne for CASSANDRA-5107",['StorageService.java'],CASSANDRA-5107
11d1414628c18d07f7449af0aa9374406077b9a8,Fix test failures for CASSANDRA-5175,['MessagingService.java'],CASSANDRA-5175
cc66c73ba60ec3f062e3fd699b76e352f8b10f6d,"stream undelivered hints on decommission
patch by Jason Brown; reviewed by jbellis for CASSANDRA-5128",['StorageService.java'],CASSANDRA-5128
c25a6a14c8d0592c9e842d42d1362042e7109599,"Speculative execution for Reads
Patch by Vijay, reviewed by jbellis for CASSANDRA-4705","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-4705
21f63a916dbab243a5104d12587bb29dcbbb6201,"Allow populate_io_cache_on_flush to be set per-CF.
Patch by Alexey Zotov, reviewed by brandwonwilliams for CASSANDRA-4694",['DatabaseDescriptor.java'],CASSANDRA-4694
22f515b3760279046f051c083c8c2fe66bb80d56,"Allow populate_io_cache_on_flush to be set per-CF.
Patch by Alexey Zotov, reviewed by brandwonwilliams for CASSANDRA-4694",['DatabaseDescriptor.java'],CASSANDRA-4694
aa90c88be14b337714739cd857c12cad2a9fedeb,"more robust solution to incomplete compactions + counters
patch by yukim; reviewed by jbellis for CASSANDRA-5151","['ColumnFamilyStore.java', 'CassandraDaemon.java']",CASSANDRA-5151
0d4923f246d5f6450d2908b59b4b7e70f9ebbfbe,"Allow configuration of internode socket buffer.
Patch by Michael Michalski and Jason Brown for CASSANDRA-3389, reviewed
by Jason Brown.","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-3389
6bddbb2dd242cacd50cf1b98643385c7b22c1939,fix nodetool repair not fail on node down; patch by yukim reviewed by brandonwilliams for CASSANDRA-5203,['NodeProbe.java'],CASSANDRA-5203
60acf0d792cb761da06bf1fc91d9f2b57fcc065c,"Log when a node is down longer than the hint window
Patch by Vijay, reviewed by Carl Yeksigian and jbellis for
CASSANDRA-4554",['StorageProxy.java'],CASSANDRA-4554
b1274b8c2a9eb6b504afac8f17a42889746b7d00,"Correctly expire gossip states for edge cases.
Patch by yangwei, reviewed by brandonwilliams for CASSANDRA-5216",['StorageService.java'],CASSANDRA-5216
75d0f7a3fa864031b6214cc8fcd619966b96e0a6,"Correctly expire gossip states for edge cases.
Patch by yangwei, reviewed by brandonwilliams for CASSANDRA-5216",['StorageService.java'],CASSANDRA-5216
cef8eb07dfb4b81cd4e985bc86c5506602650c93,"Expose 2I to the rest of nodetool
Patch by Jason Brown, reviewed by brandonwilliams for CASSANDRA-4464","['CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-4464
31e669ab425759b8a6e5c09a1d6635d013b838d9,"CQL3 refactor to allow conversion function

patch by slebresne; reviewed by iamaleksey for CASSANDRA-5226",['SelectStatement.java'],CASSANDRA-522
828572acdb5bff31f58362425b0c80ce6d606bf8,"Avoid throwing AE when hosts don't have a hostId
Patch by brandonwilliams, reviewed by iamaleksey for CASSANDRA-5197",['StorageService.java'],CASSANDRA-5197
59af0b9c4d4cd00ea742e197b2b3cb2f384feec3,drop keyspace from user-defined compaction API; patch by yukim reviewed by jbellis for CASSANDRA-5139,['CompactionManager.java'],CASSANDRA-5139
3925f56061307971008fdd0db48c4e29e0700443,"Stop compactions from handing during bootstrap.
Patch by brandonwilliams, reviewed by Vijay for CASSANDRA-5244",['StorageService.java'],CASSANDRA-5244
7ff2805c7e6a362eb451e6b8dfaec59642fee0f2,revert CASSANDRA-5151 from 1.2,"['ColumnFamilyStore.java', 'CassandraDaemon.java']",CASSANDRA-5151
86063aa2087b5b0bb9eff6458b528f74a39eaf02,"Fix forceBlockingFlush behavior

patch by krummas; reviewed by slebresne for CASSANDRA-5241",['ColumnFamilyStore.java'],CASSANDRA-524
0e284787294221982d21c17b27c0a4e1ae0971e7,"Move sstable level information into the Stats component
patch by Marcus Eriksson; reviewed by jbellis for CASSANDRA-4872","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'CassandraDaemon.java']",CASSANDRA-4872
686f516ccb887fe977238b53b9be307b56432b8c,"fix potential for multiple concurrent compactions of the same sstables
patch by jbellis and yukim; reviewed by slebresne for CASSANDRA-5256","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-5256
03b4c2794c4c0f5e11ec9a24b52b523d8746fbb5,"Fix CQL3 composite partition key error

patch by slebresne; reviewed by jbellis for CASSANDRA-5240",['SelectStatement.java'],CASSANDRA-524
89ab670eb54fe267afa83a56f9d90bb4cd10b9e5,"Allow IN clause for last clustering key

patch by slebresne; reviewed by jbellis for CASSANDRA-5230",['SelectStatement.java'],CASSANDRA-523
00748405bc374ee8f5ade4891a6a1445df072344,"Add nodetool options to repair specific ranges.
Patch by brandonwilliams, reviewed by yukim for CASSANDRA-5280","['StorageService.java', 'NodeProbe.java']",CASSANDRA-5280
a4166496f2df6bc8072e7b30c29102937788f400,"Avoid allocating SSTableBoundedScanner during repair when the range does not intersect the sstable
patch by jbellis; reviewed by slebresne for CASSANDRA-5249",['SSTableReader.java'],CASSANDRA-5249
2575275a04938e361a874ba685e50ac0e88df246,"Allow custom configuration loader

patch by slebresne; reviewed by jasobrown for CASSANDRA-5045","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-504
1936648a1188b8948048610eb2ccea316a39c647,"change Message IDs to ints
patch by jbellis; reviewed by vijay for CASSANDRA-5307","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-5307
3a6125db8782f09c291ec3625af65c624e16df3a,"fix DatabaseDescriptor.hasExistingNoSystemTables to skip system table correctly
patch by Jackson Chung; reviewed by jbellis for CASSANDRA-5289",['DatabaseDescriptor.java'],CASSANDRA-5289
8daa5d2df72c40e75efeaa32dba83e0cb49a8034,"log warnings about java versions that you probably shouldn't be running
patch by Joaquin Casares; reviewed by jbellis for CASSANDRA-4570",['CassandraDaemon.java'],CASSANDRA-4570
416f80d82eabc2c65ece41a0d781f101625582f2,"add logging of data directories and multithreaded_compaction
patch by Joaquin Casares; reviewed by jbellis for CASSANDRA-4570","['DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-4570
aadc5e500d4b4080e56e706b8df826328fd87088,"fix DatabaseDescriptor.hasExistingNoSystemTables to skip system table correctly
patch by Jackson Chung; reviewed by jbellis for CASSANDRA-5289",['DatabaseDescriptor.java'],CASSANDRA-5289
d1e91a771dc30516a0dfb8a6d021869ae135cdac,"log warnings about java versions that you probably shouldn't be running
patch by Joaquin Casares; reviewed by jbellis for CASSANDRA-4570",['CassandraDaemon.java'],CASSANDRA-4570
dc0bc878ee1af3d78fa7d9b3fb7538f4554f541a,"add logging of data directories and multithreaded_compaction
patch by Joaquin Casares; reviewed by jbellis for CASSANDRA-4570","['DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-4570
564463e40b129ca79bd5a21a46c431f471bcd5cb,"fix DatabaseDescriptor.hasExistingNoSystemTables to skip system table correctly
patch by Jackson Chung; reviewed by jbellis for CASSANDRA-5289",['DatabaseDescriptor.java'],CASSANDRA-5289
e79d9fbf84a35021cafa21d428e08fdd9bee584e,"Remove memory emergency pressure valve logic

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-3534","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-353
b5f172624af4083b3b7683060a595ca437daf4c7,Fix repair -pr for vnodes; patched by yukim reviewed by driftx for CASSANDRA-5329,['StorageService.java'],CASSANDRA-5329
ffc9bece4854c8f6aae7f672e262897d06fce50d,Fix race when opening ColumnFamilyStore; patch by yukim reviewed by jbellis for CASSANDRA-5350,['ColumnFamilyStore.java'],CASSANDRA-5350
87d936251df056211673b90d62f37b9fe3440d83,"Catch harmless error on shutdown.
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-5368",['MessagingService.java'],CASSANDRA-5368
d72e9381fa8f992e182b415d6060128b567808be,"Replace compaction lock with runWithCompactionsDisabled
patch by jbellis; reviewed by slebresne for CASSANDRA-3430","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java']",CASSANDRA-3430
effdb08b341e7c3799a50983c6086d7f4bbaf120,"Improve LeveledScanner work estimation
patch by Marcus Eriksson; reviewed by jbellis for CASSANDRA-5250",['SSTableReader.java'],CASSANDRA-5250
27ed655fd0552055bd1c26c62c098c16501bc32b,"Change Kernel Page Cache skipping into row preheating (disabled by default)
patch by Pavel Yaskevich; reviewed by Jonathan Ellis and Yuki Morishita for CASSANDRA-4937","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-4937
4937ac7e5776cf72e4c3b266fbffb29ff97c807a,"Track maximum ttl and use to expire entire sstables

patch by krummas; reviewed by slebresne for CASSANDRA-5528",['CompactionManager.java'],CASSANDRA-552
9f18611775fc6c277ec1521d0bcd084bda4498ef,"Change default stream throughput from 400 to 200 mbps
patch by Alexey Zotov; reviewed by Marcus Eriksson for CASSANDRA-5036","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-5036
37010e9d75c695d9e538873dadc3984e11eb3b25,"Make upgradeSSTables skip current version sstables by default

patch by slebresne; reviewed by jbellis for CASSANDRA-5366","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-536
e580ef10472a52c1e96c153a8e93c7164812d563,"Optimize min/max timestamp collection

patch by slebresne; reviewed by jbellis for CASSANDRA-5373",['ColumnFamilyStore.java'],CASSANDRA-53
193e56607bc26d8cbba404fd4197ec279bc073b8,"Fix validation for IN where clauses with collection

patch by slebresne; reviewed by iamaleksey for CASSANDRA-5376",['SelectStatement.java'],CASSANDRA-53
6de0495e53adef564141eeb312d7e61e951a9ebc,"Fix the fat client.
Patch by Carl Yeksigian, reviewed by brandonwilliams for CASSANDRA-5378","['SelectStatement.java', 'StorageService.java']",CASSANDRA-5378
338fa9a30747d18befc0ff66b5cb5265f7bb65f1,"Fix fat client.
Patch by Carl Yeksigian, reviewed by brandonwilliams for CASSANDRA-5378","['SelectStatement.java', 'StorageService.java']",CASSANDRA-5378
aa76394764bcb4af54150f12528fed9ddfa66044,"Merge ColumnFamily, ISortedColumns.  Add EmptyColumns and UnsortedColumns; clean up TMBSC, ABSC, and ASC
patch by jbellis; reviewed by Carl Yeksigian for CASSANDRA-5403","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-5403
e306a87b7d8e1ef15a5269006d7706a4c97d1798,"fix regression when requested range does not overlap an sstable at all
patch by marcuse; reviewed by jbellis for CASSANDRA-5407",['SSTableReader.java'],CASSANDRA-5407
a950b9257f4c92d067eb5e1d437096699123ac9b,"Support indexes on composite column components

patch by slebresne; reviewed by iamaleksey for CASSANDRA-5125","['SelectStatement.java', 'ColumnFamilyStore.java']",CASSANDRA-512
a7b2ff65ac1946ca8e7e52e00374a83ebe922627,"Fix TimeoutException when there is a firewall issue.
patch by Vijay; reviewed by jbellis for CASSANDRA-3533","['MessagingService.java', 'StorageService.java']",CASSANDRA-3533
1533f124c12257bcb17bfdf0d9096c239ac78fe8,"Add nodetool methods to disable/enable native transport.
Patch by Michal Michalski, reviewed by brandonwilliams for
CASSANDRA-5425","['CassandraDaemon.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-5425
75d5639014a4680f2a734b4ec9b452ed0cfff058,"Leveled compaction performs size-tiered compactions in L0
patch by tjake and jbellis for CASSANDRA-5371","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-5371
ebefb77c6e8a5046a8c1b1bb0edd258aaf0ad8b7,"Add an official way to disable autocompaction.

patch by marcuse, reviewed by pcmanus for CASSANDRA-5074","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-507
87b350ff777983cdd2f4136c5b649c8dfb11b685,"Include fatal errors in trace events
patch by jbellis; reviewed by aleksey for CASSANDRA-5447",['CassandraDaemon.java'],CASSANDRA-5447
38fdcd1986d5b8f5bfb9a78cd68b837342ec1d32,"Include fatal errors in trace events
patch by jbellis; reviewed by aleksey for CASSANDRA-5447",['CassandraDaemon.java'],CASSANDRA-5447
feae9efa42a3395fce2447e97258ffdbe19d31cb,"Fix trying to load deleted row into row cache on startup
patch by jbellis; reviewed by dbrosius for CASSANDRA-4463",['ColumnFamilyStore.java'],CASSANDRA-4463
576efcd8121e70e7d550fdce9432be43690a4b1d,"Fix TimeoutException when there is a firewall issue.
patch by Vijay; reviewed by jbellis for CASSANDRA-3533","['MessagingService.java', 'StorageService.java']",CASSANDRA-3533
8b0e1868e8cf813ddfc98d11448aa2ad363eccc1,"initial CAS support
patch by jbellis and slebresne for CASSANDRA-5062","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-5062
0c7141ee8afa05d46680ec22635a5bf41f827b75,"remove PBSPredictor
patch by jbellis; reviewed by marcuse for CASSANDRA-5455","['MessagingService.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-5455
798470e051af794b605cce28031b33b589cfc6d8,"Always record row-level tombstones in index component
patch by jbellis; reviewed by jasobrown for CASSANDRA-5487",['SSTableReader.java'],CASSANDRA-5487
d7a09825025374b6a49a250467039dc15f36d053,"Always record row-level tombstones in index component; this time from the correct feature branch
patch by jbellis; reviewed by jasobrown for CASSANDRA-5487",['SSTableReader.java'],CASSANDRA-5487
debd8f0176038f6933978eb9b4f8ee6adc07b541,Fix primary range ignores replication strategy patch by yukim; reviewed by jbellis for CASSANDRA-5424,['StorageService.java'],CASSANDRA-5424
a6edfa56962c55d7a84eea31fe8fec7c29454f83,"Fix shutdown of binary protocol server

patch by slebresne; reviewed by iamaleksey for CASSANDRA-5507",['StorageService.java'],CASSANDRA-550
68444f9b2f573425bdd38b378e14cd6a8c16821c,Fix repair -snapshot not working patch by yukim; reviewed by jbellis for CASSANDRA-5512,['MessagingService.java'],CASSANDRA-5512
7f2c3a8e40f97c626def5c510d77c1da3d9ae926,"Removed compatibility with pre-1.2.5 sstables and network messages
patch by jbellis; reviewed by marcuse for CASSANDRA-5511","['DatabaseDescriptor.java', 'SelectStatement.java', 'SSTableReader.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-5511
9851b73fc3bbaf61ec80b54c64483bcf56aaa396,"Reduce memory consumption of IndexSummary
patch by jbellis; reviewed by vijay for CASSANDRA-5506",['SSTableReader.java'],CASSANDRA-5506
1227751661e653fb39be1ada369a9eda8f1e9d7f,"add read support for CL.SERIAL
patch by jbellis; reviewed by slebresne for CASSANDRA-5441",['StorageProxy.java'],CASSANDRA-5441
2b0797b24e2d4a433c0e17506a0d8bb812f8f2dd,"fix compaction throttling bursty-ness
patch by yukim and jbellis for CASSANDRA-4316","['CompactionManager.java', 'SSTableReader.java']",CASSANDRA-4316
e26b726ccbc140f3971ce24371bd555db497e94e,"Removed token range bisection
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-5518","['MessagingService.java', 'StorageService.java']",CASSANDRA-5518
c33ccd9e38cae018022bec16e66489428bfc8912,"move IndexSummary off heap
patch by Vijay; reviewed by jbellis for CASSANDRA-5521",['SSTableReader.java'],CASSANDRA-5521
bdf08364a60d9b05d0b45cb47ddd73adb08b4196,"Improve Dsnitch Severity with iowait monitor
patch by Vijay; reviewed by jbellis for CASSANDRA-5521",['StorageService.java'],CASSANDRA-5521
3c06ff0a8ee64742416c4b8a5ec083ea5a390e34,"reduce unused empty map creation in the local writes (sendToHintedEndpoints) case
patch by dbrosius reviewed by jbellis for CASSANDRA-5538",['StorageProxy.java'],CASSANDRA-5538
08df0b8604cd34c4f1fb384f9f6eaba86203d116,"Add alias support to SELECT statement

patch by Aleksey Yeschenko; reviewed by Sylvain Lebresne for
CASSANDRA-5075",['SelectStatement.java'],CASSANDRA-507
a9bd531bc9a286cc8e81a800aaa29c1fead62dcd,"Single-pass compaction
patch by jbellis; reviewed by marcuse for CASSANDRA-4180","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-4180
2effc40edb798fc3e39b0511b5be39e6d0738f59,"replace Thread.sleep with Uninterruptibles.sleepUninterruptibly
patch by Mikhail Mazursky; reviewed by jbellis for CASSANDRA-5557","['ColumnFamilyStore.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-5557
56927973fea9112a5d3aa704e82af45af457772c,"add nodetool enablebackup/disablebackup
patch by pmargolin reviewed by dbrosius for CASSANDRA-5556",['NodeProbe.java'],CASSANDRA-5556
740e344c7fc1ee0283744fefd659db999b48c71f,"Ensure that submitBackground enqueues at least one task
patch by Oleg Anastasyev; reviewed by jbellis for CASSANDRA-5554",['CompactionManager.java'],CASSANDRA-5554
3b41d21d9b997530e48511e1d09ea904e8937bf0,"Ensure that submitBackground enqueues at least one task
patch by Oleg Anastasyev; reviewed by jbellis for CASSANDRA-5554",['CompactionManager.java'],CASSANDRA-5554
8b96334a0c107216604d85d59ff50b1edbec89fa,Check only SSTables for the requested range when streaming patch by Rick Branson; reviewed by yukim for CASSANDRA-5569,['ColumnFamilyStore.java'],CASSANDRA-5569
72a6cff6e883320a6ceec88e41b42ca15dff1e2e,"Cassandra Triggers!
patch by Vijay; reviewed by Jonathan Ellis for CASSANDRA-1311",['StorageProxy.java'],CASSANDRA-1311
1d2c12242f20dfcc0b787129b4ad8eeef2768d6b,"use nanotime consistently for node-local timeouts
patch by Mikhail Mazursky; reviewed by jbellis for CASSANDRA-5581","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-5581
ac19c121524c928ff6f3237e12a26e42766ae836,"Remove buggy thrift max message length option
patch by jbellis; reviewed by tjake for CASSANDRA-5529","['Config.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-5529
9879fa6122d325951d98f8bc601ff64dd04c2c67,"Remove buggy thrift max message length option
patch by jbellis; reviewed by tjake for CASSANDRA-5529","['Config.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-5529
3a51ccf2d12a5fcfaa1378eff0209526c9a33278,"Improve batchlog replay behavior and hint ttl handling

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-5314",['StorageProxy.java'],CASSANDRA-531
bf28e8d4b84afd5f9821ad965274768b8d4ca179,"Move System.exit on OOM into a separate thread
patch by jbellis; reviewed by marcuse for CASSANDRA-5273",['CassandraDaemon.java'],CASSANDRA-5273
a3734e54bc9032dedad5d44394cca8dc7e400a43,"remove on-heap row cache

Removed on-heap row cache
patch by jbellis; reviewed by jasobrown for CASSANDRA-5348","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-53
b70639187e1ee5e3aebb489baa07aaa2771fb4ed,"Ignore pre-truncate hints
patch by Alexey Zotov and jbellis; reviewed by vijay for CASSANDRA-4655","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-4655
c4c9626f8b3ba941aa51860a7d10a6e686362f85,"Ignore pre-truncate hints
patch by Alexey Zotov and jbellis; reviewed by vijay for CASSANDRA-4655","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-4655
0ad499e9a82afa23f17672e25678d065b421e0d8,"Track max/min column names in sstables to be able to optimize slice queries.

Patch by marcuse and jbellis, reviewed by jbellis for CASSANDRA-5514",['CompactionManager.java'],CASSANDRA-5514
bc3597d3549850997fd137cc8b74700c62cebf64,"Add support for specifying CAS commit ConsistencyLevel
patch by jbellis; reviewed by aleksey for CASSANDRA-5442",['StorageProxy.java'],CASSANDRA-5442
524261f88cd2adcd623de3604e735b282dd5caac,"Allow preparing timestamp, ttl and limit in queries

patch by slebresne; reviewed by iamaleksey for CASSANDRA-4450",['SelectStatement.java'],CASSANDRA-44
843dc796ea5e80b003f6429a329ec04a9f1bfff4,"Add get commands for compaction/streaming throughput to nodetool.
Patch by Michal Michalski, reviewed by brandonwilliams for
CASSANDRA-5588",['NodeProbe.java'],CASSANDRA-5588
22be25b89c22f3a77a73b20ce1b819b257914d20,"initialize memoryAllocator in client mode as well
patch by yukim; reviewed by jbellis for CASSANDRA-5542",['DatabaseDescriptor.java'],CASSANDRA-5542
d0dc597261b0b9949ecd26150cd30ef89ecc7a21,"send dc-local replicas inline instead of putting them in a Map
patch by jbellis; reviewed by dbrosius for CASSANDRA-5538",['StorageProxy.java'],CASSANDRA-5538
079ae68fb7086259439491e6a10bc2d8a947f52c,"Reduce SSTableLoader memory usage
patch by jbellis; reviewed by dbrosius for CASSANDRA-5555","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-5555
e301c38d3a592ff943ea0703403542dd2b7f499d,"More detailed read repair metrics.
Patch by Jingsi Zhu, reviewed by brandonwilliams for CASSANDRA-5618","['StorageProxy.java', 'NodeProbe.java']",CASSANDRA-5618
6193fefbf7d92c0b909dccf5a2519b9266983091,"More detailed read repair metrics.
Patch by Jingsi Zhu, reviewed by brandonwilliams for CASSANDRA-5618","['StorageProxy.java', 'NodeProbe.java']",CASSANDRA-5618
b4b30cf87cbf3f7957c64f625f0f90d24b43b49c,"More detailed read repair metrics.
Patch by Jingsi Zhu, reviewed by brandonwilliams for CASSANDRA-5618",['StorageProxy.java'],CASSANDRA-5618
082684dd806a0bf0964901e3749992e4b1a1d650,"retain initial cause exceptions for internode encryption issues in MessagingService
patch by hmetske reviewed by dbrosius for CASSANDRA-5644",['MessagingService.java'],CASSANDRA-5644
0c81eaecb2572d9c70e033aa2c76288611386d8f,"improve tracing
patch by jbellis; reviewed by slebresne for CASSANDRA-5638",['StorageProxy.java'],CASSANDRA-5638
1f7628ce7c1b3f820717eaa44df9b182158eb49e,"Include a timestamp with all read commands to determine column expiration

patch by Aleksey Yeschenko; reviewed by Sylvain Lebresne for
CASSANDRA-5149","['SelectStatement.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageProxy.java']",CASSANDRA-514
b1d7405fd1263a04d8cc4bbfcba3ec1928b75738,"Fix cross-DC mutation forwarding
patch by jbellis; reviewed by dbrosius for CASSANDRA-5632",['StorageProxy.java'],CASSANDRA-5632
9ba0ff03e211554df6b01fd860159cc74bf95026,"simplify initClient gossip loop
patch by Adrian Nistor and jbellis for CASSANDRA-5662",['StorageService.java'],CASSANDRA-5662
0ba5cf12b9e1b7558ccf0c3a8bbd663f028024ce,"Return current values on failed CAS

patch by slebresne; reviewed by jbellis for CASSANDRA-5619","['SelectStatement.java', 'StorageProxy.java']",CASSANDRA-5619
fbe8a6eb213ee3558be701c73c31a0da79446657,"Fix tracing when operation completesbefore all responses arrive
patch by jbellis; reviewed by slebresne for CASSANDRA-5668",['MessagingService.java'],CASSANDRA-5668
15df6691caf9e681727338d66d8f8b0d42843177,"Tracing cleanup
patch by Mikhail Mazursky; reviewed by jbellis for CASSANDRA-5625","['MessagingService.java', 'StorageService.java']",CASSANDRA-5625
e48ff29387547c0837ab381f6e890f8417a1b65c,"Add auto paging capability to the native protocol

This also generalize the paging used internally, and pages CQL3 'select
count' operation to avoid OOM.

patch by slebresne; reviewed by iamaleksey for CASSANDRA-4415","['SelectStatement.java', 'ColumnFamilyStore.java', 'SSTableReader.java', 'MessagingService.java', 'StorageProxy.java']",CASSANDRA-44
eb4fa4a621db43ad9d48b146ee16caf09db7a853,"Redesign repair messages

patch by yukim; reviewed by slebresne for CASSANDRA-5426","['CompactionManager.java', 'MessagingService.java', 'StorageService.java']",CASSANDRA-542
c432e673377d0b4b8f265fdb2e90fa7c77745260,"Convert speculative retry from milli second to micro second.
patch by Vijay; reviewed by slebresne for CASSANDRA-5014",['ColumnFamilyStore.java'],CASSANDRA-5014
40f0bdce069db14e912f28d7351c4b602389c6a5,"avoid starting exitThread multiple times
patch by jbellis for CASSANDRA-5716",['CassandraDaemon.java'],CASSANDRA-5716
dad2f11aa660de36896859ca27b454cce26b4590,"Move resultset type information into prepare, not execute

patch by slebresne; reviewed by iamaleksey for CASSANDRA-5649",['SelectStatement.java'],CASSANDRA-564
bfe1e1cef71baa6dc2a4bccbe0848f06f52474ec,Followup to CASSANDRA-5619,['StorageProxy.java'],CASSANDRA-5619
8e003d842619bfce3585761684e7ba4114be89db,"use max(current time from system clock, inProgress + 1) as CAS ballot
patch by jbellis; reviewed by slebresne for CASSANDRA-5667",['StorageProxy.java'],CASSANDRA-5667
83b75754ff143d4d77b01ef76a813da47779c6f4,"Don't keep ancestor information in memory since it is only used on startup.

patch by marcuse, reviewed by jbellis for CASSANDRA-5342",['SSTableReader.java'],CASSANDRA-53
e9c674242b617588651ecbb79669e97a612cd25b,"Don't tie client side use of AbstractType to JDBC

patch by carlyeks; reviewed by ardot for CASSANDRA-4495",['SelectStatement.java'],CASSANDRA-44
2de07250d1235a4e9e7fac0ac1a2a45784d2a3ab,"use index interval from index summary
patch by yukim; reviewed by jbellis for CASSANDRA-5731",['SSTableReader.java'],CASSANDRA-5731
39a38e675987d3bcb99a7d2cd8d5e606de6b56f1,"Add timeout events to query traces
patch by Tyler Hobbs; reviewed by jbellis for CASSANDRA-5520",['StorageProxy.java'],CASSANDRA-5520
ba6396a20c642108447c0c9820e2585ed6f6adb0,"Add replace_token functionality for vnodes.
Patch by brandonwilliams reviewed by jasobrown for CASSANDRA-5337","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-5337
4f0d7b456a2ba14f9b63e41982daa7868cc82e63,"Fix assertion error during repair

patch by slebresne; reviewed by yukim for CASSANDRA-5757",['SSTableReader.java'],CASSANDRA-575
d881024eeff2406809732c7a24016e02ab129d34,fix bulkloader patch by yukim reviewed by slebresne for CASSANDRA-5542,['StorageService.java'],CASSANDRA-5542
2188d6472d87b9320f913ead3bf608d8170c2f6a,"reduce memory used by sstr during bulk load
patch by Tyler Hobbs and jbellis for CASSANDRA-5555","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-5555
06939dda2cb307fe5489c9b7ca83ebc259f6cee2,"Replace countPendingHints with HintsCreated metric
patch by Tyler Hobbs; reviewed by jbellis for CASSANDRA-5746",['StorageProxy.java'],CASSANDRA-5746
76ad645a3a8591dd7d5062dc97e2590631bf5970,"When all seeds are unreachable don't bootstrap into a standalone
cluster.
Patch by brandonwilliams, reviewed by jasobrown for CASSANDRA-5768",['StorageService.java'],CASSANDRA-5768
57769f6bb511282d7d9918f5cceabe7dbb6e8dcc,"Fix bugs in the native protocol v2

patch by slebresne; reviewed by iamaleksey for CASSANDRA-5770",['SelectStatement.java'],CASSANDRA-577
fbe63ab3d9d71107261126616fce4199fdd61e36,"StorageProxy#cas() doesn't order columns names correctly when querying

patch by slebresne; reviewed by jbellis for CASSANDRA-5788",['StorageProxy.java'],CASSANDRA-578
bfd73beaf1554370eb23897a403991b3e2467dd1,"DC-local CAS

patch by slebresne; reviewed by jbellis for CASSANDRA-5797","['SelectStatement.java', 'StorageProxy.java']",CASSANDRA-579
ab8a28e365da8ef515a40e838e773d67ad92a282,"fix bulk-loading compressed sstables
patch by Tyler Hobbs and yukim; reviewed by jbellis for CASSANDRA-5820",['SSTableReader.java'],CASSANDRA-5820
94d7cb411b21c1a8a4d7c3d375dfd09f4dc3f885,"Allow compacting 2Is via nodetool
patch by jasobrown; reviewed by jbellis for CASSANDRA-5670",['StorageService.java'],CASSANDRA-5670
4b4ccc3ccfcc7be8fad0b25bde9a180f0016d520,"fix CAS contention timeout
patch by Soumava Ghosh; reviewed by jbellis for CASSANDRA-5830",['StorageProxy.java'],CASSANDRA-5830
ccb32a8c8d6bd5d25ad6db172f7cd6ead00fdfaa,"Make SS look at the right piece for expire time.
Patch by brandonwilliams reviewed by jasobrown for CASSANDRA-5857",['StorageService.java'],CASSANDRA-5857
703bd684ca79f817392acfed5c26ad0871660735,"Fix (some) 2i on composite components omissions

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-5851",['SelectStatement.java'],CASSANDRA-585
a0d6ed1290540673b0336418cbca0dd2f07e64a8,"Improve JMX support for streaming

patch by yukim; reviewed by thobbs for CASSANDRA-5859",['NodeProbe.java'],CASSANDRA-585
9e846d9ff69f825f6200f7f75fdfc53926bfc255,"Use a range aware scanner for cleanup to improve performance.

Patch by thobbs, stuhood and marcuse, reviewed by marcuse for CASSANDRA-2524","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-2524
bc12d73a5a0f31ab8258b3d2a35063b5750df91c,"Cleanup doesn't need to inspect sstables that contain only local data
patch by Tyler Hobbs; reviewed by jbellis for CASSANDRA-5722","['CompactionManager.java', 'SSTableReader.java']",CASSANDRA-5722
3529ac711e5588918afcc8b514aa03c67a9adac7,"Handle CQL3 SELECT duplicate IN restrictions on clustering columns

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-5856",['SelectStatement.java'],CASSANDRA-585
bc98886d4bbb15eec28f2e8f059dddbd47999985,"Fix getBloomFilterDiskSpaceUsed for AlwaysPresentFilter
patch by jbellis; reviewed by yukim for CASSANDRA-5900",['SSTableReader.java'],CASSANDRA-5900
b0280cb92d6d0ee5e89d54d2277ba846172de61e,"Fix periodic memtable flushing behavior with clean memtables

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-5931",['ColumnFamilyStore.java'],CASSANDRA-593
f5c9b4a8b9a7cabfd99e1f9b3978498a6bd55c39,"Fix SSTable unintentionally loads BF in batch mode

patch by yukim; reviewed by jbellis for CASSANDRA-5938",['SSTableReader.java'],CASSANDRA-593
4b805adc54007498d7ddd63ce0de43bfe126675f,"Allow disabling SlabAllocator
patch by jbellis; reviewed by jasobrown for CASSANDRA-5935","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-5935
a4dd7aa39277c6c7426b9e05e2d3676bc428692a,"Make user-defined compactionJMX blocking
patch by jbellis; reviewed by Michael Harris for CASSANDRA-4952",['CompactionManager.java'],CASSANDRA-4952
db381eaa0823e2d36bec664722fd17714efeecc8,"use sstable partitioner for SSTableScanner
patch by jbellis; reviewed by Aleksey Yeschenko for CASSANDRA-2524",['ColumnFamilyStore.java'],CASSANDRA-2524
254d315d52e0d442212b4a3840ae225dcb4086e2,"Add snitch, schema version, cluster, partitioner to JMX
patch by Lyuben Todorov; reviewed by Jeremiah Jordan for CASSANDRA-5881","['StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-5881
bffd9ea8eb5358b5f138cbad8a387d5037d1ac12,"Upgrade Thrift to 0.9.1

patch by Carl Yeksigian and Jake Farrell; reviewed by Aleksey Yeschenko
for CASSANDRA-5923","['StorageProxy.java', 'StorageService.java']",CASSANDRA-592
3205e5dbbc8fb8f365b72137cf1c1ea50f15cab6,Revert CASSANDRA-5838,"['ColumnFamilyStore.java', 'CompactionManager.java', 'MessagingService.java', 'StorageProxy.java']",CASSANDRA-5838
3380fa7baf76998b7c2fdbcb85b23fa3f0099f7c,"Allow local batchlog writes for CL.ANY
patch by jbellis; reviewed by Aleksey for CASSANDRA-5967",['StorageProxy.java'],CASSANDRA-5967
4e52e0d2add1358c5d80bf9bf805a987dfb4dc5d,"Stop using Thrift-generated Index* classes internally

patch by Aleksey Yeschenko; reviewed by Dave Brosius for CASSANDRA-5971","['SelectStatement.java', 'ColumnFamilyStore.java']",CASSANDRA-597
04cd81cdbb16e4f64b950325b581c6ba573b14a8,"fix re-propose of earlier, incomplete paxos round to use new ballot
patch by jbellis; reviewed by slebresne for CASSANDRA-5985",['StorageProxy.java'],CASSANDRA-5985
4f5242cfbfb302e8099cb514ea78f134fef84d45,"Remove 1.2 network compatibility code

patch by Aleksey Yeschenko; reviewed by Sylvain Lebresne for
CASSANDRA-5960",['StorageProxy.java'],CASSANDRA-596
caef32e5d67c3b093de53bf99479cd457169178c,"Correctly handle limits in CompositesSearcher

patch by Aleksey Yeschenko; reviewed by Sylvain Lebresne for
CASSANDRA-5975",['ColumnFamilyStore.java'],CASSANDRA-597
e546e33872426be0db084b2eee1f9ffac0994772,"Remove old json leveled manifest migration code.

Patch by marcuse, reviewed by jbellis for CASSANDRA-5996","['ColumnFamilyStore.java', 'CassandraDaemon.java']",CASSANDRA-599
50c9d77e1b2be206a765e7f86cd4b8ecf3d232df,"Fix paxos not always replaying when it should

patch by slebresne; reviewed by jbellis for CASSANDRA-6012",['StorageProxy.java'],CASSANDRA-601
806a45225bb5fdfd5f21cbc90456dc9dbe7c4461,"Fix snapshots in use get deleted during snapshot repair

patch by yukim; reviewed by jbellis for CASSANDRA-6011",['CompactionManager.java'],CASSANDRA-601
0e18f23c5cb7080b3bbaee15b87001b323fd1c29,"Move hints and exception count to o.a.c.metrics

patch by yukim; reviewed by jbellis for CASSANDRA-6017","['CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-601
08c07f5f323a30926fdb760a01b7ef993693153c,"Fix NPE in nodetool on booting instances.
Patch by Mikhail Stepura, reviewed by brandonwilliams for CASSANDRA-5968",['StorageService.java'],CASSANDRA-5968
6ec4eef2b0d7c7ef235299d47016dd64ff2ace04,"CAS may return false but still commit the insert

patch by slebresne; reviewed by jbellis for CASSANDRA-6013",['StorageProxy.java'],CASSANDRA-601
dfe49376097cf73c04c0d8506782263a2e820cb0,"add file_cache_size_in_mb setting
patch by pyaskevich and jbellis for CASSANDRA-5661","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-5661
7161aec42c5bdb9e007587e20bc71603a505a95d,"Avoid second-guessing out-of-space state
patch by jbellis; reviewed by yukim for CASSANDRA-5605",['CompactionManager.java'],CASSANDRA-5605
9d7bb1e0c27fd5076afc750150ab4b86f228efb5,"Fix memory leak in snapshot repair

patch by yukim; reviewed by jbellis for CASSANDRA-6047","['CompactionManager.java', 'SSTableReader.java']",CASSANDRA-604
37e9bce381b9daf8e544db475e1a31d70e471e7b,"Support named bind variables in CQL

patch by slebresne; reviewed by iamaleksey for CASSANDRA-6033",['SelectStatement.java'],CASSANDRA-603
df046d6b4262c3a879b60d1b6f082aea792e09a0,"Allow cache-keys-to-save to be set at runtime
patch by Chris Burroughs; reviewed by jbellis for CASSANDRA-5980","['DatabaseDescriptor.java', 'NodeProbe.java']",CASSANDRA-5980
72be2a4360caa0f9c315097bbd5d9199a032821c,"improve memory use and timeout defaults
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-6059","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-6059
5a7cc11f29c69265d6302a54690476b7ef2de61a,"use non-pooling readers with openForBatch
patch by jbellis; reviewed by yukim for CASSANDRA-6067",['SSTableReader.java'],CASSANDRA-6067
2267c20942feb486fbbf1bd54d7a0fbbe468ae10,"Add tombstone debug threshold and histogram
patch by Russell Spitzer and Lyuben Todorov; reviewed by jbellis for CASSANDRA-6042 and CASSANDRA-6057","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-6042
3448ca57f3714521b5b7fc88fac43e31d0adcafa,"Enable tcp keepalive on incoming connections.

Patch by marcuse, reviewed by jbellis for CASSANDRA-4053",['MessagingService.java'],CASSANDRA-405
38ae1beef6cbe42447bfc0c113e0f39b1442ca73,"Send correct metadata on SELECT COUNT

patch by slebresne; reviewed by iamaleksey for CASSANDRA-6080",['SelectStatement.java'],CASSANDRA-608
bb3ec4ce9ec020d0bf7963517f802c2b86e9047a,"Avoid sending Truncate command to fat clients
patch by Oleg Anastasyev; reviewed by jbellis for CASSANDRA-6088",['StorageProxy.java'],CASSANDRA-6088
1b79d6ed4f19752369a0345ae8d611ec107746d5,"Start MeteredFlusher earlier to prevent OOM during CL replay
patch by Oleg Anastasyev; reviewed by jbellis for CASSANDRA-7078",['CassandraDaemon.java'],CASSANDRA-7078
546485310e20dd2c6c67f863cba4b5acd1bae586,"Start MeteredFlusher earlier to prevent OOM during CL replay
patch by Oleg Anastasyev; reviewed by jbellis for CASSANDRA-7078",['CassandraDaemon.java'],CASSANDRA-7078
25926d0946ff04243dab6876dcdd76b05c57e472,"Throw an error when listen_address is 0.0.0.0
Patch by brandonwilliams, reviewed by dbrosius for CASSANDRA-5865",['DatabaseDescriptor.java'],CASSANDRA-5865
20c419b9480e0e5b3c1da53a106b2a6760be35b9,"Fixes for speculative retry
patch by ayeschenko and jbellis for CASSANDRA-5932",['StorageProxy.java'],CASSANDRA-5932
c8915cea4ba58174208c083b145fecaf93c7e69a,"Track and persist sstable read activity
patch by Tyler Hobbs; reviewed by jbellis for CASSANDRA-5515",['SSTableReader.java'],CASSANDRA-5515
dc7221f0bfd44dfb70d0f9256c9cb1fe91462c50,"warn, then drop queries exceeding a configurable number of tombstones
patch by jbellis; reviewed by slebresne for CASSANDRA-6117","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-6117
32c3f44a684a1208bf9d43c18079ba45aa8e2fa6,"Add configurable metrics reporting
patch by Chris Burroughs; reviewed by Tyler Hobbs for CASSANDRA-4430",['CassandraDaemon.java'],CASSANDRA-4430
88944ffcd85ae59fc92202a5a547b3c65efa03f0,"Allow alter keyspace on system_traces

patch by yukim; reviewed by jbellis for CASSANDRA-6016","['DatabaseDescriptor.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-601
cf38e9e6f96e692909e7669c053e372a638605e7,Revert CASSANDRA-6132 (pushing to 2.0 only),"['DatabaseDescriptor.java', 'MessagingService.java', 'StorageProxy.java']",CASSANDRA-6132
a28b4300c53dfcb8b5a23b0b0295252e0788ee21,"Parallelize fetching rows for low-cardinality indexes
patch by thobbs; reviewed by jbellis for CASSANDRA-1337",['StorageProxy.java'],CASSANDRA-1337
a2b12784fe3785fe96d9c0e2d7e8c72bfc88ac7c,"Save compaction history to system keyspace

patch by lantao yan; reviewed by yukim for CASSANDRA-5078","['CompactionManager.java', 'NodeProbe.java']",CASSANDRA-507
53f7c328ae4aca0affaed4f0c73678011a4e152a,"fix merge from #6132
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-6154","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-6154
99b40fd005a9250ff8d255cc9c22ff61e4d32587,"Update sstablesPerReadHistogram to use biased sampling
patch by jbellis; reviewed by yukim for CASSANDRA-6164",['ColumnFamilyStore.java'],CASSANDRA-6164
111c74ef94d4d75c19611ca3e77d7c54552810f0,"rewrite sendRR API to fix regressions from #6132
patch by jbellis; reviewed by brandonwilliams for CASSANDRA-6165","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-6165
fbe19b8ad7cd01f810109731b64acaaa4edf8db2,"Handle JMX notification failure for repair

patch by yukim; reviewed by pcmanus for CASSANDRA-6097",['NodeProbe.java'],CASSANDRA-609
95ac0de7a7aafb9e9661ce87f04b4302e6c5e3be,fix assert for counters (CASSANDRA-6175),['MessagingService.java'],CASSANDRA-6175
7290abd198d6c63f1109094cf237d9c84f617f7d,"Avoid using row cache on 2i CFs
patch by Sam Tunnicliffe and jbellis for CASSANDRA-5732",['ColumnFamilyStore.java'],CASSANDRA-5732
d6d35ba31e193cfd6f73019c3dbe97670f782e61,"Allow log4j-server.properties to be a symlink.
Patch by brandonwilliams, reviewed by iamaleksey for CASSANDRA-6170",['CassandraDaemon.java'],CASSANDRA-6170
351d43ef120a725cf83d29f80fd243ad9fc30fc2,"Rework node replacement.
Patch by brandonwilliams, reviewed by Tyle Hobbs for CASSANDRA-5916","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-5916
4a382ff4565f6c85e36587683051257e1abb590d,"Remove dead node from system.peers when replacing.
Patch by brandonwilliams, reviewed by Jeremiah Jordan for CASSANDRA-6217",['StorageService.java'],CASSANDRA-6217
558483dd20439d1bc74dec6ebed0b4632ef5a1ca,"Remove dead node from system.peers when replacing.
Patch by brandonwilliams, reviewed by Jeremiah Jordan for CASSANDRA-6217",['StorageService.java'],CASSANDRA-6217
7159ec10046fd4dce58ca9406ef096fdb965700d,"Fix SSTableLoader

patch by thobbs; reviewed by slebresne for CASSANDRA-6205",['SSTableReader.java'],CASSANDRA-620
4155afd510828770c2d666a7e4cea28062964130,"Reject bootstrapping endpoints that are already in the ring with
different gossip data
Patch by Tyler Hobbs, reviewed by brandonwilliams for CASSANDRA-5571",['StorageService.java'],CASSANDRA-5571
5eddf185465a0e2dde18df179faefb9a68fba29a,"Add beforeChange notification to IEndpointStateChangeSubscriber
Patch by Sergio Bossa, reviewed by brandonwilliams for CASSANDRA-6135",['StorageService.java'],CASSANDRA-6135
786672edb6b4156e69bb3daecb9bcca0cba7db21,"Compact hottest sstables first and optionally omit coldest
patch by Tyler Hobbs; reviewed by jbellis for CASSANDRA-6109",['SSTableReader.java'],CASSANDRA-6109
37285304ee484122410c977399024f2af132753c,"Compact hottest sstables first and optionally omit coldest
patch by Tyler Hobbs; reviewed by jbellis for CASSANDRA-6109",['SSTableReader.java'],CASSANDRA-6109
36cdf34bd92ede5ad99447e10d90e6caa1fd743a,"Remove multithreaded compaction and PCR
patch by jbellis; reviewed by marcuse for CASSANDRA-6142","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java']",CASSANDRA-6142
620bb80eccda228573e0c8f821d766c16f89d2ea,"restrict max_num_tokens to 1536
patch by jbellis; reviewed by brandonwilliams and Quentin Conner for CASSANDRA-6267",['DatabaseDescriptor.java'],CASSANDRA-6267
5f5905d51561b2adb616a9b1b0b29f1358372ba4,"Remove CFDefinition

patch by slebresne; reviewed by iamaleksey for CASSANDRA-6253","['SelectStatement.java', 'SelectStatement.java', 'StorageProxy.java']",CASSANDRA-625
18f7935370b1628cba8fa35819c05f235ba918aa,"Use non-pooled SegmentedFile builders when bulk loading
Patch by Sam Tunnicliffe, reviewed by brandonwilliams for CASSANDRA-6272",['SSTableReader.java'],CASSANDRA-6272
144ee9a2164c445f3d08d590ab99de5d8b059796,"Fixups for CFDefinition removal refactoring

patch by dbrosius; reviewed by slebresne for CASSANDRA-6253","['SelectStatement.java', 'ColumnFamilyStore.java']",CASSANDRA-625
ce206e20142024dbeff9ed68cb0ff4aeb4aaf0b8,"use StandardCharsets static fields
patch by Blair Zajac; reviewed by jbellis for CASSANDRA-6290",['StorageService.java'],CASSANDRA-6290
c28fe781606f92e0e3005a3901ff97f0c8633e9a,"Make calculatePendingRanges asynchronous
Patch by Ryan Fowler, reviewed by brandonwilliams for CASSANDRA-6244",['StorageService.java'],CASSANDRA-6244
1475d92547f0404c6a347a1c7333fa8bdbfb220a,"Make calculatePendingRange asynchronous
Patch by Ryan Fowler, reviewed by brandonwilliams for CASSANDRA-6244",['StorageService.java'],CASSANDRA-6244
8c2404493a6efc109cd621c02a4de6ef1f1f46aa,"Fix potential socket leak in connectionpool creation
patch by Minh Do; reviewed by jbellis for CASSANDRA-6308",['MessagingService.java'],CASSANDRA-6308
d37696ca74fdf2306e4d78d52ae1142768716be9,"Thrift socket listen backlog (Partial resolution)
patch by Nenad Merdanovic; reviewed by Vijay for CASSANDRA-6206","['Config.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-6206
f388c9d69b855f0c3b146864717a971034fd3dc5,"SSTable/SSTableReader cleanup

patch by yukim; reviewed by jbellis for CASSANDRA-6355","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-635
917bc05c9fe5397714025678e990160722807aa4,"Recover from IOException in accept() thread
patch by Mihial Stepura; reviewed by jbellis for CASSANDRA-6349",['MessagingService.java'],CASSANDRA-6349
67accea1a1f44319e0382d6894cac457eb4a372a,"free off-heap IndexSummary during bulk load
patch by Tyler Hobbs; reviewed by jbellis for CASSANDRA-6359",['SSTableReader.java'],CASSANDRA-6359
08167d6ac784274a48ff8428f3ef4f6e92cd8ab0,"Cancel read meter task when closing SSTR
patch by Tyler Hobbs; reviewed by jbellis for CASSANDRA-6358",['SSTableReader.java'],CASSANDRA-6358
2b1fb0ff4b49dc6f511dd7aa9996e1e103c223d7,"Invalidate row cache when dropping CF
patch by Fabien Rousseau; reviewed by jbellis for CASSANDRA-6351",['ColumnFamilyStore.java'],CASSANDRA-6351
1bad5ed9f7e159f93ffa68d27dc1b9e8674b4f8a,"close corrupt summary stream before trying to delete it
patch by Mikhail Stepura; reviewed by jbellis for CASSANDRA-6380",['SSTableReader.java'],CASSANDRA-6380
dbd1a727b7481a3dcd9867e3a6f7791c1095e12a,"allocate fixed index summary memory pool and resample cold index summaries to use less memory
patch by Tyler Hobbs; reviewed by jbellis for CASSANDRA-5519","['Config.java', 'DatabaseDescriptor.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-5519
e178ff45c0510c56257c26da2dc8d082ba301522,"add snapshot space used to cfstats
patch by Mikhail Stepura; reviewed by jbellis for CASSANDRA-6231","['ColumnFamilyStore.java', 'NodeProbe.java']",CASSANDRA-6231
a16fa77379d40c7b490f83bd9a07e2bf7d900c3b,"Improve gossip performance for typical messages
patch by jbellis; tested by Quentin Conner for CASSANDRA-6409",['StorageService.java'],CASSANDRA-6409
351d49b06bd6887447eecb149b3cdf1697ab41ac,"validate directory permissions on startup
Patch by Lyuben Todorov and Koray Sariteke; reviewed by Mikhail Stepura for CASSANDRA-5818",['CassandraDaemon.java'],CASSANDRA-5818
58bcdd493280252d69151361676e60ce8974736d,"Make flush single-pass when partition tombstones are present
patch by jbellis; reviewed by slebresne for CASSANDRA-6417",['ColumnFamilyStore.java'],CASSANDRA-6417
f065cbfe058a2b0bb58ed53602afe0f12942d525,"Allow specifying datacentersto participate in a repair
patch by Jimmy Mårdell; reviewed by Lyuben Todorov for CASSANDRA-6218","['StorageService.java', 'NodeProbe.java']",CASSANDRA-6218
22e18f5a348a911f89deed9f9984950de451d28a,"Multithreaded commitlog
patch by Benedict Elliot Smith; reviewed by jbellis for CASSANDRA-3578",['StorageService.java'],CASSANDRA-3578
86e949f321cb1ce3b0bc0c9ed387218cc8a2b7b9,"add describe_local_ring for Hadoop's benefit
patch by Piotr Kołaczkowski; reviewed by jbellis for CASSANDRA-6268",['StorageService.java'],CASSANDRA-6268
3edb62bf773617aeb3a348edc5667a6b0bad0ffe,"Fix row tombstones in larger-than-memory compactions
patch by thobbs; reviewed by jbellis for CASSANDRA-6008",['ColumnFamilyStore.java'],CASSANDRA-6008
74bf5aa16e7080360febca1745307a4d7ced32dc,"SSTable metadata(Stats.db) format change

patch by yukim; reviewed by thobbs for CASSANDRA-6356","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-635
4be9e6720d9f94a83aa42153c3e71ae1e557d2d9,"Improve batchlog write performance with vnodes

patch by Jonathan Ellis and Rick Branson; reviewed by Aleksey Yeschenko
for CASSANDRA-6488",['StorageProxy.java'],CASSANDRA-6488
829047af58fb1735b5d12b74f06ed0d4f04b2c0d,"caching all calls of cloneOnlyTokenMap is not correct since many callers mutate the result
patch by Aleksey Yeschenko; reviewed by jbellis for CASSANDRA-6488",['StorageProxy.java'],CASSANDRA-6488
362cc05352ec67e707e0ac790732e96a15e63f6b,"Push composites support in the storage engine

patch by slebresne; reviewed by benedict for CASSANDRA-5417","['SelectStatement.java', 'SelectStatement.java', 'ColumnFamilyStore.java', 'SSTableReader.java', 'StorageProxy.java']",CASSANDRA-541
53af91e650d3fd881df6e811f5d4c5e46a039119,"loop based on isClosed to accomodate SSL sockets
patch by Mikhail Stepura; reviewed by jbellis for CASSANDRA-6349",['MessagingService.java'],CASSANDRA-6349
38642c5b2c5e410da29f54b0918d7358c1592402,"Don't drop local mutations without a trace

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-6510","['DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-651
a4895c551fb31bea90111a960f2c51634950536c,"Don't allow null max_hint_window_in_ms
patch by Nate McCall; reviewed by jbellis for CASSANDRA-6419",['DatabaseDescriptor.java'],CASSANDRA-6419
142e13f34031167cae61991de468613d905eb76f,"add StorageService.stopDaemon
patch by Lyuben Todorov; reviewed by Tyler Hobbs for CASSANDRA-4268","['StorageService.java', 'NodeProbe.java']",CASSANDRA-4268
b5c9b498fec1b71bc51afb3e45f828f4014baaff,"Allow removing snapshots of no-longer-existing CFs
patch by Lyuben Todorov and Mikhail Stepura for CASSANDRA-6418",['ColumnFamilyStore.java'],CASSANDRA-6418
604e31b60998d5df349f8cc84d06bbae1391dc0e,"Allow truncating hints from nodetool.
Patch by Sankalp Kohli, reviewed by brandonwilliams for CASSANDRA-6158",['NodeProbe.java'],CASSANDRA-6158
4ed2234078c4d302c256332252a8ddd6ae345484,"Delete unfinished compaction sstables incrementally

patch by thobbs; reviewed by yukim for CASSANDRA-6086","['ColumnFamilyStore.java', 'CassandraDaemon.java']",CASSANDRA-608
2a7c20ea9111c05964400fe0a30e7b75ff719277,"Add ability to throttle batchlog replay

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-6550","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-65
ae0a1e0f5a88d66974582f383a942f6bf42b6ac5,"Verify that the keyspace exists in describeRing and print nicer error message in BulkLoader.

Patch by marcuse, reviewed by thobbs for CASSANDRA-6529",['StorageService.java'],CASSANDRA-65
0a1b277d659e20cd19eaedaa7220b0fc55950dc4,"CF id is now non-deterministic

and data dir/key cache are also unique per CF id.
patch by yukim; reviewed by Pavel Yaskevich for CASSANDRA-5202","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SSTableReader.java', 'CassandraDaemon.java']",CASSANDRA-520
de19f963aeed2752374d2f84c1b230f6cab253f1,"Wait for gossip to settle before accepting client connections
patch by Chris Burroughs; reviewed by Tyler Hobbs and jbellis for CASSANDRA-4288",['CassandraDaemon.java'],CASSANDRA-4288
892d8e699cf5ca3807da288bd08c73319c35c3b8,"refactor nodetool, encapsulating each command into a subclass
patch by Clément Lardeur; reviewed by Mikhail Stepura for CASSANDRA-6381",['NodeProbe.java'],CASSANDRA-6381
5977e7b6d61a9dab2a6e699b4cb75eb9d93cffc8,"Don't update system table for unknown nodes/dead states
Patch by Tyler Hobbs, reviewed by brandonwilliams for CASSANDRA-6053",['StorageService.java'],CASSANDRA-6053
c1c3d8f3f351a6834e5b02c12790d0d1163107bf,"Don't update system table for unknown nodes/dead states
Patch by Tyler Hobbs, reviewed by brandonwilliams for CASSANDRA-6053",['StorageService.java'],CASSANDRA-6053
34058783f50b8c81096075b01d093e7aceec2b73,"Avoid StackOverflow with large IN queries

patch by slebresne; reviewed by jbellis for CASSANDRA-6567",['SelectStatement.java'],CASSANDRA-656
97c6bbe6093de16f3370a511023b861a381da7fe,"Use LOCAL_QUORUM for LWT operations at LOCAL_SERIAL
patch by Sankalp Kohli; reviewed by jbellis for CASSANDRA-6495",['StorageProxy.java'],CASSANDRA-6495
63c490af9cbe392ba025f15854173eb4f7fbbfad,"encapsulate SecondaryIndex.estimateResultRows
patch by Miguel Angel Fernandez Diaz; reviewed by Sam Tunnicliffe for CASSANDRA-6498",['StorageProxy.java'],CASSANDRA-6498
5f635782a8cbe45f1d00ec4f2ed50e1827d3d498,"Refuse snapshots during bootstrap.
Patch by brandonwilliams, reviewed by thobbs for CASSANDRA-6585",['StorageService.java'],CASSANDRA-6585
eb4eb656e3a8038a59ef95f0b9c95283fa388ed9,"Make TOKENS the canonical place to determine tokens.
Patch by brandonwilliams, reviewed by thobbs for CASSANDRA-5131",['StorageService.java'],CASSANDRA-5131
1d4caf4e4e5d7a83ede14db1b2278e074d545ba8,"Avoid special casing received/expected counts in CAS timeout exceptions

patch by slebresne; reviewed by jbellis for CASSANDRA-6595",['StorageProxy.java'],CASSANDRA-659
b168f3e294e7db6abfbfda777a567acd76bfa863,"getValidColumnFamilies adds 2I if requested and no ks/cf specified
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-6598",['StorageService.java'],CASSANDRA-6598
07f85b139ffb2e40a32f06eb0942b5b614699e07,"getValidColumnFamilies adds 2I if requested and no ks/cf specified
Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-6598",['StorageService.java'],CASSANDRA-6598
cead348d9d646b50f086d5cdcdceb5eecf66e806,"Check that key_aliases/column_aliases exists before using them
Patch by brandonwilliams, reviewed by iamaleksey for CASSANDRA-6589",['ColumnFamilyStore.java'],CASSANDRA-6589
c8a0a3a689d965af8de683f2d831f2c422105670,"Pre-6504 cleanup and fixups

patch by Aleksey Yeschenko; reviewed by Sylvain Lebresne for
CASSANDRA-6504","['Config.java', 'CompactionManager.java', 'StorageProxy.java']",CASSANDRA-65
3de845426aebaba733d616f7e6426b2a6c410a3e,"skip blocking on streaming during drain
patch by jasobrown; reviewed by yukim for CASSANDRA-6603","['MessagingService.java', 'StorageService.java']",CASSANDRA-6603
719103b649c1c5459683a8ffd1c013664f1ffbb6,"add listsnapshots command to nodetool
patch by Sankalp Kohli and Lyuben Todorov for CASSANDRA-5742","['ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-5742
3834a8596604f3e23ac863e8a6e16b645f9324fa,"improve logging of settings at startup
patch by Sean Bridges and Lyuben Todorov for CASSANDRA-6456","['DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-6456
c612a364951c02d95ead41fb54048fa8fcb35265,"Don't check for expireTime if node is not in REMOVED
Patch by thobbs, reviewed by brandonwilliams for CASSANDRA-6564",['StorageService.java'],CASSANDRA-6564
a16986374450c0e8c1bd1de8933042998a079f13,"Don't check for expireTime is node isn't in REMOVED
Patch by thobbs, reviewed by brandonwilliams for CASSANDRA-6564",['StorageService.java'],CASSANDRA-6564
714c423360c36da2a2b365efaf9c5c4f623ed133,"New counters implementation

patch by Aleksey Yeschenko; reviewed by Sylvain Lebresne for
CASSANDRA-6504","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-65
6c4333e3d47dfe3fad9781e3c36a5c84476af1d3,"Handle host id conflicts properly.
Patch by brandonwilliams, reviewed by Tyler Hobbs for CASSANDRA-6615",['StorageService.java'],CASSANDRA-6615
4b54b8acd21999ad4394feb93deb7cca1de445c0,"remove Table.switchlock and introduce o.a.c.utils.memory package
patch by Benedict Elliott Smith; reviewed by jbellis for CASSANDRA-5549","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'CassandraDaemon.java']",CASSANDRA-5549
36af40925b3e8e01ede5ff6d7ed9a16046409fe3,"sstables from stalled repair sessions become live after a reboot and can resurrect deleted data
patch by jasobrown, reviewed by yukim for CASSANDRA-6503",['ColumnFamilyStore.java'],CASSANDRA-6503
a8a12d9e0adee65bad19dcfd86e7b0cf6b1ed89a,"Fix IllegalArgumentException during statement preparation

patch by slebresne; reviewed by thobbs for CASSANDRA-6592",['SelectStatement.java'],CASSANDRA-659
728c4fa9bf2b2c11dbc61c8e5536b1542abc1ccb,"Let scrub optionally skip broken counter partitions

patch by Tyler Hobbs; reviewed by Aleksey Yeschenko for CASSANDRA-5930","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-593
039e9b9a18cbe78091231a4538b6d428deacc771,"Fix direct Memory on architectures that do not support unaligned long access
patch by Dmitry Shohov and Benedict Elliott Smith for CASSANDRA-6628","['DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-6628
ed5cac1d2ab18f03ec2fe211c46b5382729b4c4d,"Move handling of migration event source to solve bootstrap race.
Patch by Sergio Bossa and brandonwilliams, reviewed by Tyler Hobbs for
CASSANDRA-6648",['StorageService.java'],CASSANDRA-6648
93bd89fbba7d76821d3d85ae371cb2e665176b6a,"Move handling of migration event source to solve bootstrap race.
Patch by Sergio Bossa and brandonwilliams, reviewed by Tyler Hobbs for
CASSANDRA-6648",['StorageService.java'],CASSANDRA-6648
e59ef16bfcb3bd019202fc12bedeb04302066540,"Correctly handle null in conditions with TTL

patch by slebresne; reviewed by iamaleksey for CASSANDRA-6623",['StorageProxy.java'],CASSANDRA-662
ab6eaed8f6bdef21323be561a22e9fdb16bbd0fc,"Make it possible to cache a configurable amount of rows in row cache.

Patch by pcmanus and marcuse, reviewed by pcmanus for CASSANDRA-5357",['ColumnFamilyStore.java'],CASSANDRA-5357
cd26f48ce88d7db7c05f01ca6fbe82d087b3b3f7,"Expose bulk loading progress over JMX
patch by Tyler Hobbs; reviewed by Nick Bailey for CASSANDRA-4757",['StorageService.java'],CASSANDRA-4757
5f64af63ae063c055c214d8925098f34f4111474,"Add nodetool taketoken to relocate vnodes.
Patch by brandonwilliams reviewed by jbellis for CASSANDRA-4445","['StorageService.java', 'NodeProbe.java']",CASSANDRA-4445
d5c5734c89a62869ee0c207306543b7f1e9cdf27,"Add nodetool taketoken to relocate vnodes.
Patch by brandonwilliams reviewed by jbellis for CASSANDRA-4445","['StorageService.java', 'NodeProbe.java']",CASSANDRA-4445
7a3e697d836ca6fd7f41215678c977cb48a2ce1f,"Don't swallow useful exceptions.
patch by Ding Yuan; reviewed by Mikhail Stepura for CASSANDRA-6656",['NodeProbe.java'],CASSANDRA-6656
3d5b5c3a7e37532017e910ffc680e4f42d918c30,"Log heap pool sizes at startup.
Patch by brandonwilliams, reviewed by Lyuben Todorov for CASSANDRA-6657",['CassandraDaemon.java'],CASSANDRA-6657
a7b72140b61cf1998963750c21d6f6080f02d6bb,"Avoid repairing already repaired data.

Patch by lyubent, yukim and marcuse, reviewed by yukim for CASSANDRA-5153","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-5153
0e43885ab24768177cc1e758e1ab69b6dc1b23db,"ColumnFamily-related cleanups

patch by Aleksey Yeschenko; reviewed by Benedict Elliott Smith for
CASSANDRA-6662",['ColumnFamilyStore.java'],CASSANDRA-6662
cf6b4888242d9f4ce891d051b02e6f9eb529d300,"Sleep for RING_DELAY before replacing with same IP
Patch by brandonwilliams reviewed by Tyler Hobbs for CASSANDRA-6622",['StorageService.java'],CASSANDRA-6622
00a8b1e6ece0f89ae038589f36c7b9a9012fb7f7,"Sleep for RING_DELAY before replacing with same IP
Patch by brandonwilliams reviewed by Tyler Hobbs for CASSANDRA-6622",['StorageService.java'],CASSANDRA-6622
5cf381f57da41e986e7434fb7a46531c42c2cdd3,"Replace EmptyColumns with updated ArrayBackedSortedColumns

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-6690",['StorageProxy.java'],CASSANDRA-669
e9f8fc7164aac0c7a746b74911afda9e0f02dbd8,"Require JNA by default
patch by Clément Lardeur; reviewed by dbrosius and Josh McKenzie for CASSANDRA-6575",['CassandraDaemon.java'],CASSANDRA-6575
0b42b0e76267aa4101b1634bd5d96c9b85997b56,"Lift limitation that order by columns must be selected for IN queries

patch by slebresne; reviewed by thobbs for CASSANDRA-4911",['SelectStatement.java'],CASSANDRA-491
f10148f4f1719f99bc3888b93f5a285c8af997d1,"Add flush directory distinct from compaction directories
patch by jbellis and aleksey for CASSANDRA-6357","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java']",CASSANDRA-6357
94bda1f7d39adc631cfc8ef316730b54df040cdc,"Split out outgoing stream throughput within a DC and inter-DC
patch by Vijay and benedict for CASSANDRA-6596","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-6596
44cf4a66d157643297b7ab791a57f323432e28c5,"Fix count(*) queries in a mixed cluster

patch by Tyler Hobbs; reviewed by Piotr Kołaczkowski for CASSANDRA-6707","['SelectStatement.java', 'MessagingService.java']",CASSANDRA-6707
8c6541715067a4ae9e3bb583c49d4b7ac0bb2fff,Undo CASSANDRA-6707 from trunk,"['SelectStatement.java', 'MessagingService.java']",CASSANDRA-6707
500c62d6b98f5b5c15b91f1d38f0132b846c6b48,"Allow per-dc enabling of hints
patch by Sankalp Kohli; reviewed by Lyuben Todorov for CASSANDRA-6157","['Config.java', 'DatabaseDescriptor.java', 'StorageProxy.java', 'NodeProbe.java']",CASSANDRA-6157
f30b772006e43e0c2905638e1e271854f2a71f69,"Allow repairing between specific replicas
patch by Sankalp Kohli; reviewed by Lyuben Todorov for CASSANDRA-6440","['StorageService.java', 'NodeProbe.java']",CASSANDRA-6440
c92b20b3073f1c5cca3666225db33ea102ba77b5,"Don't attempt cross-dc forwarding interface/mixed-version cluster with 1.1
patch by Jeremiah Jordan; reviewed by jbellis for CASSANDRA-6732",['StorageProxy.java'],CASSANDRA-6732
84103bbe2894706d224dc5975ca6bdaaa6f7f6c4,"Use correct partitioner in AbstractViewSSTableFinder
patch by jbellis; reviewed by yukim for CASSANDRA-6734",['ColumnFamilyStore.java'],CASSANDRA-6734
b6849375151f79d0aa708a990dc9daef567dfcb5,"Catch memtable flush exceptions during shutdown
patch by Sergio Bossa; reviewed by jbellis for CASSANDRA-6735",['StorageService.java'],CASSANDRA-6735
d529ab9b8cbb66f299bd69c7283e38caa4c57253,"Adjust nodetool for changes from CASSANDRA-5549.
patch by Mikhail Stepura; reviewed by Yuki Morishita for CASSANDRA-6739",['NodeProbe.java'],CASSANDRA-5549
b09d876914ad9c9fdf1af35cf48cdb98c27bbf32,"Add static columns in CQL3

patch by slebresne; reviewed by iamaleksey for CASSANDRA-6561",['SelectStatement.java'],CASSANDRA-656
26217071280f909f81fc3711df406a572b547c58,"Remove CQL2

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-5918",['SelectStatement.java'],CASSANDRA-591
0510d4e5b9862ee46be67581334a6f98d066b7ab,"Fix overflow of memtable_total_space_in_mb
patch by Benedict Elliott Smith; reviewed by jbellis for CASSANDRA-6753",['DatabaseDescriptor.java'],CASSANDRA-6753
3bfb7644fa0f91465d0b1066ba4800314d8cdc18,correct more uses of isMinimum (CASSANDRA-6734),['ColumnFamilyStore.java'],CASSANDRA-6734
fd609339eebd13e2adc37969c8e0b439775a17af,"Fix NPE when using static columns and IN

patch by slebresne; reviewed by iamaleksey for CASSANDRA-6769",['SelectStatement.java'],CASSANDRA-676
ab2717b6f6475a5d925058338549d31bb2776e6e,"Avoid race-prone second ""scrub"" of system keyspace
patch by Josh McKenzie; reviewed by jbellis for CASSANDRA-6797",['CassandraDaemon.java'],CASSANDRA-6797
84626372c0ae007bb55e0072d981d856f5a8e72c,"Fix potentially repairing with wrong nodes

patch by yukim; reviewed by krummas for CASSANDRA-6808",['StorageService.java'],CASSANDRA-680
f7eca98a7487b5e4013fbc07e43ebf0055520856,"Fix trigger mutations when base mutation list is immutable

patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko for
CASSANDRA-6790",['StorageProxy.java'],CASSANDRA-679
da444a6903ddd8d02e7b251c8b38faf11d3a5c93,"Update syntax for changing caching options.

Patch by marcuse, reviewed by slebresne for CASSANDRA-6745.","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-6745
05da045bbfe29bf472982d3c5da90050176202df,"fixed bug in CompactionManager.needsCleanup

Patch by Dmitrij Koniajev, reviewed by marcuse for CASSANDRA-6845.",['CompactionManager.java'],CASSANDRA-684
52cf09dbace356bafb846cb9f1fc9df71344f61f,"fix nodetool getsstables for blob PK
patch by Nate McCall; reviewed by jbellis for CASSANDRA-6803",['ColumnFamilyStore.java'],CASSANDRA-6803
fcd9a377ee102d97479193f2d975b33875e51373,"Storage Proxy should register instance not new instance
patch by Ed Capriolo; reviewed by jbellis for CASSANDRA-6856",['StorageProxy.java'],CASSANDRA-6856
3050134c263f830240e3e9f56b675c3251e312ba,"Fix truncate to not abort due to unreachable fat clients
patch by Oleg Anastasyev; reviewed by jbellis for CASSANDRA-6864",['StorageProxy.java'],CASSANDRA-6864
75ff51e12485c16f3c408d40f357e07bb26905ea,"Extend triggers to support CAS updates

patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko for
CASSANDRA-6882",['StorageProxy.java'],CASSANDRA-688
9269cb83ce0bd45eff0f42611d5b5cd4415cba31,"Pick unused generations when loading new sstables

patch by Tyler Hobbs; reviewed by Jonathan Ellis for CASSANDRA-6514",['ColumnFamilyStore.java'],CASSANDRA-651
f5e1cbca871e6e4cc7007177b2b0e9f367ae60ba,"Include correct consistencyLevel in LWT timeout
patch by Sankalp Kohli; reviewed by jbellis for CASSANDRA-6884",['StorageProxy.java'],CASSANDRA-6884
75508ec8973972634dca2a41a12a0d1d48e7c3ae,"ByteBuffer write() methods for serializing sstables

Patch by benedict, reviewed by marcuse for CASSANDRA-6781","['SSTableReader.java', 'MessagingService.java']",CASSANDRA-678
c843b6b85cf828fde16d8d8a04411cba515f715e,"Fix paging with SELECT DISTINCT

patch by slebresne; reviewed by thobbs for CASSANDRA-6857",['ColumnFamilyStore.java'],CASSANDRA-685
6b6139cc8bf903f76dfc422d1f45a800a84b9000,"Allow deleting snapshots from dropped keyspaces
patch by Lyuben Todorov; reviewed by Nick Bailey for CASSANDRA-6281",['StorageService.java'],CASSANDRA-6281
4347982974176bd20bfa69d72a72f895e1b05d25,"Fix race processing range scan responses
patch by jbellis; reviewed by mstepura and ayeschenko for CASSANDRA-6820",['StorageProxy.java'],CASSANDRA-6820
1a3b5dbcb5fbee5066ceaa2467536119893f7e7f,"Add multiple memory allocation options for memtables
patch by benedict and xedin; reviewed by marcuse and xedin for CASSANDRA-6689","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-6689
3856c37ad2ea23fa7365eac27a425c7b827f69ad,"Restrict Windows to parallel repairs
patch by Josh McKenzie; reviewed by jbellis for CASSANDRA-6907",['StorageService.java'],CASSANDRA-6907
47bbfe35afd750ef110311725f6b2824a91552fd,"Track liveRatio per-memtable, not per-CF

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-6945",['ColumnFamilyStore.java'],CASSANDRA-6945
b7ac8f96c169a3cfe18dd50ca1f27ce2b21fd78b,"Serialize batchlog mutations with the version of the target node

patch by Aleksey Yeschenko; reviewed by Sylvain Lebresne for
CASSANDRA-6931","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-6931
a90b98e902fc54f62a379a6ce1e6ddead43ba1ec,"Make sure we keep the sstable level when running upgradesstables.

Patch by marcuse; reviewed by yukim for CASSANDRA-6958",['CompactionManager.java'],CASSANDRA-6958
b42feea6432905946083e0e287b3545a5799e4a7,"Fix Cassandra 2.0.x validates Thrift columns incorrectly

patch by thobbs and slebresne; reviewed by thobbs and slebresne for CASSANDRA-6892",['SelectStatement.java'],CASSANDRA-689
56d84a7c028c0498158efb1a3cadea149ab7c1cd,"Allow compaction of system tables during startup
patch by Benedict Elliott Smith; reviewed by jbellis for CASSANDRA-6913",['StorageService.java'],CASSANDRA-6913
38db6e44640982feb6397936eafecfee68fa3552,"Lock counter cells, not partitions

patch by Aleksey Yeschenko; reviewed by Benedict Elliott Smith for
CASSANDRA-6880",['ColumnFamilyStore.java'],CASSANDRA-688
d7ae79427e1153e0065933cdd9df43b08da3fabc,"Put nodes into hibernate when join_ring is false.

Patch by brandonwilliams, reviewed by Tyler Hobbs for CASSANDRA-6961",['StorageService.java'],CASSANDRA-6961
76db70e9d46688a6ef57f963dae0dad3d7c04ca7,Fix bad merge of CASSANDRA-6961 from 2.0 to 2.1,['StorageService.java'],CASSANDRA-6961
8a5b90ede0701e05f776e6adccc71f6fbd43e3aa,"Add failure handler to async callback

patch by sankalp kohli; reviewed by yukim for CASSANDRA-6747","['MessagingService.java', 'StorageService.java']",CASSANDRA-6747
930905bbebfbfc923d71c34fb35fbdb4e7bc8ccc,"Fix AE when SSTable is closed without releasing reference

patch by yukim and benedict; reviewed by thobbs and Ben Chan for
CASSANDRA-7000","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-700
fe94e90f4bd9274a0f0ab10616de2215da8d6b17,"Shutdown batchlog executor in SS#drain()

patch by Sergio Bossa; reviewed by Aleksey Yeschenko for CASSANDRA-7025",['StorageService.java'],CASSANDRA-702
de8a479f2e1a8b536dedf2e6470301709bc3d9dc,"Snapshot only related SSTables when sequential repair

patch by yukim; reviewed by jmckenzie for CASSANDRA-7024",['ColumnFamilyStore.java'],CASSANDRA-702
87097066e7c3c133e333804c4e4b00457b6c989d,"Fix batchlog to account for CF truncation records

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-6999","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-699
54bf92f37d4ad1a65f106b8b2a3212e8f2516282,"Queries on compact tables can return more results than requested

patch by slebresne; reviewed by thobbs for CASSANDRA-7052",['SelectStatement.java'],CASSANDRA-705
a2e74354ca51809a11b62dd7995c026807683b0a,"Add range tombstones to read repair digests
patch by Oleg Anastasyev; reviewed by jbellis for CASSANDRA-6863",['MessagingService.java'],CASSANDRA-6863
de720b4aa31198076abbd76a53644df341577126,"Log a warning for large batches
patch by Lyuben Todorov; reviewed by Benedict Elliott Smith for CASSANDRA-6487","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-6487
1c2a812a9ade93e436f9c7ad1921be2a8f1bbbf5,"Use LOCAL_QUORUM fordata reads at LOCAL_SERIAL
patch by Sankalp Kohli; reviewed by jbellis for CASSANDRA-6939",['StorageProxy.java'],CASSANDRA-6939
2890cc5be986740cadf491bb5efbb49af2b11c57,"Ensure that batchlog and hint timeouts do not produce hints

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-7058",['MessagingService.java'],CASSANDRA-7058
15e7ac7d37a49c7ff852057f6f124aee611470da,"force Windows to use non-mapped i/o
patch by Josh McKenzie; reviewed by Benedict Elliott Smith for CASSANDRA-6993",['DatabaseDescriptor.java'],CASSANDRA-6993
b9324e1b94f67f3d89096fcef4d157f9505364e9,Post-CASSANDRA-7058 fix,['StorageProxy.java'],CASSANDRA-7058
4e4d7bbcb254285a1031cb232b3fe7af326e9da3,"Setting severity via JMX broken
patch by Vijay; reviewed by rbranson for CASSANDRA-6996",['StorageService.java'],CASSANDRA-6996
b3a225ef101d8ac2de183279843f94a54a38c907,"Increase default CL space to 8GB
patch by Benedict Elliott Smith; tested by Ryan McGuire and reviewed by jbellis for CASSANDRA-7031",['DatabaseDescriptor.java'],CASSANDRA-7031
4e95953f29d89a441dfe06d3f0393ed7dd8586df,"Preemptive open of compaction results

Patch by benedict; reviewed by marcuse for CASSANDRA-6916","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-6916
c1eb74ce47988c1e75d20ccb9a0320dd305c4b1c,"Merge groupable mutations in TriggerExecutor#execute()

patch by Aleksey Yeschenko and Sergio Bossa for CASSANDRA-7047",['StorageProxy.java'],CASSANDRA-704
072b488cfcc4603d467bee6ea601c16cf92efc3e,Followup to CASSANDRA-6916 - fix bug in cleanup and add unit test.,['CompactionManager.java'],CASSANDRA-6916
c8dcc7515e9f1d7f73f2d5e6651862a1b1023bea,"Multi-threaded scrub/cleanup/upgradesstables

Patch by rspitzer and marcuse for CASSANDRA-5547",['CompactionManager.java'],CASSANDRA-554
0a20f5f170b3596e6e74bba7daddebd4c1f5963a,"Add ability to set/get logging levels to nodetool
patch by Jackson Chung reviewed by Vijay for CASSANDRA-6751","['StorageService.java', 'NodeProbe.java']",CASSANDRA-6751
8541cca718fc324c2545831fc945247a4aeb3437,"Push more of memtable data off-heap

patch by benedict & xedin; reviewed by benedict, iamaleksey & xedin for CASSANDRA-6694","['Config.java', 'DatabaseDescriptor.java', 'SelectStatement.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-669
9872b74ef20018e4e7645a8952fd7295e75764ad,"Native protocol v3

patch by slebresne; reviewed by thobbs for CASSANDRA-6855",['SelectStatement.java'],CASSANDRA-6855
9f60c55ba42ff56aa58c3790b9c55924c4deedf4,"Support consistent range movements.

patch by tjake; reviewed by thobbs for CASSANDRA-2434",['StorageService.java'],CASSANDRA-243
2e9ac19a4d129f67d079aef1567ba3911458d372,"Fix writetime/ttl methods for static columns

patch by slebresne; reviewed by thobbs for CASSANDRA-7081",['SelectStatement.java'],CASSANDRA-708
562a22fcd29b215f921ed3a4f4fe26b6f2290530,"Update system.peers correctly when relocating tokens.

Patch by brandonwilliams, reviewed by tjake for CASSANDRA-7126",['StorageService.java'],CASSANDRA-71
af96d405b42a9e4ae23cba841b7a5d83ee8f7ec8,"Make batchlog replica selection rack-aware
patch by Mikhail Stepura; reviewed by jbellis for CASSANDRA-6551",['StorageProxy.java'],CASSANDRA-6551
8bbe901f2a7c2799fd2fd466e360e4d5c39224d9,"Correctly delete scheduled range xfers

Patch by brandonwilliams, reviewed by aleksey for CASSANDRA-7143",['StorageService.java'],CASSANDRA-71
9881ea6b3e4c48fab071bf3e1cf3535775adefa2,"Cleanup and optimize collation and slice iterators

patch by Aleksey Yeschenko and Benedict Elliott Smith; reviewed by
Aleksey Yeschenko for CASSANDRA-7107",['ColumnFamilyStore.java'],CASSANDRA-710
f4460a55b85759d2a631a2d931f10106e1748770,"Update peer information when a node jumps to normal.

Patch by brandonwilliams, reviewed by Richard Low for CASSANDRA-7122",['StorageService.java'],CASSANDRA-71
ef35641edd2682b6e6ee177dce0b93849dbe8c4f,assume allNodesAtLeast21 until demonstrated otherwise; see CASSANDRA-7161,['MessagingService.java'],CASSANDRA-7161
c7e472e8c1eb5739866e8c93957738676cc744bc,"Set keepalive on MessagingService connections
patch by Jianwei Zhang; reviewed by jbellis for CASSANDRA-7170",['MessagingService.java'],CASSANDRA-7170
05bacaeabc96a6d85fbf908dce8474acffcab730,"Starting threads in the OutboundTcpConnectionPool constructor causes race conditions

patch by sbtourist; reviewed by jasobrown for CASSANDRA-7177",['MessagingService.java'],CASSANDRA-717
ce7bf5e99405ce08dbd2b4955fd76582c27db403,"Add snapshot ""manifest"" describing files included
patch by Sankalp Kohli; reviewed by jbellis for CASSANDRA-6326",['ColumnFamilyStore.java'],CASSANDRA-6326
0490abff4e09d1b89f7ee00161ecc487d0c30151,"Check if autocompaction should be disabled before enabling it during startup.

Patch by marcuse; reviewed by driftx for CASSANDRA-7187",['CassandraDaemon.java'],CASSANDRA-71
359de196f1d7a8f9193d0e977b57ce5d846b9f01,"Fix repair hang when given CF does not exist

patch by yukim; reviewed by krummas for CASSANDRA-7189",['StorageService.java'],CASSANDRA-7189
3fab711ee76c081c0ab5874d64b78673334f9071,"Follow up on CASSANDRA-7189

fix hang when no CF name is given",['StorageService.java'],CASSANDRA-7189
33bc1e8f8e44fa61f87d47add52f5bda3456f62c,"Followup to 6916, don't try to snapshot readers that are opened early.

Patch by benedict; reviewed by marcuse for CASSANDRA-6916.","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-6916
5d187fb82a804f7c9b29c1cf7322436d5488ba4d,"Backported CASSANDRA-5818 to cassandra-2.0

patch by Lyuben Todorov; reviewed by Mikhail Stepura",['CassandraDaemon.java'],CASSANDRA-5818
9d06ea6f144c3a1327d9c1322f1543067852701e,"Fixup for CASSANDRA-6914: null handling, ...

patch by slebresne; reviewed by thobbs for CASSANDRA-7155",['SelectStatement.java'],CASSANDRA-6914
e3a88b9f80ea9ba59cf3da8f7b5cc81ccb32e24a,"Increase compaction visibility

Patch by cnlwsu; reviewed by marcuse for CASSANDRA-7242.",['CompactionManager.java'],CASSANDRA-724
20e058b2bd0ae452966afa7f548bd305e2f742c4,"Fix 2ndary index queries with DESC clustering order

patch by slebresne; reviewed by thobbs for CASSANDRA-6950",['SelectStatement.java'],CASSANDRA-695
ca213ccdc029e74f548115dfbb61c65d221e5e42,"Invalidate key cache on table drop

patch by thobbs; reviewed by slebresne for CASSANDRA-6525",['ColumnFamilyStore.java'],CASSANDRA-65
e00878d9558d9220ef864c6dfb69293ada36e2bd,"Change concurrent_compactors defaults
patch by jbellis; reviewed by bes for CASSANDRA-7139","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-7139
43496384d404f2fa0af943003f2dc8fdfced4073,"Support multi-row selects within a partition using IN

Patch by Tyler Hobbs; review by Sylvain Lebresne for CASSANDRA-6875","['SelectStatement.java', 'SelectStatement.java']",CASSANDRA-687
028f539eaa7f5ebcda42495145686dc1fa40acd9,"Fix broken paging state with prepared statement

patch by slebresne; reviewed by thobbs for CASSANDRA-7120",['SelectStatement.java'],CASSANDRA-71
35801be6f4c85328fe8e73054eed5f91f3df115f,"Fix broken paging state with prepared statement

patch by slebresne; reviewed by thobbs for CASSANDRA-7120",['SelectStatement.java'],CASSANDRA-71
0932ed670c66ca2f8c5dc1450b85590738b773c9,"Tuple types

patch by slebresne; reviewed by thobbs for CASSANDRA-7248",['SelectStatement.java'],CASSANDRA-724
7bbeb5aa2d1064281589b98306f950550bd47e60,"Fix bug with some IN queries missing results

patch by slebresne; reviewed by thobbs for CASSANDRA-7105",['SelectStatement.java'],CASSANDRA-710
6574de53429e923121e1ee6df197bfa149208742,"Fix bound building for multi-column IN restrictions

Patch by Tyler Hobbs and Sylvain Lebresne as a follow up on
CASSANDRA-6875",['SelectStatement.java'],CASSANDRA-687
ee950b4103459740329dd91b07738b4e6003f977,"Revert flush directory (CASSANDRA-6357)

Patch by Jonathan Ellis; reviewed by Benedict Elliott Smith","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java']",CASSANDRA-6357
1dc157afe7da3dce57f7657e445ba12f16073d49,"Fix handling of empty counter replication mutations

patch by Aleksey Yeschenko; reviewed by Richard Low for CASSANDRA-7144",['StorageProxy.java'],CASSANDRA-7144
12a7a7ebfcdbcbde0fea244c3b9ab95cd7cf68e5,CASSANDRA-7144 follow-up,['StorageProxy.java'],CASSANDRA-7144
dc73f214e0831c11986f0548cc3ae5879449e683,"RepairTask didn't send a correct message on IllegalArgumentException

patch by Mikhail Stepura; reviewed by Yuki Morishita for CASSANDRA-7336",['StorageService.java'],CASSANDRA-733
05ffa8ff1eeaa8f911798c1dca14de6117b27347,"Add per-CF range read request latency metrics

patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko for
CASSANDRA-7338",['ColumnFamilyStore.java'],CASSANDRA-733
4722fe70aa9ae1b62772cfa1a1de58ef289445d5,"RefCount native frames from netty to avoid corruption bugs

patch by tjake; reviewed by bes for CASSANDRA-7245","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-7245
60be74230e48bb7f3aba132e247d054a8b8b8a0d,"Use $CASSANDRA_HOME for default paths instead of /var

Patch by Tyler Hobbs; reviewed by Brandon Williams and Joshua McKenzie
for CASSANDRA-7136",['DatabaseDescriptor.java'],CASSANDRA-71
99594cd6879c73da78d05a56232427936d2ee5d7,"Use node's host id in place of counter ids

patch by Aleksey Yeschenko; reviewed by Sylvain Lebresne for
CASSANDRA-7366",['StorageService.java'],CASSANDRA-736
29a89d818a8befa95408e7c6c0a1347e107c3a26,"Add replace_address_first_boot flag to only replace if not bootstrapped.

Patch by brandonwilliams, reviewed by thobbs for CASSANDRA-7356",['DatabaseDescriptor.java'],CASSANDRA-7356
4b3a17cda6f46b444ec54b719bf6ac7c246c513f,"Increase socket bind backlog to 500
Patch by Oleg Anastasyev, reviewed by brandonwilliams for CASSANDRA-7236",['MessagingService.java'],CASSANDRA-7236
afa304e3385b299cf53e949a9533bc08ead4c1de,"Fix assertion error in CL.ANY timeout handling

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-7364",['StorageProxy.java'],CASSANDRA-736
434b5d683ec7520acf1a5a2d421ee5aba2ede0e8,"Improve validation of sub range repair

also prevent ""-pr"" repair not to work with ""-dc/-hosts/-local"".
patch by yukim; reviewed by krummas for CASSANDRA-7317",['StorageService.java'],CASSANDRA-7317
1569bd9c4b7af1099a922f16e6873cdff6bf4f07,"clean out in_memory_compaction_limit
patch by jbellis; reviewed by ayeschenko for CASSANDRA-7428","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-7428
d84b692eb1cc0fbc55f047ec61c6a1c2cabe8b46,"Fix replace_address after CASSANDRA-7356 broke it

Patch by Tyler Hobbs and Marcus Eriksson; reviewed by Brandon Williams for CASSANDRA-7356","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-7356
79a4dd58cd060cc28f32e0fc17001fe1179552a2,"Refuse range queries with strict bounds on compact tables

patch by slebresne; reviewed by iamaleksey for CASSANDRA-7059",['SelectStatement.java'],CASSANDRA-705
ef4a07b4b62eb448b6c1752250896fc861ff29a4,"Adjust MT depth based on # of partitions validating

patch by yukim; reviewed by jbellis for CASSANDRA-5263",['CompactionManager.java'],CASSANDRA-526
da3606e180411e88774a9f24e7884147a202fea8,"Merge commit failure policy into 2.1

patch by Benedict Elliott Smith; reviewed by Marcus Eriksson for CASSANDRA-7429","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-74
e77ea1252092bc0e589cfbc2341c2194cb750b08,"Optimise CellName/Composite comparisons for NativeCell

patch by Jake Luciani and Benedict Elliott Smith for CASSANDRA-6755",['StorageProxy.java'],CASSANDRA-675
4112a7fa279b340fb5f0f28f68ec0bf43f1479bf,"Split out outgoing stream throughput within a DC and inter-DC
patch by Vijay and benedict for CASSANDRA-6596","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-6596
4c9afde7a8fdf85932d3a86b8c0ee6f1549d6e25,"Clone partition key for ReadCommands to avoid netty corruption

patch by jake; reviewed by jason brown for CASSANDRA-7465",['SelectStatement.java'],CASSANDRA-746
f39cb073ac0ecd68a3df4b60c43d6b0b8f3e8de6,"Add property to disable stcs in L0

Patch by marcuse; reviewed by tjake for CASSANDRA-6621",['DatabaseDescriptor.java'],CASSANDRA-662
48ff36a457597a21ab0ad9ba55d849006d3bff1f,"Fix ClassCastException processing expired messages
patch by Jason Brown; reviewed by tjake for CASSANDRA-7496",['MessagingService.java'],CASSANDRA-7496
6893130e899f1c9968e49eb58bf8d81212fc3157,"Fix error when doing reverse queries with static columns

patch by graham sanderson; reviewed by slebresne for CASSANDRA-7490",['SelectStatement.java'],CASSANDRA-74
5e4b8f535fb2b176335ba29a59302b08c3c23766,"Add listen_interface and rpc_interface options
patch by Matt Kennedy; reviewed by Tupshin Harper and jbellis for CASSANDRA-7417","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-7417
1630ebf6afa6c3ceb4751dfd9bb3e444b99211e2,"(Windows) force range-based repair to non-sequential mode
patch by Josh McKenzie; reviewed by jbellis for CASSANDRA-7541",['StorageService.java'],CASSANDRA-7541
3adf59486a4e55f409fcc62a4c942a070b98dd8f,"memtable_cleanup_threshold and memtable_flush_writers defaults
patch by jbellis; reviewed by bes for CASSANDRA-7551","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-7551
638c40e817a0d4c4e52956491b99c2699bedc80c,"Fix tracing of local portions of range slices

Patch by Tyler Hobbs; review by Brandon Williams for CASSANDRA-7599",['StorageProxy.java'],CASSANDRA-759
7e1adb4976470b48a361ec6dcca7cbbcdb86d85f,"Backport CASSANDRA-6747

patch by yukim; reviewed by krummas for CASSANDRA-7560",['MessagingService.java'],CASSANDRA-6747
b40cb0507ccf229e0f5017f865771a1540d38199,"Remove ability to change num_tokens once set.

Patch by brandonwilliams, reviewed by thobbs for CASSANDRA-7649",['StorageService.java'],CASSANDRA-764
0947fb8a91ddbf9785a675bafaac51c02dd1f27e,"Filter cached results correctly.

Patch by marcuse, reviewed aleksey for CASSANDRA-7636",['ColumnFamilyStore.java'],CASSANDRA-763
60eab4e45e18d6b08350187acf56deed9654fda7,"Fix truncate to always call flush on table

Patch by Jeremiah Jordan; reviewed by tjake for (CASSANDRA-7511)","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-751
eb92a9fca76f51c91c9eebaddfd439897a14a6e0,"SSP doesn't cache seeds forever

Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-7663",['DatabaseDescriptor.java'],CASSANDRA-766
41a85afe65e059662c3247de694481a405bc87b1,"switch to notification-based GCInspector
patch by Yuki Morishita, Brandon Williams, and jbellis for CASSANDRA-7638",['CassandraDaemon.java'],CASSANDRA-7638
5009ee31b933fcc5843417fd65ab9ff91bb74e73,"Add support for custom 2i validation
patch by Sergio Bossa and Andrés de la Peña for CASSANDRA-7575",['SelectStatement.java'],CASSANDRA-7575
4a9634a31ea7bbdf3b6c0173a94e6ab3911bc989,"Support connecting to ipv6 jmx with nodetool
patch by Robert Stupp; reviewed by jbellis for CASSANDRA-7669",['NodeProbe.java'],CASSANDRA-7669
d1c4d50ee05cb6be19d60c2e58a19b0e1fb93023,"Add 'nodetool sethintedhandoffthrottlekb'

patch by lyubent; reviewed by slebresne for CASSANDRA-7635","['DatabaseDescriptor.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-7635
a21e655ebd4f7d63926f00ce6b2a86390c35dfb9,"Add cassandra.auto_bootstrap system property
patch by Joe Hohertz; reviewed by jbellis for CASSANDRA-7650",['DatabaseDescriptor.java'],CASSANDRA-7650
e0c4c6e60b682630ecc1285d4def1a652d9203dc,"CASSANDRA-7635, rebase for 2.1","['DatabaseDescriptor.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-7635
6e6a6c39794a06dfdaf7c5499e58b532188e7896,"Avoid logging CompactionInterrupted at ERROR
patch by marcuse; reviewed by jbellis for CASSANDRA-7694",['CompactionManager.java'],CASSANDRA-7694
25411bf1d15a35bf17002cf7664173357c6dc6cf,"Support pure user-defined functions

Patch by Robert Stupp; reviewed by Tyler Hobbs for CASSANDRA-7395",['CassandraDaemon.java'],CASSANDRA-7395
a1348aa2986989eaaafdac3efa57fb15c9a54d7c,"Remove netty buffer ref-counting

Patch by tjake; reviewed by benedict for CASSANDRA-7735","['MessagingService.java', 'StorageProxy.java']",CASSANDRA-773
9be6576f24e52ca6553981976ac589bf6966e804,"Do not flush on truncate if durable_writes is false

Patch by Jeremiah Jordan; reviewed by tjake for CASSANDRA-7750",['ColumnFamilyStore.java'],CASSANDRA-775
f7e88033452ae2fee18a4fc4ec104d14bbddefbe,"Fix MS expiring map timeout for CAS messages

patch by kohlisankalp; reviewed by slebresne for CASSANDRA-7752",['DatabaseDescriptor.java'],CASSANDRA-775
6795b6ec607d58fe32216c15d4ce8d50f260eab7,"Add trace entries about concurrent range requests

Patch and review by Tyler Hobbs and Sylvain Lebresne for CASSANDRA-7599",['StorageProxy.java'],CASSANDRA-759
2738e86783490a6bb83273281e8c4c4dcb873a3d,"Clone token map outside of hot gossip loops
patch by rbranson; reviewed by jbellis for CASSANDRA-7758",['StorageService.java'],CASSANDRA-7758
3fe702825e882398052fa26b230861aac47a0671,"Remove duplicates from StorageService.getJoiningNodes
patch by jbellis; reviewed by ayeschenko for CASSANDRA-7478",['StorageService.java'],CASSANDRA-7478
254df46b19ea574084b9e5dd6810cdc403d16720,"Fix NPE at compaction leftover cleanup for dropped table

patch by yukim; reviewed by jbellis for CASSANDRA-7770",['CassandraDaemon.java'],CASSANDRA-777
23233b384aede963c883a937adf94859edbd7f02,"Invalidate all caches on table drop

patch by Aleksey Yeschenko; reviewed by Benedict Elliott Smith for
CASSANDRA-7561",['ColumnFamilyStore.java'],CASSANDRA-756
5db108c314fa5064669eefef8e5f6a52a1500b96,"Support list index operation with conditions

patch by slebresne; reviewed by thobbs for CASSANDRA-7499",['StorageProxy.java'],CASSANDRA-74
37f5175935a37ce2c005335c2f486efb827b6eba,"Anticompact sstables as groups

Patch by Russell Spitzer; reviewed by marcuse for CASSANDRA-6851",['CompactionManager.java'],CASSANDRA-685
5d4740c5841c9c3a8d6c24578c1c6fb512524321,"Always send Paxos commit to all replicas

patch by kohlisankalp; reviewed by slebresne for CASSANDRA-7479",['StorageProxy.java'],CASSANDRA-74
536a08c29773548203845ad562e278e899b35a4d,"Always send Paxos commit to all replicas

patch by kohlisankalp; reviewed by slebresne for CASSANDRA-7479",['StorageProxy.java'],CASSANDRA-74
20150727b49b5c4f2c5b35fd17b908054a5fd2d5,"Always reject inequality on the partition key without token()

patch by blerer; reviewed by slebresne for CASSANDRA-7722",['SelectStatement.java'],CASSANDRA-772
3d5f3a659695212b4a6dbde6cb5a07a2bea1aca0,"Support non-equals conditions for LWT

Patch by Tyler Hobbs; review by Sylvain Lebresne for CASSANDRA-6839",['SelectStatement.java'],CASSANDRA-6839
44fa12ec435451710cf37463820b708ea637993a,"UDF cleanups

patch by slebresne; reviewed by thobbs for CASSANDRA-7809",['CassandraDaemon.java'],CASSANDRA-780
3b3afb35cd20636c937ab953f497ee7193ab1ffc,"Fix failure to stream ranges when moving

Patch by Tyler Hobbs; reviewed by Yuki Morishita for CASSANDRA-7836",['StorageService.java'],CASSANDRA-783
8bef2609abf32e9524c3aa6c89e5f2d5b381efb6,"Don't allow marking already compacted sstables as compacting.

Patch by marcuse; reviewed by yukim for CASSANDRA-7145",['SSTableReader.java'],CASSANDRA-71
aae9b9101c61d914e0ceb7e39f88d688c986af18,"Don't allow mixed multi/single column relations

Patch by Benjamin Lerer; reviewed by Tyler Hobbs for CASSANDRA-7711",['SelectStatement.java'],CASSANDRA-771
45014886e89e5bd47bf2f4c9871391d77702ad82,"Don't expose internal classes over JMX

Patch by marcuse; reviewed by slebresne for CASSANDRA-7879","['CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-78
46ef9628fa4035c26d81c4a070ebd270e59e5520,"Make repair no-op when RF=1

patch by yukim; reviewed by krummas for CASSANDRA-7864",['StorageService.java'],CASSANDRA-786
838151caba98f88ff583e01bad087d4ead4a764d,"Fixed handling of non-intersecting ranges in anticompaction

patch by Mikhail Stepura; reviewed by Yuki Morishita for CASSANDRA-7892",['CompactionManager.java'],CASSANDRA-789
b867050270408ed6cc77c03d78d75cce9799e38e,"Introduce new append-only concurrent collection, Accumulator, and use for AbstractRowResolver.replies

patch by benedict; reviewed by mishail for CASSANDRA-7873",['StorageProxy.java'],CASSANDRA-78
1fc8899e23042fc8d9d7c2c11453db370fdcc574,"remove non essential @Inline calls

patch by tjake; reviewed by belliottsmith for CASSANDRA-7736",['StorageProxy.java'],CASSANDRA-773
169ec3db8c78dbce103721c48827ee5e32490ff9,"Don't try to shutdown client servers if they don't exist.

Patch by Steve Nelson, reviewed by brandonwilliams for CASSANDRA-7889",['StorageService.java'],CASSANDRA-78
d002c7edc58b3a01e57392eb4f5aab367b1a5512,"Don't output nonsense ownership without a keyspace

Patch by Steven Nelson, reviewed by brandonwilliams for CASSANDRA-7173",['StorageService.java'],CASSANDRA-717
094aa8ef2be1f1c832b6baa7e2f25a1f220b279e,"Don't allow simultaneous bootstrap when cassandra.consistent.rangemovement is true

Patch by brandonwilliams, reviewed by tjake for CASSANDRA-7069",['StorageService.java'],CASSANDRA-706
028880e74ceef57b33b858fbd78d8aa9ac3b9680,"Use ThreadLocalRandom and remove FBUtilities.threadLocalRandom

patch by benedict; reviewed by tjake for CASSANDRA-7934",['StorageProxy.java'],CASSANDRA-79
125b4642db63a37c560dec4615ea04662c6e45ef,"Make repair -pr work with -local

patch by Paulo Motta; reviewed by yukim for CASSANDRA-7450",['StorageService.java'],CASSANDRA-7450
9553dae93ba328f3538b213051d180c21717c158,"Support IN clause for any clustering column

Patch by Benjamin Lerer; reviewed by Tyler Hobbs for CASSANDRA-4762",['SelectStatement.java'],CASSANDRA-47
a337336013eb1efabe709844f1a7755d54b746a8,"Make assassinate a first class command.

Patch by brandonwilliams, reviewed by thobbs for CASSANDRA-7935",['NodeProbe.java'],CASSANDRA-79
549f035b925d6b49400667401bef96baaceb31fd,"Allow permissions cache to be set via JMX

Patch by brandonwilliams, reviewed by aleksey for CASSANDRA-7968",['DatabaseDescriptor.java'],CASSANDRA-79
6198a756338a6101cd0787bd3774ad86b56d4fa5,"Validate token() args are in partition key order

Patch by Benjamin Lerer; reviewed by Tyler Hobbs for CASSANDRA-6075",['SelectStatement.java'],CASSANDRA-6075
c5c0585b4b5a1bad22ced00e01cc90eed8448ce7,"Validate token() args are in partition key order

Patch by Benjamin Lerer; reviewed by Tyler Hobbs for CASSANDRA-6075",['SelectStatement.java'],CASSANDRA-6075
0e831007760bffced8687f51b99525b650d7e193,"Fix resource leak in event of corrupt sstable

patch by benedict; review by yukim for CASSANDRA-7932",['CompactionManager.java'],CASSANDRA-79
62db20a779fac3235c0e4dbade8c3d340d3c310b,"CrcCheckChance should adjust based on live CFMetadata not sstable metadata

patch by tjake; reviewed by Jason Brown for CASSANDRA-7978",['SSTableReader.java'],CASSANDRA-7978
b1166c09983b1678cbc4b241f1da860930c571a5,"Fix CASSANDRA-6075

patch by Aleksey Yeschenko and Benjamin Lerer",['SelectStatement.java'],CASSANDRA-6075
6b8b8e0f924b53b9f99854f88ff9ba84073cb295,"Ignore fat clients when checking for endpoint collision

Patch by brandonwilliams, reviewed by tjake for CASSANDRA-7939",['StorageService.java'],CASSANDRA-79
3ece6f2399fa15c97d889c5d43b4a7457825e8e1,"Ignore fat clients when checking for endpoint collision

Patch by brandonwilliams, reviewed by tjake for CASSANDRA-7939",['StorageService.java'],CASSANDRA-79
aa7794c83fb2a876ce6613ba573cc4fd7472dc95,"Fix possible infinite loop in create repair range

patch by Jimmy Mårdell; reviewed by yukim for CASSANDRA-7983",['StorageService.java'],CASSANDRA-798
ada8d8b60b61653112073538a6335bb30027838a,"Fail on very large batch sizes
patch by Carl Yeksigian; reviewed by Sankalp Kohli for CASSANDRA-8011","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-8011
dbb1fa5690ab3d9d26f7406910e92c6294108041,"Fix for live CFMetadata on SecondaryIndexes

Patch by tjake; reviewed by carl yeksigian for CASSANDRA-8027",['SSTableReader.java'],CASSANDRA-8027
e68f52b8d163ce0a9409ba23fd520f28e12b2a48,"Fix for live CFMetadata on SecondaryIndexes

Patch by tjake; reviewed by carl yeksigian for CASSANDRA-8027",['SSTableReader.java'],CASSANDRA-8027
6eec29ed80de11e820dfcb0f3b3812553dd14246,"Do not exit nodetool repair when receiving JMX NOTIF_LOST

patch by yukim; reviewed by krummas for CASSANDRA-7909",['NodeProbe.java'],CASSANDRA-79
0cad81aeb9ddaf5dad8b2ab9c6ff6955402c9310,"Add support for aggregation functions

patch by blerer; reviewed by slebresne for CASSANDRA-4914",['SelectStatement.java'],CASSANDRA-491
e70f4f81a223f6bad9823673b770581cbfcda34c,"Don't reset nodes' versions when closing IncomingTcpConnections

patch by Aleksey Yeschenko; reviewed by Marcus Eriksson for
CASSANDRA-7734",['MessagingService.java'],CASSANDRA-773
87cbcc0fc1d0fc0375332d77b252f4e0d7b95f80,"Schedule fat client schema pull on join

patch by Oleg Anastasyev; reviewed by Aleksey Yeschenko for
CASSANDRA-7993",['StorageService.java'],CASSANDRA-799
861c4cf2de9075c721945fb7ef84a23030a4f35a,"Integrate Sigar library and add basic OS performance checks on startup

Patch by Amit Kumar and Josh McKenzie; reviewed by tjake for (CASSANDRA-7838)",['CassandraDaemon.java'],CASSANDRA-783
0249363e89e4b860c9486816445cea360380f2ea,"Fix requests with skipMetadata=false returning no metadata

patch by slebresne; reviewed by thobbs for CASSANDRA-8054",['SelectStatement.java'],CASSANDRA-805
6801cb0415f40d6be1333262ae95befd8abd9175,"Remove fat client mode

Patch by brandonwilliams, reviewed by Joshua McKenzie for CASSANDRA-7820","['Config.java', 'DatabaseDescriptor.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-782
027006dcb0931e5b93f5378494831aadc3baa809,"Allow CassandraDaemon to be run as a managed service

Patch by Heiko Braun, reviewed by brandonwilliams for CASSANDRA-7997","['DatabaseDescriptor.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-799
98bcf40226db7c8dbafa6eacee9ce5ef3feaeb1b,"Fix hint replay with many accumulated expired hints

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-6998",['StorageService.java'],CASSANDRA-699
e916dff8ba032d878ad4435eb7175c6a56f79ef4,"Force batchlog replay before decommissioning a node

patch by Branimir Lambov; reviewed by Aleksey Yeschenko for
CASSANDRA-7446",['StorageService.java'],CASSANDRA-744
b353aa34e31c1388fe64a560413c855535af3665,apply CASSANDRA-8027 to cassandra-2.0 branch,['SSTableReader.java'],CASSANDRA-8027
0368e97ee4a807cb832a90c590ae5c65a98730c1,"Extend Descriptor to include a format value and refactor reader/writer apis

patch by tjake; reviewed by Marcus Eriksson for CASSANDRA-7443","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'MessagingService.java']",CASSANDRA-744
d4df271f754ac4d5afd785d4043ccaaeb907a6ad,"Add 'die' policy for commit log and disk failure

patch by John Sumsion and Josh McKenzie, reviewed by blerer for CASSANDRA-7927",['Config.java'],CASSANDRA-79
f25da979f605d2484042e275284d55ce7d6f9142,"Shutdown JVM on file descriptor exhaustion

patch by jmckenzie, reviewed by marcuse for CASSANDRA-7579","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-7579
e60a06cc866e5e85d3e58f25b98f8c048d07ad24,"Mark sstables as repaired after full repair

Patch by marcuse; reviewed by yukim for CASSANDRA-7586","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java']",CASSANDRA-7586
9c316e7858f6dbf9df892aff78431044aa104ed9,"Make sure unfinished compaction files are removed.

Patch by marcuse; reviewed by yukim for CASSANDRA-8124",['SSTableReader.java'],CASSANDRA-812
5160c916c90886f69023ddba0078a624e5cf202d,"Refactor how we track live size

Patch by marcuse; reviewed by yukim for CASSANDRA-7852",['CompactionManager.java'],CASSANDRA-78
5548bf45e9b2cc61cbc131022b3df10924d88a95,"Improve client notification that nodes are ready for requests

Patch by Brandon Williams, reviewed by thobbs for CASSANDRA-7510",['StorageService.java'],CASSANDRA-751
ad84e4d7ee02f2ae5f45d5d5d2cb50c6b10f3836,"Clean up generics in dht package

Patch by blambov, reviewed by jmckenzie for CASSANDRA-8171","['DatabaseDescriptor.java', 'SelectStatement.java', 'StorageProxy.java']",CASSANDRA-817
83d4762a6d6c28c792fadc1d7f228600097d924f,"Add 'nodetool statusgossip'

Patch by Jan Karlsson, reviewed by Brandon Williams for CASSANDRA-8125","['StorageService.java', 'NodeProbe.java']",CASSANDRA-812
fe8e92f8f1ff3adec119c8eb219e024886561196,"Add 'nodetool statusgossip'

Patch by Jan Karlsson, reviewed by Brandon Williams for CASSANDRA-8125","['StorageService.java', 'NodeProbe.java']",CASSANDRA-812
e019760783e4d4ebf2d3ed60c33e7e63c226fa71,"Add column update delta histogram

Patch by Sankalp Kohli, review by jmckenzie for CASSANDRA-7979",['ColumnFamilyStore.java'],CASSANDRA-79
5acc7a9ed72f0862cc87927014e8de131826cd23,"Add column update delta histogram (2.1)

Patch by Sankalp Kohli, review by jmckenzie for CASSANDRA-7979",['ColumnFamilyStore.java'],CASSANDRA-79
11e657189addf1a7da3c5f32719f1cedbcf3d2e3,"Fix non-text comparator col names in cql3 queries

Patch by Tyler Hobbs; reviewed by Aleksey Yeschenko for CASSANDRA-8178",['SelectStatement.java'],CASSANDRA-817
85ea37356e666c2780294bbd29daa89a32ebf333,"Make paxos reuse the timestamp generation of normal operation

patch by slebresne; reviewed by iamaleksey for CASSANDRA-7801","['SelectStatement.java', 'StorageProxy.java']",CASSANDRA-780
ee55f361b76f9ce7dd2a21a0ff4e80da931c77d2,"Support for frozen collections

Patch by Tyler Hobbs; reviewed by Sylvain Lebresne for CASSANDRA-7859",['SelectStatement.java'],CASSANDRA-78
b2808b1dcea1158511421f947660f03d583e84b0,"Wait for all repair sessions to finish

patch by yukim; reviewed by krummas for CASSANDRA-8208",['StorageService.java'],CASSANDRA-820
b4d7f3bed0687b449f6a275d9dd675e25d794aeb,"Deal with conflicts between system functions and UDFs

patch by Robert Stupp; reviewed by Benjamin Lerer for CASSANDRA-7813",['SelectStatement.java'],CASSANDRA-781
4397c34476070ea15ee0d2b9c625887a8b08b622,"Centralize shared executors

patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko for
CASSANDRA-8055","['ColumnFamilyStore.java', 'SSTableReader.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-805
1bb2dd906c1da04be602aa1cec988c4e15bf1ffc,"Fix size calculations for prepared statements

Patch by Benjamin Lerer; reviewed by Dave Brosius for CASSANDRA-8231",['SelectStatement.java'],CASSANDRA-8231
41469ecf6a27e94441f96ef905ed3b5354c23987,"Add DC-aware sequential repair

patch by Jimmy Mårdell; reviewed by yukim for CASSANDRA-8193","['StorageService.java', 'NodeProbe.java']",CASSANDRA-819
8b5cf64043e2d002fdb91921319110911e332042,Backport CASSANDRA-7386,"['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java']",CASSANDRA-7386
794d68b51b77c2a3cb09374010b6f84231ead604,"Support for UDTs, tuples, and collections in UDFs

Patch by Robert Stupp; reviewed by Tyler Hobbs for CASSANDRA-7563",['SelectStatement.java'],CASSANDRA-756
7a14a77f2cbe2ce10ac35d5853ddf9496a86e16e,"Expose off-heap memory usage stats

patch by Benjamin Lerer; reviewed by Aleksey Yeschenko for
CASSANDRA-7897","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-789
54b4b99e1e12328005df51feb71448a320a9b7d6,"Fix undeclared throwable exception while executing 'nodetool netstats localhost'

Patch by Vishal Mehta and Carl Yeksigian, reviewed by Carl Yeksigian for
CASSANDRA-8122","['StorageService.java', 'NodeProbe.java']",CASSANDRA-812
65a7088e71061b876e9cd51140f31c92ded92777,"Refactor SelectStatement and Restrictions

Patch by Benjamin Lerer; reviewed by Tyler Hobbs for CASSANDRA-7981",['SelectStatement.java'],CASSANDRA-798
4030088ec1df44a666ce73306eae5daf664b25ab,"cancel latency-sampling task when CF is dropped
patch by jbellis; reviewed by ayeschenko for CASSANDRA-8401",['ColumnFamilyStore.java'],CASSANDRA-8401
f5866ca2bac8ce530bb4e20832ff61e622206815,"Add repair tracing

Patch by Ben Chan; reviewed by jmckenzie for CASSANDRA-5483","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-548
773a38f79c30a0e270c46de7bc6430c835e5e995,"Reduce maxHintsInProgress
patch by jbellis; reviewed by jasobrown for CASSANDRA-8415",['StorageProxy.java'],CASSANDRA-8415
451c514a3a02f4e889f040176453beefbcd75843,"Fix error message on read repair timeouts

patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko for
CASSANDRA-7947",['StorageProxy.java'],CASSANDRA-79
6d8862b00ed60a24387beb642609c03fcee095e9,"Clean up IsWindows check, add hasProc check

Patch by Blake Eggleston; reviewed by jmckenzie for CASSANDRA-8452","['CassandraDaemon.java', 'StorageService.java']",CASSANDRA-8452
574e2652ef1c5bc8813ae48ebfe785424795e7b5,merge fixes for CASSANDRA-8452,"['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-8452
987191418849191258519464665223f48620920c,"Disable mmap on Windows (2.1 branch)

Patch by jmckenzie; reviewed by belliottsmith for CASSANDRA-6993",['DatabaseDescriptor.java'],CASSANDRA-6993
c45ed1714eaa1536f8c72d355d2831e4aa04a53b,"Run major compactions for repaired/unrepaired in parallel

Patch by marcuse; reviewed by belliottsmith for CASSANDRA-8510",['CompactionManager.java'],CASSANDRA-851
621899355a23eca6c503aa2ced2e944ff6a5fe66,"Fix paging with multi-partition IN queries

patch by thobbs; reviewed by slebresne for CASSANDRA-8408",['SelectStatement.java'],CASSANDRA-840
5f54285e9e39833b6bc01317fd74b8bd9b408842,"Move MeteredFlusher to its own thread

patch by Aleksey Yeschenko; reviewed by Sam Tunnicliffe for
CASSANDRA-8485",['CassandraDaemon.java'],CASSANDRA-848
e20810c7bdf81b2ea225d1356ac3237994fb5349,"Remove C* specific class from JMX API

This is follow up for CASSANDRA-8193","['StorageService.java', 'NodeProbe.java']",CASSANDRA-819
e750ab238e07daa61180d2451ba90f819a4cf5a1,"Introduce background cache refreshing to permissions cache

patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko for
CASSANDRA-8194","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-819
c6525da86eb1ac668206553336056f90e7bfcdaa,"Add ReadFailureException, better TombstoneOE logging

Patch by Christian Spriegel; reviewed by Tyler Hobbs for CASSANDRA-7886",['StorageProxy.java'],CASSANDRA-78
879b694d346e6442c9508d8d8a48e6e71fbcd25b,"Introduce role based access control

patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko for
CASSANDRA-7653","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-765
61bd68885e1a40a8c40522a73bf9d269b58868e9,"Fix LWT requiring all nodes for CAS

patch by Anthony Cozzie; reviewed by Aleksey Yeschenko for
CASSANDRA-8640",['StorageProxy.java'],CASSANDRA-8640
ce207cba413381986324f2c8edad9e090e5be5b1,Ninja-fix CASSANDRA-8640,['StorageProxy.java'],CASSANDRA-8640
5a849764791f7bedd737666a48b53e536f9816ab,"Expose EstimatedHistogram metrics for range slices

patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko for
CASSANDRA-8627",['ColumnFamilyStore.java'],CASSANDRA-862
faf91818b46fb51ed576664a1119315e7b7c3383,"Add tooling to detect hot partitions

Patch by Chris Lohfink, reviewed by brandonwilliams for CASSANDRA-7974","['ColumnFamilyStore.java', 'NodeProbe.java']",CASSANDRA-79
dfd78d0e90b9995872b00f6f33afc180f2b7cba1,"Serializing Row cache alternative, fully off heap

Patch by Robert Stupp, reviewed by Ariel Weisberg for CASSANDRA-7438","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-74
2bf63f61e33587a8ba94fce3a1433e8cd866d1f0,"Do not write commitlog from standalone tools

patch by yukim; reviewed by Tyler Hobbs for CASSANDRA-8616",['DatabaseDescriptor.java'],CASSANDRA-861
c468c8b4369c76612a1fc821e8e77fe1da8b8011,"fix ArrayIndexOutOfBoundsException in nodetool cfhistograms

Patch by Benjamin Lerer, reviewed by jbellis for CASSANDRA-8514",['NodeProbe.java'],CASSANDRA-851
3e5edb82c73b7b7c6e1d1e970fb764c3e3158da6,"rpc_interface and listen_interface generate NPE on startup when specified interface doesn't exist

Patch by Ariel Weisberg; reviewed by Robert Stupp for CASSANDRA-8677",['DatabaseDescriptor.java'],CASSANDRA-8677
c75ee4160cb8fcdf47c90bfce8bf0d861f32d268,"Safer Resource Management

patch by benedict; review by marcuse for CASSANDRA-7705","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-770
8896a70b015102c212d0a27ed1f4e1f0fabe85c4,"Upgrade metrics library and remove depricated metrics

Patch by tjake; reviewed by aleksey for CASSANDRA-5657","['ColumnFamilyStore.java', 'CompactionManager.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-565
3ad0d3a8f2ff4a2f5207b47620b52c192f4e5d82,"Stop compactions before exiting offline tools

Patch by marcuse; reviewed by yukim for CASSANDRA-8623",['CompactionManager.java'],CASSANDRA-862
e60089db08c7675dd507aa668bff862d437382d0,"Write partition size estimates into a system table

patch by Aleksey Yeschenko; reviewed by Piotr Kołaczkowski for
CASSANDRA-7688",['CassandraDaemon.java'],CASSANDRA-7688
fd6f9c6f9c15ab28d0db0edef1f84faaa7ea42c5,Disable CASSANDRA-7688 until DT is fixed,['CassandraDaemon.java'],CASSANDRA-7688
97da271b29941596da7b401c2ed7352de111dc10,"Re-enable CASSANDRA-7688

- properly handle empty intervalTree in DT.View#sstablesInBounds
- switch gc gs to 0 for system.size_estimates table
- add a -D param to alter the estimates update interval
- log the duration of the estimation process",['CassandraDaemon.java'],CASSANDRA-7688
9649594c761dbb72e58ddd71a10f0794378337ca,"Fix multicolumn relations with indexes on some clustering cols

Patch by Benjamin Lerer; reviewed by Tyler Hobbs for CASSANDRA-8275",['SelectStatement.java'],CASSANDRA-827
0ced7a345cf5b5dd7da27f7dfb51aad933b4f21c,"Ensure SSTableReader.last corresponds exactly with the file end

patch by benedict; reviewed by marcus for CASSANDRA-8750",['SSTableReader.java'],CASSANDRA-8750
18d8f26ddd556d6b689a7460053c1518a86d7288,"Evaluate MurmurHash of Token once per query

patch by branimir; reviewed by benedict for CASSANDRA-7096",['SSTableReader.java'],CASSANDRA-709
0d2ec11c7e0abfb84d872289af6d3ac386cf381f,"use preloaded jemalloc w/ Unsafe

Patch by Robert Stupp; Reviewed by Ariel Weisberg for CASSANDRA-8714","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-8714
90a012a1fe29edbb70de30d5f683e10cc27e1602,"Fix mixed single and multi-column relation support

Patch by Benjamin Lerer; reviewed by Tyler Hobbs for CASSANDRA-8613",['SelectStatement.java'],CASSANDRA-861
e8fbfc0822db4f7635549e5f6c45e103562d0c0c,"Add nodetool statushandoff/statusbackup

patch by Prajakta Bhosale; reviewed by yukim for CASSANDRA-8912",['NodeProbe.java'],CASSANDRA-891
4adb9814639d6e4225105e0c364044fac8b4b84d,"Generalize progress reporting

patch by yukim; reviewed by Josh McKenzie for CASSANDRA-8901","['StorageService.java', 'NodeProbe.java']",CASSANDRA-890
dca37a612cfba1b0eae07a5dd4f16a37407a2a51,"Indicate partition key cols in PREPARED responses

Patch by Tyler Hobbs; reviewed by Benjamin Lerer for CASSANDRA-7660",['SelectStatement.java'],CASSANDRA-7660
9caf0457ad8920788506f902ce4d9c130c881031,"Allow invalidating permissions and cache time

Patch by brandonwilliams reviewed by aleksey for CASSANDRA-8722","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-872
c9a6d7ce05ff75412d5f40c740b33b33a7e813a0,"remove BINARY from DROPPABLE_VERBS
patch by dbrosius reviewed by ayeschenko for CASSANDRA-8976",['MessagingService.java'],CASSANDRA-8976
21bdf8700601f8150e8c13e0b4f71e061822c802,"nodetool command to validate all sstables in a node

patch by jeff jirsa; reviewed by branimir for CASSANDRA-5791","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-579
144644bbf77a546c45db384e2dbc18e13f65c9ce,"Partition intra-cluster message streams by size, not type

patch by ariel; reviewed by benedict for CASSANDRA-8789",['MessagingService.java'],CASSANDRA-878
521b36311ad23f3defd6abf36becda61388add9c,"Use correct bounds for page cache eviction of compressed files

patch by benedict; reviewed by marcus for CASSANDRA-8746",['SSTableReader.java'],CASSANDRA-8746
e8276aa539ae618a41acb8b0250886e773b73ef3,"IndexSummary effective interval is a guideline, not a rule

patch by benedict; reviewed by tyler for CASSANDRA-8993",['SSTableReader.java'],CASSANDRA-8993
44f8254df850f17d0c9c940d69af7a2305beb4b0,"Compressed Commit Log

patch by branimir; reviewed by ariel for CASSANDRA-6809","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-6809
c397165dcf17111c0dc54af5b4f671983590263d,"Fix SSTableReader.runOnClose running after dependent resources closed;
bug introduced by CASSANDRA-8746

patch by benedict; reviewed by josh for CASSANDRA-9021",['SSTableReader.java'],CASSANDRA-8746
8a03181dd58c02f4297f4918c7fdc80da5f63fb3,ninja-fix merge of CASSANDRA-6809,"['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-6809
b296c55f956c6ef07c8330dc28ef8c351e5bcfe2,"Fix MOVED_NODE client event

Patch by Stefania, reviewed by brandonwilliams for CASSANDRA-8516",['StorageService.java'],CASSANDRA-851
7ff25f0df55bf492e741730473b94bcba8ac6c0b,"Fixes to index summary resampling on old sstable formats

Patch by Tyler Hobbs; reviewed by Benedict Elliot Smith for
CASSANDRA-8993",['SSTableReader.java'],CASSANDRA-8993
b0de327099c22dd4708b699dfa9e18496abd7429,"Fix anti-compaction target bloom filter size

patch by Gustav Munkby; reviewed by benedict for CASSANDRA-9060",['CompactionManager.java'],CASSANDRA-906
0ff9c3cb222be634e46c378bb357ba0658e0e55b,"Allow reusing snapshot tags across different column families.

patch by Yifu Wang; reviewed by yukim for CASSANDRA-8056",['StorageService.java'],CASSANDRA-805
1e09482a38cbd9bcf4d056781332f8d6e84a624b,"""disk full"" when running cleanup (on a far from full disk)

Patch by Robert Stupp; Reviewed by Yuki Morishita for CASSANDRA-9036",['ColumnFamilyStore.java'],CASSANDRA-9
2d7909dc12dc038a65742ca03d375140c5257158,"New tool added to verify all data in sstables.

Patch by Jeff Jirsa; reviewed by Branimir Lambov for CASSANDRA-5791","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-579
963dd54b71bdcac29c484d89a826773a3f090496,"make default max_hint_window_in_ms 3 hours

Patch by Jeff Jirsa, reviewed by brandonwilliams for CASSANDRA-9076",['Config.java'],CASSANDRA-9
16499ca9b0080ea4d3c4ed3bc55c753bacc3c24e,"Constrain internode message buffer sizes, and improve IO class hierarchy

patch by ariel and benedict for CASSANDRA-8670","['SSTableReader.java', 'NodeProbe.java']",CASSANDRA-8670
c7b02d1a6d11dc4436340a5cbeb0f377e8ac8605,"Add SELECT/INSERT JSON support, toJson(), fromJson()

Patch by Tyler Hobbs; reviewed by Sylvain Lebresne and Robert Stupp for
CASSANDRA-7970",['SelectStatement.java'],CASSANDRA-79
345455dee2b154e5a9b10a7a615bcc0c7092775d,"Do not load read meters for offline operations

patch by benedict; reviewed by tyler for CASSANDRA-9082",['SSTableReader.java'],CASSANDRA-908
1dff098e4c6d42b80ee05c7a444127752f112d08,"Fix wrong check when validating in parallel

patch by yukim; reviewed by krummas for CASSANDRA-9099",['CompactionManager.java'],CASSANDRA-9
1007ba59a918d94c0e4fcdce4094ebeef6aabec3,"Remove ternary construction of SegmentedFile.Builder in SSTableReader

patch by benedict; reviewed by zanson for CASSANDRA-9112",['SSTableReader.java'],CASSANDRA-9112
2057a34cbbc167be4b0a545399c8c56cf0e4717f,"Do not load read meters for offline operations

patch by benedict; reviewed by tyler for CASSANDRA-9082",['SSTableReader.java'],CASSANDRA-908
c5b02422e00aa0015d9dc399bf5ec71555b38a56,"Save repair data to system table

patch by marcuse; reviewed by Sankalp Kohli for CASSANDRA-5839",['StorageService.java'],CASSANDRA-583
4a3ca5c70e94d6b9329b7289f61ffbe708828ebf,"Allow Cassandra config to be updated to restart Daemon without unloading classes

Patch by Emmanuel Hugonnet, reviewed by aweisberg for CASSANDRA-9046",['DatabaseDescriptor.java'],CASSANDRA-9
ac46747f84e62f6c9cbad0fb2e67a0eb95f43b01,"Fix failed bootstrap/replace attempts being persisted in system.peers

Patch by brandonwilliams, reviewed by slebresne for CASSANDRA-9180",['StorageService.java'],CASSANDRA-9
f59df2893b66b3a8715b9792679e51815982a542,"Allow takeColumnFamilySnapshot to take a list of tables
patch by Sachin Jarin; reviewed by Nick Bailey for CASSANDRA-8348","['StorageService.java', 'NodeProbe.java']",CASSANDRA-8348
a5bae1f5df764d7238cda7ab894d3c36d028f778,"Fix running with java.net.preferIPv6Addresses=true
patch by Andrey Trubachev; reviewed by Ariel Weisberg for CASSANDRA-9137",['CassandraDaemon.java'],CASSANDRA-9137
dcde8cac0d6d96c342c6409a189edc372ddcb203,"Fix failed bootstrap/replace attempts being persisted in system.peers

Patch by brandonwilliams, reviewed by slebresne for CASSANDRA-9180",['StorageService.java'],CASSANDRA-9
cba1b68dbececb2aba500d56059e99bdab058b10,"Fix failed bootstrap/replace attempts being persisted in system.peers

Patch by brandonwilliams, reviewed by slebresne for CASSANDRA-9180",['StorageService.java'],CASSANDRA-9
ee9bd549e83a157ae727f2e38c921694fffda52d,"Fix failed bootstrap/replace attempts being persisted in system.peers

Patch by brandonwilliams, reviewed by slebresne for CASSANDRA-9180",['CassandraDaemon.java'],CASSANDRA-9
1f65a12c33e730b9f5bd56e6c8d00ed39bc456a1,"Fix detected leaks in unit tests

Patch by Stefania Alborghetti; reviewed by Tyler Hobbs for
CASSANDRA-9134",['SSTableReader.java'],CASSANDRA-9
df014036bb720895837a44d0273ff41ebc357cba,"Make anticompactions visible in compactionstats

Patch by marcuse; reviewed by yukim for CASSANDRA-9098",['CompactionManager.java'],CASSANDRA-9
3510bdb503c2a9d97cb12fd7d9e1a01fd91fa879,"Fix various unit-test failures

Patch by jmckenzie; reviewed by branimir for CASSANDRA-9104",['DatabaseDescriptor.java'],CASSANDRA-9104
194bad22f71da3007a7f9ab5561d6f211d140c45,"Add pre-startup checks to detect potential incompatibilities

patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko for
CASSANDRA-8049",['CassandraDaemon.java'],CASSANDRA-8049
cefaa4eb7168a63bbe5b04ad7b9bc093a34f4bb8,"Close incoming connections when MessagingService is stopped

Patch by Sergio Bossa, reviewed by brandonwilliams for CASSANDRA-9238",['MessagingService.java'],CASSANDRA-9
5fcf8dfad2f2c370db89562695b53ae4ee77a33d,"Reduce runWithCompactionsDisabled poll interval to 1ms

patch by ariel; reviewed by benedict for CASSANDRA-9271",['ColumnFamilyStore.java'],CASSANDRA-927
6d06f32a7729524a195ad67ba82157e390dc3912,"Fix anticompaction blocking ANTI_ENTROPY stage

patch by yukim; reviewed by sankalp kohli for CASSANDRA-9151","['CompactionManager.java', 'StorageService.java']",CASSANDRA-9
0db1431e33659392b11060451c71d006941a0dda,"Eliminate race during auth keyspace setup

patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko for
CASSANDRA-9201",['StorageService.java'],CASSANDRA-9
d9836e0efe66c0cc0e33f32b605f6920893fa7a5,"Fix invalidation of prepared statements on function drops

patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko for
CASSANDRA-9166",['SelectStatement.java'],CASSANDRA-9
369966a2af65aa1d8e8248307ebd187fccacbd8e,"Fix error when dropping table during compaction

patch by benedict; reviewed by tjake CASSANDRA-9251","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-9
15235ee63be2d8f39486ff97dbbdd8ed24bb9812,"Add ks and table to err log about large collections

Patch by Carl Yeksigian; reviewed by Tyler Hobbs for CASSANDRA-9286",['SelectStatement.java'],CASSANDRA-9
93478ab46c88d6fd198db67ed3ba25251cc30c8c,"Wait for anticompaction to finish

patch by yukim; reviewed by marcuse for CASSANDRA-9097",['StorageService.java'],CASSANDRA-9
fa4a020ac922fcdc0f3c2bebe35777cfa2e223c1,"Don't start Thrift rpc by default (CASSANDRA-9319)

patch by Aleksey Yeschenko; reviewed by Jonathan Ellis for
CASSANDRA-9319",['Config.java'],CASSANDRA-9319
bed42c2104ebaac83da4292703c08a5c963e062c,"Fix counting of tombstones for TombstoneOverwhelmingException

patch by Aleksey Yeschenko; reviewed by Tyler Hobbs for CASSANDRA-9299",['ColumnFamilyStore.java'],CASSANDRA-9
33cf701d1d6b8112b66d02416224bb782e48b287,"Warn when rpc_max_threads is set very high

Patch by brandonwilliams, reviewed by jbellis for CASSANDRA-9364",['DatabaseDescriptor.java'],CASSANDRA-9
9f7ab09f733659c94e918db03d72e6a860d654b4,"Fix streaming not holding ref when stream error

also fix crc validation error by not streaming early opened SSTable.

patch by yukim; reviewed by benedict for CASSANDRA-9295",['ColumnFamilyStore.java'],CASSANDRA-9
ea1d1614211b01d86d440dce8fe1a60a0bc3c7c1,"Clean up MessagingService.allNodesAtLeast21 and related digest logic

patch by Aleksey Yeschenko; reviewed by Brandon Williams for
CASSANDRA-9368",['MessagingService.java'],CASSANDRA-9
79e1e8062703f12b5c181ccfc72fe10d293920a5,"Swap all references to 3.0 with 2.2

patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko for
CASSANDRA-9352","['MessagingService.java', 'StorageService.java']",CASSANDRA-9
5012463b60e31c78a5a2af5e0ca78b64e4dc38a6,"Populate TokenMetadata early during startup.

Patch by marcuse; reviewed by thobbs for CASSANDRA-9317","['CassandraDaemon.java', 'StorageService.java']",CASSANDRA-9
7d6a60ddd0e156f6028c05d97fa9179f86fe02ee,"Fix canonical view returning early opened SSTables

patch by benedict; reviewed by yukim for CASSANDRA-9396",['ColumnFamilyStore.java'],CASSANDRA-9
6c0a4626249af927077bed552533eac2e3ed16a8,"Add a flag in cassandra.yaml to enable UDFs

patch by Robert Stupp; reviewed by Aleksey Yeschenko for CASSANDRA-9404","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-9
bdbc61ff722db1ad7a0803ba82024345adb17f2a,"Use configured gcgs when anticompacting

Patch by marcuse; reviewed by jbellis for CASSANDRA-9397",['CompactionManager.java'],CASSANDRA-9
be9eff573342cd4993eb4fc8ee694dc885e8a8e4,"Add option to not validate atoms during scrub

patch by Jordan West; reviewed by yukim for CASSANDRA-9406","['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-9
a53a6cedac2cae622937fe8118d2cf20abcf247a,"Decommissioned nodes will not rejoin the cluster.

Patch by brandonwilliams, reviewed by carlyeks for CASSANDRA-8801",['StorageService.java'],CASSANDRA-880
2b1e6aba405002ce86d5badf4223de9751bf867d,"Change gossip stabilization to use endpoit size

Patch by brandonwilliams, reviewed by thobbs for CASSANDRA-9401",['CassandraDaemon.java'],CASSANDRA-9
ae0486132e5aa7e49868aa36945829ce59067815,"Improve row count estimate

Patch by Chris Lohfink; reviewed by Sam Tunnicliffe & Aleksey Yeschenko
for CASSANDRA-9107","['ColumnFamilyStore.java', 'NodeProbe.java']",CASSANDRA-9
4362e71e55295067fd8de3a3206e0ff179bfcaf9,"Lower sleep time to avoid timeout of IndexSummaryManagerTest.testCompactionRace

patch by awiesberg; reviewed by tjake for CASSANDRA-9271",['CompactionManager.java'],CASSANDRA-927
63165a719cd8ec9d7f06c186f61d39403e192edc,"Fix error executing bound statement after adding a collection

patch by blerer; reviewed by slebresne for CASSANDRA-9411",['SelectStatement.java'],CASSANDRA-9
7aafe053e7ffffc3b2e4ac1b2a444749df3dbbaa,"Add Static Analysis to warn on unsafe use of Autocloseable instances

Patch by tjake and carlyeks, reviewed by benedict for CASSANDRA-9431","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'MessagingService.java', 'StorageProxy.java']",CASSANDRA-943
eaeabffc8e0153922fda9b3d5f79abfd8dc1c119,"Avoid getting unreadable keys during anticompaction

Patch by marcuse; reviewed by benedict for CASSANDRA-9508",['CompactionManager.java'],CASSANDRA-950
23d7a558ee824a22d382e1b645814638a2cd2985,"Clean up gossiper logic for old versions

Patch by brandonwilliams, reviewed by aleksey for CASSANDRA-9370",['StorageService.java'],CASSANDRA-9
b2e4d10155afa3618ba1a9066c6ffc13489c73d8,"Make it possible to run dc local repairs

Patch by marcuse; reviewed by yukim for CASSANDRA-9521",['StorageService.java'],CASSANDRA-952
6250065089b80d02d54908212d2b5f45037720f2,"Ensure truncate without snapshot cannot return corrupt responses

patch by benedict; reviewed by aleksey for CASSANDRA-9388",['ColumnFamilyStore.java'],CASSANDRA-9
b9a89a3accbf804807ef2887b37e50e7b89f0044,"Ensure truncate without snapshot cannot return corrupt responses

patch by benedict; reviewed by aleksey for CASSANDRA-9388",['ColumnFamilyStore.java'],CASSANDRA-9
7df3a5c99da4a352b3b8599b2965a86dec1777e5,"Remove wrapping compaction strategy

Patch by marcuse; reviewed by JoshuaMcKenzie for CASSANDRA-9342","['ColumnFamilyStore.java', 'CompactionManager.java', 'CassandraDaemon.java']",CASSANDRA-9342
4a61ca6878c0895486fe84c075708da0514a2a5e,"Remove unused filterSSTablesForReads

Patch by marcuse; reviewed by Jeremiah Jordan for CASSANDRA-9553",['ColumnFamilyStore.java'],CASSANDRA-955
79a9d437442c37b1cf49700ce1d618d25cab8a52,"Make sure we cancel non-compacting sstables from LifecycleTransaction

Patch by marcuse; reviewed by benedict for CASSANDRA-9566","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-956
cab33a60957525854238c61f9360ba58d04d318b,"Fix deprecated repair JMX API

patch by yukim; reviewed by marcuse for CASSANDRA-9570",['StorageService.java'],CASSANDRA-957
ec52e77ecde749e7c5a483b26cbd8041f2a5a33c,"Periodically submit background compaction tasks

patch by benedict; reviewed by yukim for CASSANDRA-9592","['ColumnFamilyStore.java', 'CompactionManager.java', 'CassandraDaemon.java']",CASSANDRA-9
07bb8f98e07f10308d65c264fe29f8c5ee8d4f4f,"Add nodetool replaybatchlog command

Patch by carlyeks; reviewed by tjake for CASSANDRA-9547",['NodeProbe.java'],CASSANDRA-9
514dcd944c400a8a540962f54e16561d56496425,"Add logback metrics

patch by yukim; reviewed by Jeremiah Jordan for CASSANDRA-9378",['CassandraDaemon.java'],CASSANDRA-9
9966419dbda995421f41ccc769d3b89d63940c82,"Make rebuild only run one at a time

patch by yukim; reviewed by jmckenzie for CASSANDRA-9119",['StorageService.java'],CASSANDRA-911
f32cff8e1fb69317219ffaee81b5861a54b83a1b,"Expose some internals of SelectStatement for inspection by QueryHandlers

patch by Sam Tunnicliffe; reviewed by Benjamin Lerer and Mick Semb Wever
for CASSANDRA-9532",['SelectStatement.java'],CASSANDRA-9
42ea6e1f3751845bd0d1326ab789a53a20783a53,"Fix bug in cardinality estimation when sstables are being compacted

patch by tjake; reviewed by benedict for CASSANDRA-9580",['SSTableReader.java'],CASSANDRA-9
d6d32d26ffd9aa17aa991c8c003e53632e5ba1c0,"Change Windows Kernel default timer resolution

Patch by jmckenzie; reviewed by tjake for CASSANDRA-9634","['Config.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-963
9a3fa887cfa03c082f249d1d4003d87c14ba5d24,"Add algorithmic token allocation

patch by branimir; reviewed by benedict for CASSANDRA-7032","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-70
3caf0e02970b8da90d154d81d769662057d7c772,"ColumnFamilyStore.selectAndReference may block during compaction

patch by benedict; reviewed by aleksey for CASSANDRA-9637",['ColumnFamilyStore.java'],CASSANDRA-963
f797bfa4da53315b49f8d97b784047f33ba1bf5f,"Migrate CQL tests from dtest to unit tests

Patch by stefania; reviewed by jmckenzie for CASSANDRA-9160","['DatabaseDescriptor.java', 'SelectStatement.java', 'ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-9160
01115f72fc50b603ece0a00431308abec24706b7,2.2 commit for CASSANDRA-9160,"['DatabaseDescriptor.java', 'SelectStatement.java', 'StorageProxy.java']",CASSANDRA-9160
628394a6fad134dee3d1ec340b88ffcba51e67e7,"Allow JMX over SSL directly from nodetool

patch by Marcus Olsson, reviewed by jasobrown for CASSANDRA-9090",['NodeProbe.java'],CASSANDRA-9
f2db756abd135cc6ca4cf657d29fb2601764d50f,"Fix suboptimal 2i selection when clustering col is indexed

Patch by Benjamin Lerer; reviewed by Tyler Hobbs for CASSANDRA-9631",['SelectStatement.java'],CASSANDRA-963
353d4a052c866cb230e06e69e99d9c5c8c8d955c,"Improve trace messages for RR

patch by Robert Stupp; reviewed by Jason Brown for CASSANDRA-9479",['MessagingService.java'],CASSANDRA-9
0bdf92350bcc9e21373da81ca0c5a1c7d77ec122,"Ensure unique timestamp locally for paxos

patch by stefania; reviewed by slebresne for CASSANDRA-9649",['StorageProxy.java'],CASSANDRA-964
fe65707f09dd2c17cc6339407c689b42ac487256,"Ensure unique timestamp locally for paxos (2.1+ version)

patch by slebresne; reviewed by stefania for CASSANDRA-9649",['StorageProxy.java'],CASSANDRA-964
a991b64811f4d6adb6c7b31c0df52288eb06cf19,"Storage engine refactor, a.k.a CASSANDRA-8099

Initial patch, see ticket for details","['DatabaseDescriptor.java', 'SelectStatement.java', 'ColumnFamilyStore.java', 'SinglePartitionReadCommand.java', 'CompactionManager.java', 'SSTableReader.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-8099
6e1033bc964227566e952b3b68604a6b74a984a6,"Replace the map in KSMetaData with the new immutable Tables container

patch by Aleksey Yeschenko; reviewed by Robert Stupp for CASSANDRA-9677","['CassandraDaemon.java', 'StorageService.java']",CASSANDRA-96
31e3f612b113a76ca8c04a3a86aa6df3915ad055,"Factor out KSMetaData.KeyspaceParams

patch by Aleksey Yeschenko; reviewed by Robert Stupp for CASSANDRA-9677","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-96
a89597da137ad55a5a1b5268ff414c3c1effce10,"Rename and move config.KSMetaData to schema.KeyspaceMetadata

patch by Aleksey Yeschenko; reviewed by Robert Stupp for CASSANDRA-9677",['StorageService.java'],CASSANDRA-96
e89d54865ed9e69cb2b0081559936d1d2ee9b7c7,"Change hinted_handoff_enabled yaml setting, JMX

patch by Stefania Alborghetti; reviewed by Aleksey Yeschenko for
CASSANDRA-9035","['Config.java', 'DatabaseDescriptor.java', 'StorageProxy.java', 'NodeProbe.java']",CASSANDRA-9035
3504a50bb4bd93edeb2941dccd9444d53a85a1ed,"Fix setting 'durable_writes' in ALTER KEYSPACE

patch by Carl Yeksigian; reviewed by Aleksey Yeschenko for
CASSANDRA-9560",['ColumnFamilyStore.java'],CASSANDRA-956
03f72acd546407c7f9de2a976de31dcd565dba9a,"Switch to DataInputPlus

patch by ariel; reviewed by benedict for CASSANDRA-9499","['SinglePartitionReadCommand.java', 'MessagingService.java']",CASSANDRA-9499
b757db1484473b264bf25ca5541f080d54a579a2,"Ensure memtable book keeping is not corrupted in the event we shrink usage

patch by benedict; reviewed by tjake for CASSANDRA-9681",['ColumnFamilyStore.java'],CASSANDRA-96
2a294e45aa023af28ccc179c5f41410940ef40d7,"Bug fixes to SelectionColumnMapping

Patch and review by Benjamin Lerer and Sam Tunnicliffe for
CASSANDRA-9636",['SelectStatement.java'],CASSANDRA-963
07d38b03aed48d733faa06f16eb69954322f10fc,"remove StorageProxy.OPTIMIZE_LOCAL_REQUESTS

patch by Stefania Alborghetti; reviewed by Robert Stupp for CASSANDRA-9697",['StorageProxy.java'],CASSANDRA-96
2595e74f68a019f116d2dabaf1febc95d1ca5d38,"Eliminate strong self-reference chains in sstable ref tidiers

patch by benedict; reviewed by branimir for CASSANDRA-9656",['SSTableReader.java'],CASSANDRA-9656
921eb7e8065221be586f63c64f9b1de582136ca5,"Warn when an extra-large partition is compacted, CASSANDRA-9643","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-9643
492c65a677c02727c6186be801eb81763b7a312d,"Warn when an extra-large partition is compacted, CASSANDRA-9643","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-9643
fae9d3beac5b64bb9d16a412c4db1734f838b631,"Warn when an extra-large partition is compacted, CASSANDRA-9643","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-9643
b7ae07e5c3e4e87c374ee580890c9a00c113f320,"Re-enable memory-mapped I/O on Windows

Patch by jmckenzie; reviewed by tjake for CASSANDRA-9658","['DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-965
ec320e8a1dd01b547d2e2cb3f0d1b994e814bda0,"Follow-up to CASSANDRA-9656, fixing:
  * DataTracker.getCurrentVersion
  * keyCache wiring
  * offline totalDiskSpaceUsed maintenance, affecting unit tests",['SSTableReader.java'],CASSANDRA-9656
452d6a445a6935d3e7d0e0fdf59e87d2a2ff95e7,"Scrub (recover) sstables even when -Index.db is missing

patch by mck; reviewed by stefania for CASSANDRA-9591",['SSTableReader.java'],CASSANDRA-9
f283ed29814403bde6350a2598cdd6e2c8b983d5,"Fix growing pending background compaction

patch by yukim; reviewed by benedict for CASSANDRA-9662","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-966
52dbc3f1ba7a97654c305f4f9c4af008b450e9b0,"Can't transition from write survey to normal mode

patch by jasobrown; reviewed by driftx for CASSANDRA-9740",['StorageService.java'],CASSANDRA-9
2c9b490c972a7d7bca698d03c2a212fcf22a7a63,"checkForEndpointCollision fails for legitimate collisions, CASSANDRA-9765",['StorageService.java'],CASSANDRA-9765
7d6c876ec9f8dd143046ff49b5d61066ad5206c1,"Move schema tables to the new system_schema keyspace

patch by Aleksey Yeschenko; reviewed by Tyler Hobbs for CASSANDRA-6717","['SSTableReader.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-6717
1ecccede7d9252dd4eacdc31da6b5120d0fded9c,"Handle corrupt files on startup

Patch by stefania; reviewed by marcuse for CASSANDRA-9686","['SSTableReader.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-96
54470a25f3c3c9ce6cb600c798ddcfe5e3962768,"checkForEndpointCollision fails for legitimate collisions, improved version after CR, CASSANDRA-9765",['StorageService.java'],CASSANDRA-9765
0bd5170c4ff55c9f3307602de031d77883731883,"Metrics should use up to date nomenclature

patch by Stefania Alborghetti; reviewed by yukim for CASSANDRA-9448","['ColumnFamilyStore.java', 'SinglePartitionReadCommand.java', 'SSTableReader.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-9448
8d7c608bac9440911f4803db04f306f0616f2a22,"Rename ColumnDefinition.Kind.CLUSTERING_COLUMN to CLUSTERING

patch by Aleksey Yeschenko; reviewed by Tyler Hobbs for CASSANDRA-6717",['SelectStatement.java'],CASSANDRA-6717
506068b181075281f160fde5fd7ffecf45177b2d,"JDK bug prevents clean shutdown on OSX with Java 1.8.0_20

patch by Robert Stupp; reviewed by Aleksey Yeschenko for CASSANDRA-8220",['MessagingService.java'],CASSANDRA-8220
e726cf6d6b1a21abd0b7cf35775b7a980b1009ed,"Expose SelectStatement.Parameters fields for QueryHandler implementors

patch by Jeremiah D Jordan; reviewed by Aleksey Yeschenko for
CASSANDRA-9858",['SelectStatement.java'],CASSANDRA-985
2457599427d361314dce4833abeb5cd4915d0b06,"Simplify some 8099's implementations

patch by slebresne; reviewed by iamalesky for CASSANDRA-9705","['SelectStatement.java', 'SinglePartitionReadCommand.java']",CASSANDRA-9
eae3b02649789f1993147d5580a7b20794212319,"Reverted partitionCache metric names to rowCache, CASSANDRA-9448",['SinglePartitionReadCommand.java'],CASSANDRA-9448
5790b4a44ba85e7e8ece64613d9e6a1b737a6cde,"Implement proper sandboxing for UDFs

patch by Robert Stupp; reviewed by T Jake Luciani for CASSANDRA-9402","['Config.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-9
7a6c3272e3bb6b69ec55bb362ddad5978b4fb35f,"Disable UDFs again

patch by Robert Stupp; reviewed by Aleksey Yeschenko for CASSANDRA-9402",['Config.java'],CASSANDRA-9
b09e60f72bb2f37235d9e9190c25db36371b3c18,"Introduce safer durable sstable membership management
(and simplify cleanup of compaction leftovers)

Instead of using temporary files and system tables,
this patch introduces a simple transaction log for sstable
membership edits that can be committed/aborted atomically
and simply replayed on startup.

patch by stefania; reviewed by benedict for CASSANDRA-7066","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-7066
573a1d115b86abbe3fb53ff930464d7d8fd95600,"Log when messages are dropped due to cross_node_timeout

Patch by Stefania, reviewed by brandonwilliams for CASSANDRA-9793",['MessagingService.java'],CASSANDRA-9793
9ed0f30a4df488e644cb048d39e31e7ae8c23c5b,"Log when messages are dropped due to cross_node_timeout

Patch by Stefania, reviewed by brandonwilliams for CASSANDRA-9793",['MessagingService.java'],CASSANDRA-9793
6f0c7d9f451c653f3a728bd8ee597fc32bd48d2c,"Log when messages are dropped due to cross_node_timeout (CASSANDRA-9793)

Patch by Stefania, reviewed by brandonwilliams for CASSANDRA-9793",['MessagingService.java'],CASSANDRA-9793
ad8cad7c4d05fd5dea68fb274c81a102533ebe36,"Make choice of SSTableReader types explicit

All accessors of a collection of SSTableReader must now
specify whether they desire the LIVE or CANONICAL set, so
that no internal clients are accidentally exposed to a partial
sstable they are not capable of safely handling.

patch by benedict; reviewed by marcus for CASSANDRA-9699","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java']",CASSANDRA-96
a7f41345ac71826574d09d56ebd402d0ddc3ea3f,"Strong Leak Detection

When -Dcassandra.debugrefcount=true the globally extant Ref
instances will be walked looking for instances that cannot
ordinarily be reached, and for circular self references.
Errors will be logged for any found.

patch by benedict; reviewed by snazy for CASSANDRA-9423",['SSTableReader.java'],CASSANDRA-9
8f70bb2f5d820079134cdef570d3c16083bc8c91,"Permit disabling commit log segment recycling, and disable by default

patch by benedict; reviewed by driftx for CASSANDRA-9896","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-989
878d6164278257fae05adba7402d849b7735162e,"Don't track hotness when opening from snapshot for validation

patch by yukim; reveiwed by benedict for CASSANDRA-9382","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-9
df3b6027bc90c658963e7bf72933b1507c6c6beb,"ScrubTest should generate out-of-order SSTable on the fly

with some other ScrubTest fixes.

patch by yukim; reviewed by Stefania Alborghetti for CASSANDRA-9880",['SSTableReader.java'],CASSANDRA-9
69f77cbddd4c74448f227e9aceef84d345118184,"Stop accessing the partitioner directly via StorageService

Changes the way the partitioner is accessed. Partitioner is now stored
and accessed according to the reason for needing it:
* if it is to access a table / prepare a statement, the partitioner
relevant to this table can be found in its CFMetaData.
* if it is to route messages to the relevant member of the cluster, the
partitioner in TokenMetadata is to be used.

patch by Branimir Lambov; reviewed by Aleksey Yeschenko for
CASSANDRA-8143","['DatabaseDescriptor.java', 'SelectStatement.java', 'ColumnFamilyStore.java', 'SinglePartitionReadCommand.java', 'CompactionManager.java', 'SSTableReader.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-8143
37160e109ede17c8cbffd553fcb24efa8d43b141,"Add transparent data encryption core classes

patch by jasobrown, reviewed by snazy for CASSANDRA-9945","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-9945
8f9ca07e9a0140d93224bf941fa4f6315e5093cf,"Cannot replace token does not exist - DN node removed as Fat Client

patch by Stefania, reviewed by jasobrown for CASSANDRA-9871",['StorageService.java'],CASSANDRA-987
45bd07f6fe2269a8bc68f1c11524b3a3f80f4f23,"Dont cast expected bloom filter size to int

Patch by marcuse; reviewed by Jason Brown for CASSANDRA-9959",['CompactionManager.java'],CASSANDRA-995
5a54d9a6240daa9e58dde702245f574002a42783,"Log warning when using an aggregate without partition key

patch by Robert Stupp; reviewed by Aleksey Yeschenko for CASSANDRA-9737",['SelectStatement.java'],CASSANDRA-9
e37d577b6cfc2d3e11252cef87ab9ebba72e1d52,"Disable scripted UDFs by default

patch by Robert Stupp; reviewed by Aleksey Yeschenko for CASSANDRA-9889","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-9
47341eb6aaca318d0ffc0e9f906b98db50b9e9ff,Add transparent data encryption core classes (CASSANDRA-9945),"['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-9945
b31845c4a7982358a7c5bfd9bcf572fda6c1bfa9,"Factor out TableParams from CFMetaData

patch by Aleksey Yeschenko; reviewed by Robert Stupp for CASSANDRA-9712","['ColumnFamilyStore.java', 'SinglePartitionReadCommand.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-9712
64e93a76d8065e2cadeffbc04d28c995dcc9bc0c,"Fix remaining dtest failures caused by CASSANDRA-8143

patch by Branimir Lambov; reviewed by Aleksey Yeschenko for
CASSANDRA-8143","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-8143
20f12e97446eee55461a8d3512a94389a67e79ee,"Fix nodetool info error when the node is not joined

patch by yukim; reviewed by stefania for CASSANDRA-9031",['NodeProbe.java'],CASSANDRA-9
765ab3fc3b9f4e891c257f36f117ddf4232da6be,Add transparent data encryption core classes (CASSANDRA-9945),"['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-9945
0dd50a6cdc81ec9ff1367238876d476affcf60e2,"Repair common subranges of a set of nodes in one session
reviewed by Stefania Alborghetti for CASSANDRA-5220","['CompactionManager.java', 'MessagingService.java']",CASSANDRA-5220
ef5962442e7e00646ed5e67486f2cfee504ce961,"Revert ""Add transparent data encryption core classes (CASSANDRA-9945)""

This reverts commit 765ab3fc3b9f4e891c257f36f117ddf4232da6be.","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-9945
762db474273f764b189d3613fce33943cd64701b,"Optimize batchlog replay to avoid full scans

patch by Branimir Lambov; reviewed by Aleksey Yeschenko for
CASSANDRA-7237","['ColumnFamilyStore.java', 'StorageProxy.java']",CASSANDRA-723
16498de42d1e173f39d7edeba5ab7d567e609cc6,"Fix Verb.BATCHLOG_MUTATION usages in StorageProxy

patch by Carl Yeksigian; reviewed by Aleksey Yeschenko for
CASSANDRA-9992",['StorageProxy.java'],CASSANDRA-999
39ee04088cfd2926ed27490267b9f562472f5647,"Fixup unsued Verb.MATERIALIZEDVIEW_MUTATION

patch by Aleksey Yeschenko for CASSANDRA-9993","['DatabaseDescriptor.java', 'MessagingService.java', 'StorageService.java']",CASSANDRA-999
fa6205c909656b09165da4b5ca469328a6450917,"Add checksum to saved cache files

patch by Daniel Chia; reviewed by Ariel Weisberg for CASSANDRA-9265",['DatabaseDescriptor.java'],CASSANDRA-9265
e9b975c279578fe2d6f25368fe2839e1d0572371,"Release the self ref when opening snapshot sstable readers

Patch by marcuse; reviewed by benedict for CASSANDRA-9998",['ColumnFamilyStore.java'],CASSANDRA-999
4d1b8b418609bd2c431a0ea905a667ddaaa50bbe,"Return dropped messages log to INFO level

CASSANDRA-9793 accidentally changed the logging level to ERROR",['MessagingService.java'],CASSANDRA-9793
8c64cefd19d706003d4b33b333274dbf17c9cb34,"On-wire backward compatibility for 3.0

This adds support for mixed-version clusters with Cassandra 2.1
and 2.2.

Patch by Tyler Hobbs and Sylvain Lebresne for CASSANDRA-9704","['SinglePartitionReadCommand.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-9704
489a9e8fa91ab6680b2a3857ed4e97f7cf2677ba,"Introduce our own AbstractIterator, that is easier for debugging

patch by benedict; reviewed by ariel for CASSANDRA-9985",['StorageProxy.java'],CASSANDRA-9
3b7934f1aa20d2210866afd9b88472e9cb1aed8d,"Ensure commit log stop policy is enforced at startup

patch by paulo; reviewed by benedict for CASSANDRA-8515",['CassandraDaemon.java'],CASSANDRA-851
de84a5c770ac1a429152dd79f0895b27aa544368,"Allows single-column slice restrictions to be merged with multi-columns slice restrictions

patch by Benjamin Lerer; reviewed by Sam Tunnicliffe for CASSANDRA-9606",['SelectStatement.java'],CASSANDRA-96
c8d163f73cad4cb61c12c6871e26489b52094d17,"Allows single-column slice restrictions to be merged with multi-columns slice restrictions

patch by Benjamin Lerer; reviewed by Sam Tunnicliffe for CASSANDRA-9606",['SelectStatement.java'],CASSANDRA-96
5aca7d79aaf88f9c34dcae52f24bb62a28add91e,"Add new JMX methods to change local compaction strategy

Patch by marcuse; reviewed by iamaleksey for CASSANDRA-9965",['ColumnFamilyStore.java'],CASSANDRA-9965
76e8eb853f4534703f5a0b6754b514e62915d65a,Fixup missed nit from CASSANDRA-9965,['ColumnFamilyStore.java'],CASSANDRA-9965
e98be186d1e39c45aa34e6ea995f0bf718b99015,"Fix Select * is only returning the first page of data

patch by Benjamin Lerer; reviewed by Stefania Alborghetti for CASSANDRA-9913",['SelectStatement.java'],CASSANDRA-9
45c04b72753a738cb4a8af7025ad4cb10a12c452,"Fix race condition on proximal SecondaryIndex drop/create

When a SecondaryIndex is dropped and recreated immediately,
the old files (and transaction logs) can be reused erroneously.
This patch ensures all such files have either been deleted or are
in a transaction log marking them deleted before a SecondaryIndex
is recreated, and that reading a missing TransactionLog does not fail.

patch by stefania; reviewed by benedict for CASSANDRA-9908",['ColumnFamilyStore.java'],CASSANDRA-990
1a9286c07a5c168df677da9d6be7178d087ea005,"Change authorization handling for MVs

patch by Paulo Motta; reviewed by Aleksey Yeschenko for CASSANDRA-9927",['SelectStatement.java'],CASSANDRA-9
fe388d40c0b019c55c63c914ef5708f245af6cdd,"Improve SerializationHeader response serialization

Replicas serving requests now retain the columns that were requested,
and use these to efficiently encode the subset of columns it responds
with. The expectation is that a majority of those requested will be
present in the response.

For fewer than 64 requested columns, or where all requested are returned,
a bitmap of missing columns is sent (i.e. a 0 when all are present),
encoded as a vint. Otherwise a count is sent, followed by a sequence
of either present or missing columns, whichever is more efficient.

patch by benedict; reviewed by ariel for CASSANDRA-9894",['StorageProxy.java'],CASSANDRA-989
e51f83b60edf1f9ee12ef6a3083d3acbf85805f7,"Remove ArrayBackedPartition and hierarchy

Introduces AbstractBTreePartition to share code between
ImmutableBTreePartition and AtomicBTreePartition,
eliminating much code duplication between the two hierarchies.

patch by benedict; reviewed by ariel for CASSANDRA-9932",['SinglePartitionReadCommand.java'],CASSANDRA-993
9a6ee93f63301d03ff1d20032e6d80f806a14d5d,"Route gossip messages over dedicated socket

patch by awiesberg; reviewed by jasobrown for CASSANDRA-9237",['MessagingService.java'],CASSANDRA-9
1db386e46e451250b2375060f92093f670091c02,"add calculation for arrayOffset() and position(), or asserts that the offset is 0
reviewed by Stefania for CASSANDRA-9241",['ColumnFamilyStore.java'],CASSANDRA-9241
3aa7308e8f86969158c8d919c3f77658ae7c4fc3,"Improve assertions around some of the usage of AbstractBounds

patch by Sylvain Lebresne and Ariel Weisberg; reviewed by Aleksey
Yeschenko for CASSANDRA-9462",['ColumnFamilyStore.java'],CASSANDRA-946
f53aacba80de3c3441e1524be9498f6d15c5c411,"Make getFullyExpiredSSTables less expensive.

Patch by marcuse; reviewed by yukim for CASSANDRA-9882",['ColumnFamilyStore.java'],CASSANDRA-9
5726625a5c7cf47a67509540f7146d05b668bc20,"Improve transaction log under FS corruption

To address concerns with recovery from file system
failures, we consolidate the new and old log
files into a single file, introduce checksums to the
file, and record on-disk sstable state to permit
validation of the log file on restart. This permits
us to be pessimistic in the case of any failure,
leaving all affected files on disk.

patch by stefania; reviewed by benedict for CASSANDRA-7066","['ColumnFamilyStore.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-7066
06c130e3cb85577041b475084400c08c505d8f9e,"Move 2i metadata out of system_schema.columns and ColumnDefinition

Patch by Sam Tunnicliffe; reviewed by Aleksey Yeschenko and Robert Stupp
for CASSANDRA-6717","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-6717
96d41f0e0e44d9b3114a5d80dedf12053d36a76b,"Rewrite hinted handoff

patch by Aleksey Yeschenko; reviewed by Benedict Elliott Smith for
CASSANDRA-6230","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-6230
4cc2b67df369bc3e9587b9e4864b8058ca78cdf7,Fix Coverity-flagged CASSANDRA-6230 issues,['DatabaseDescriptor.java'],CASSANDRA-6230
9ed2727739c73d64086d09a86a407a77390f081a,"Give compaction strategies more control over sstable creation

Patch by Blake Eggleston; reviewed by marcuse for CASSANDRA-8671","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-8671
0626be8667aefdcf50a051471f83da90bbae9bcf,"New 2i API and implementations for built in indexes

Patch by Sam Tunnicliffe; reviewed by Sergio Bossa, Sylvain Lebresne and
Aleksey Yeschenko for CASSANDRA-9459

Conflicts:
	src/java/org/apache/cassandra/db/ColumnFamilyStore.java
	src/java/org/apache/cassandra/db/PartitionRangeReadCommand.java
	src/java/org/apache/cassandra/db/compaction/CompactionIterator.java
	src/java/org/apache/cassandra/db/index/AbstractSimplePerColumnSecondaryIndex.java
	src/java/org/apache/cassandra/db/index/PerColumnSecondaryIndex.java
	src/java/org/apache/cassandra/db/index/SecondaryIndexManager.java
	src/java/org/apache/cassandra/db/index/composites/CompositesIndex.java
	src/java/org/apache/cassandra/db/index/composites/CompositesIndexOnClusteringKey.java
	src/java/org/apache/cassandra/db/partitions/AtomicBTreePartition.java
	src/java/org/apache/cassandra/db/partitions/PartitionUpdate.java
	src/java/org/apache/cassandra/index/internal/ColumnIndexSearcher.java
	src/java/org/apache/cassandra/index/internal/composites/CompositesSearcher.java
	src/java/org/apache/cassandra/index/internal/keys/KeysSearcher.java
	src/java/org/apache/cassandra/io/sstable/format/SSTableReader.java
	test/unit/org/apache/cassandra/schema/DefsTest.java
	test/unit/org/apache/cassandra/schema/LegacySchemaMigratorTest.java","['SelectStatement.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageProxy.java']",CASSANDRA-945
147fe6d69d2efac8db47da9058e9a19f8ddc99fd,"Follow up to avoid mutating row while read repair is happening

Patch by tjake; reviewed by Stefania for CASSANDRA-9460",['StorageProxy.java'],CASSANDRA-9460
7e1ea4c8c1af0809b990c27648edbff2efb2434a,"Change streaming_socket_timeout_in_ms default

patch by Robert Coli; reviewed by Benjamin Lerer for CASSANDRA-8611",['Config.java'],CASSANDRA-861
8bc32ba081d7da6b2f39b500de09ef1a4c44ac9d,"Fall back to 1/4 commitlog volume for commitlog_total_space on small disks
reviewed by aweisberg for CASSANDRA-10199",['DatabaseDescriptor.java'],CASSANDRA-10199
8a8a5a42862a9cbe5a7c73932ac315acd7b2190f,"Only check KeyCache when it is enabled

patch by Chris Burroughs; reviewed by Robert Stupp for CASSANDRA-9872",['SSTableReader.java'],CASSANDRA-987
0d2f4038fc2564c695d0d8c4b1ad523ec1afaceb,"Defer initialization of default RoleManager until IAuthenticator is set
reviewed by jbellis for CASSANDRA-10209",['DatabaseDescriptor.java'],CASSANDRA-10209
782a1c3aecffb8674338fbd9ceeb56a357ecc3f2,"Avoid digest mismatches on upgrade to 3.0

patch by slebresne; reviewed by blambov for CASSANDRA-9554",['SinglePartitionReadCommand.java'],CASSANDRA-955
53a177a9150586e56408f25c959f75110a2997e7,"Improve batchlog write path

patch by Stefania Alborghetti; reviewed by Aleksey Yeschenko for
CASSANDRA-9673","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-96
9b8e1870294d4b3b277e74e7bef13e52b6b3d57e,"Retry snapshot deletion after compaction and gc on Windows

Patch by jmckenzie; reviewed by stefania for CASSANDRA-10222",['CompactionManager.java'],CASSANDRA-10222
8ebd5904734d102e580c95dd2cdeba22de332991,3.0 patch for CASSANDRA-10222,['CompactionManager.java'],CASSANDRA-10222
ce63ccc842dc6e7129765391c611402eb02a3a23,"Faster sequential IO (CASSANDRA-8630)

Merge RandomAccessReader and NIODataInputStream class hierarchies
to share performance optimisation work across all readers.

patch by stefania; reviewed by ariel and benedict for CASSANDRA-8630",['SSTableReader.java'],CASSANDRA-8630
5bc56c3e407f9deb0c931f63b5d6e4c768a0632d,"refuse to decomission if not in state NORMAL
patch by Jan Karlsson and Stefania for CASSANDRA-8741",['StorageService.java'],CASSANDRA-8741
27754c0a41087a2419c09fd99707fd7235cce4ad,"refuse to decomission if not in state NORMAL
patch by Jan Karlsson and Stefania for CASSANDRA-8741",['StorageService.java'],CASSANDRA-8741
25373e9945a3de7a7caf76281098e44bf8c6a8a0,"refuse to decomission if not in state NORMAL
patch by Jan Karlsson and Stefania for CASSANDRA-8741",['StorageService.java'],CASSANDRA-8741
a7895cfb2cdc667041402648bf922265cb0d34c3,"Support for both encrypted and unencrypted native transport connections

patch by Stefan Podkowinski; reviewed by Robert Stupp for CASSANDRA-9590","['Config.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-9
0c0f1ff1b1051627f38a8bf6cb0776241586dfce,"Defer initialization of default RoleManager until IAuthenticator is set

Patch by Sam Tunnicliffe and Carl Yeksigian; reviewed by Jonathan Ellis
for CASSANDRA-10209",['DatabaseDescriptor.java'],CASSANDRA-10209
351c7caca311834f6c5bff08b0204943850214a9,"Handle non-atomic directory streams safely (CASSANDRA-10109)

This patch refactors the lifecycle transaction log and updates
the logic to be robust to non-atomic listings of directories

patch by stefania; reviewed by benedict for CASSANDRA-10109","['ColumnFamilyStore.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-10109
04e789bbcf283fe1d3b16613321ee169fa9f4e27,"Cleanup, scrub and upgrade may unmark compacting early (CASSANDRA-10274)

If an error occured during cleanup, scrub or upgrade
(or any parallelAllSSTableOperation), the caller was immediately
notified of the problem, and the method exited, executing the
finally block that unmarked all of the sstables as compacting.

Since the operations happen in parallel, many may still be running
or waiting to run, and so another operation may operate over the
same sstables, breaking the required mutual exclusivity.

This patch ensures the method is not exited until all operations
have completed, at which point the caller is notified of any
exceptions.

patch by benedict; reviewed by marcus for CASSANDRA-10274",['CompactionManager.java'],CASSANDRA-10274
d769fcb397b6c5937561194b9e8f9dd596ffcd18,"Cleanup, scrub and upgrade may unmark compacting early (CASSANDRA-10274)

If an error occured during cleanup, scrub or upgrade
(or any parallelAllSSTableOperation), the caller was immediately
notified of the problem, and the method exited, executing the
finally block that unmarked all of the sstables as compacting.

Since the operations happen in parallel, many may still be running
or waiting to run, and so another operation may operate over the
same sstables, breaking the required mutual exclusivity.

This patch ensures the method is not exited until all operations
have completed, at which point the caller is notified of any
exceptions.

patch by benedict; reviewed by marcus for CASSANDRA-10274",['CompactionManager.java'],CASSANDRA-10274
b22ad4210cbf9c0c0bd6e595265b162f391da3a1,"Defer auth setup until all nodes are >= 2.2

Patch and review by Sylvain Lebresne and Sam Tunnicliffe for
CASSANDRA-9761",['MessagingService.java'],CASSANDRA-9
0600d7dc03bcf3ce1d881d608afeaa29066fd052,"CFS.loadNewSSTables() broken for pre-3.0 sstables

patch by Robert Stupp; reviewed by Blake Eggleston for CASSANDRA-10237",['ColumnFamilyStore.java'],CASSANDRA-10237
488db6f50662e5e63c382c793d2c7ad69b8c74fc,"Add configurable warning threshold for GC duration

Patch by jmckenzie and achowdhery for CASSANDRA-8907","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-890
257cdaa08dc12f747a25c03b9b0ad3ffc76ace9b,"Fix consolidating racks violating the RF contract

patch by Stefania Alborghetti; reviewed by Blake Eggleston for
CASSANDRA-10238",['StorageService.java'],CASSANDRA-10238
a3a8dbca5cc190caea36c5029d83f02977b6d149,"Improve MV schema representation

patch by Carl Yeksigian; reviewed by Aleksey Yeschenko for
CASSANDRA-9921","['DatabaseDescriptor.java', 'SelectStatement.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-9
c4de752758c3cf7f5de5a92e4ede30e430a36255,"Follow-up to CASSANDRA-10238

call invalidateCacheRings when topology is updated

patch by Stefania Alborghetti; reviewed by Branimir Lambov for
CASSANDRA-10238",['StorageService.java'],CASSANDRA-10238
a29d206532a44f99457af9ddd81d2bc3ed65e63e,"Follow-up to CASSANDRA-8143

stops Schema initializing tables in client mode

patch by Branimir Lambov; reviewed by Aleksey Yeschenko for
CASSANDRA-8143",['SSTableReader.java'],CASSANDRA-8143
e25453ba55d35cac802719c6fb906460f13a9c36,"Moved crc_check_chance out of compression options

Patch by Paulo Motta; reviewed by Sam Tunnicliffe for CASSANDRA-9839","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-983
5a4253b6a17de9810fbc4e1c3b8d4980e26adcca,"Allow MV's SELECT to restrict PK columns

Patch by Tyler Hobbs; reviewed by Sylvain Lebresne for CASSANDRA-9664","['SelectStatement.java', 'SinglePartitionReadCommand.java']",CASSANDRA-9664
c37562e345c24720c55428a8644191df68319812,"Fix Mmapped File Boundaries

This patch fixes two bugs with mmap segment boundary
tracking, and introduces automated correction of
this bug on startup

patch by benedict; reviewed by tjake for CASSANDRA-10357",['SSTableReader.java'],CASSANDRA-10357
bd46463fbb7d6b0998c837450ce61df13eda041d,"Start metrics reporter before bootstrap

Patch by Tommy Stendahl; reviewed by jmckenzie for CASSANDRA-9594",['CassandraDaemon.java'],CASSANDRA-9
557bbbccb0eddc9f2ba6431b023b3ded253de056,"Abort in-progress queries that time out

patch by Stefania; reviewed by aweisberg for CASSANDRA-7392","['SelectStatement.java', 'SinglePartitionReadCommand.java', 'MessagingService.java', 'StorageProxy.java']",CASSANDRA-7392
566799f567b319fdc62c94adfb8ffe4b96085649,"Remove (unsupported) offheap_objects option

patch by slebresne; reviewed by aweisberg for CASSANDRA-10437

The 'objects offheap' allocator is currently not implemented for
Cassandra 3.0. The option will be re-introduced by CASSANDRA-9472
in a future release but in the meantime, the patch properly remove
the (now broken) option.",['DatabaseDescriptor.java'],CASSANDRA-9472
e1fb18a00b598431f52b88d12e2eddbe07233e88,"Followup to CASSANDRA-8671 - additional data directories

Patch by Blake Eggleston; reviewed by marcuse for CASSANDRA-10518",['ColumnFamilyStore.java'],CASSANDRA-8671
f587397c9c41c1a68b4e46fc16bad8d48c975e4d,"Fix sorting for queries with an IN condition on partition key columns

patch by Benjamin Lerer; reviewed by Sam Tunnicliffe for CASSANDRA-10363",['SelectStatement.java'],CASSANDRA-10363
b84ed1176c015552550f30629e240c320a00001b,"JDK bug from CASSANDRA-8220 makes drain die early also

patch by Jeremiah Jordan; reviewed by Robert Stupp for CASSANDRA-10545",['MessagingService.java'],CASSANDRA-8220
3cd750012e0cf3b55442c036627fb032c29c16bc,"Expose phi values from failure detector via JMX

patch by Ron Kuris and Ariel Weisberg; reviewed by Ariel Weisberg and
Brandon Williams for CASSANDRA-9526",['NodeProbe.java'],CASSANDRA-9526
17082d4b54c89fd34f81400e0002fff67c30f150,"Shutdown compaction in drain to prevent leak

patch by yukim; reviewed by marcuse for CASSANDRA-10079","['CompactionManager.java', 'StorageService.java']",CASSANDRA-10079
609497471441273367013c09a1e0e1c990726ec7,"9975: Flatten Iterator Transformation Hierarchy

To improve clarity of control flow, all iterator transformations
are applied via a single class that manages an explicit stack of
named transformation objects.

patch by benedict; reviewed by branimir for CASSANDRA-9975",['StorageProxy.java'],CASSANDRA-9
2ca7599023a1e507f263b0c4854ab26b3ba283ac,"Do not run SizeEstimatesRecorder if a node is not a member of the ring

patch by Paulo Motta; reviewed by Joel Knighton for CASSANDRA-9912",['StorageService.java'],CASSANDRA-9
1c3ff9242a0bfc5c544c69f68ee7b17a464a5ab3,"Invalidate row/counter cache after stream receive task is completed

patch by Paulo Motta; reviewed by yukim for CASSANDRA-10341",['ColumnFamilyStore.java'],CASSANDRA-1034
7e6c1d5483b35ab911113dff0f5fd559760d733b,"Fix SELECT statement with IN restrictions on partition key, ORDER BY and LIMIT

patch by Benjamin Lerer; reviewed by Sylvain Lebresne for CASSANDRA-10729",['SelectStatement.java'],CASSANDRA-1072
7650fc196341bd673626054593f2ce6e895d7783,"Warn or fail when changing cluster topology live

patch by Stefania; reviewed by Paulo Motta for CASSANDRA-10243","['StorageProxy.java', 'StorageService.java']",CASSANDRA-10243
51753263a4c4d50c5bbe7bb80636cca5b6458ecf,"Revert changes to names of public methods on Gossiper

Patch and review by Paulo Motta and Stefania Alborghetti to
follow up CASSANDRA-10243","['StorageProxy.java', 'StorageService.java']",CASSANDRA-10243
9135340a13531930f26fb8175b057342791ff044,Warn if system_traces not available for CASSANDRA-9628,['StorageService.java'],CASSANDRA-9628
fc7075a41837301f3866333e0eb5c464715d888c,"Allow cancellation of index summary redistribution

Patch by Carl Yeksigian; reviewed by marcuse for CASSANDRA-8805",['CompactionManager.java'],CASSANDRA-880
94c361d1a7a63490f1b66f5b10e02579516c5eae,"Add property to allow listening on broadcast_address (CASSANDRA-9748)

patch by pauloricardomg; reviewed by aweisberg for CASSANDRA-9748","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java', 'StorageService.java']",CASSANDRA-9748
a018bcb7d7ae74f9fa3f33cce2f0cc0deed6a442,"Establish bootstrap stream sessions sequentially

patch by Paulo Motta; reviewed by yukim for CASSANDRA-6992",['StorageService.java'],CASSANDRA-699
cae395026af3f82afbbee6d2ab090f985ee006d3,"Add forceUserDefinedCleanup to allow more flexible cleanup

patch by jeffj; reviewed by yukim for CASSANDRA-10708",['CompactionManager.java'],CASSANDRA-10708
c20566fa64031dd30a1f731eee1394264977eb6f,"Implement hints compression

Patch by bdeggleston; reviewed by jmckenzie for CASSANDRA-9428","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-9
260163994e4ac71fafb0578cb143ab4f0f22d6ad,ninja fix to resource leak (CASSANDRA-10708),['CompactionManager.java'],CASSANDRA-10708
6ff1cbb3ee1b7e6f261aeb454854dd249ab605df,"Optimize pending ranges computation

patch by dikanggu; reviewed by blambov for CASSANDRA-9258",['StorageService.java'],CASSANDRA-9258
e2c6341898fa43b0e262ef031f267587050b8d0f,"Make sure the same token does not exist in several data directories

Patch by marcuse; reviewed by Yuki Morishita and Carl Yeksigian for CASSANDRA-6696","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-6696
ffc0840d03014331035f24be3c76aa812973089f,"Commit CASSANDRA-9258 to 3.3+

For some reason I don't fully understand, the patch for CASSANRA-9258
didn't made it from 3.0 to the 3.3 and trunk branches so this commit
it.",['StorageService.java'],CASSANDRA-9258
6d6d1890425e0372debc3acc21f86dce7c08cf37,"Fix inter datacenter streaming default

patch by jeromatron; reviewed by aweisberg for CASSANDRA-9708","['Config.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-9
dbf6e62c382d62f9c1727ecf5afb90d131a81775,"Make sure client gets tombstone overwhelmed warning

patch by Carl Yeksigian; reviewed by Josh McKenzie for CASSANDRA-9465","['SelectStatement.java', 'MessagingService.java', 'StorageProxy.java']",CASSANDRA-946
6c6b7e40c39e0f1d1c37352a19f8bd73c205bc6d,"Improve nodetool status performance for large cluster

patch by yukim; reviewed by Paulo Motta for CASSANDRA-7238",['StorageService.java'],CASSANDRA-723
186777aac55b1aa95c5c9e9cdaff2b981cf9d5af,"Refactor auth caches and add credentials cache

Patch by Sam Tunnicliffe; reviewed by Mike Adamson for CASSANDRA-7715","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-771
71b1c4a63187f746c0caecc41bc07b42dedd3488,"Add sstabledump tool

patch by Chris Lohfink; reviewed by yukim for CASSANDRA-7464",['SSTableReader.java'],CASSANDRA-746
6a4d106287adaf64280dce96632066b6c8d7d194,"Cleanup a few resource warnings

patch by Benjamin Lerer; reviewed by Jason Brown for CASSANDRA-11085",['ColumnFamilyStore.java'],CASSANDRA-1108
0a35341675c6c2026113736f9447f08069b6eb83,"Don't NPE when using forceRepairRangeAsync

Patch by Nick Bailey; reviewed by Paulo Motta for CASSANDRA-11239",['StorageService.java'],CASSANDRA-1123
a20a0f724bee67ccf010cfbb72dbc1f90a1d5b4a,"CASSANDRA-11062 follow-up

patch by Caleb Rackliffe; reviewed by Aleksey Yeschenko for CASSANDRA-11062",['StorageService.java'],CASSANDRA-11062
093454205498bad7094cb8fb362d60e95296b092,"Only log yaml config once, at startup

patch by jasobrown, reviewed by Paulo Motta for CASSANDRA-11217","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-11217
621f446ca4a319adcb50d2479e3fa7121eac6ebd,"Only log yaml config once, at startup

patch by jasobrown, reviewed by Paulo Motta for CASSANDRA-11217","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-11217
965ee082da2b8a3ff5e932e91d261018d9232c75,"Only log yaml config once, at startup

patch by jasobrown, reviewed by Paulo Motta for CASSANDRA-11217","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-11217
2d420e6c2a362c69d1a66076ac7dd2db37ee9306,"Only log yaml config once, at startup

patch by jasobrown, reviewed by Paulo Motta for CASSANDRA-11217","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-11217
c947a2c4228816f0e069b2f6fed4b725c9cb710e,"Ninja: Make Config.log() static to avoid loading ""log"" as a YAML property (broken by CASSANDRA-11217)","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-11217
db68ac9fd791d777df0241ef9bd381eca46bbd20,"Print sensible units for all log messages

patch by Giampaolo Trapasso; reviewed by Joel Knighton for CASSANDRA-9692","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'CassandraDaemon.java']",CASSANDRA-96
105fbb35db228aa47b7de079795d61e748ed8abc,"Backport CASSANDRA-10859

patch by yukim; reviewed by thobbs for CASSANDRA-11415",['NodeProbe.java'],CASSANDRA-10859
21448c50891642f95097a9e5ed0a3802bd90a877,"Add a command to see if a Materialized View has finished building

Patch by Carl Yeksigian; reviewed by Joel Knighton for CASSANDRA-9967","['CassandraDaemon.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-9
2fbddbd9926eac07031196f74c637730a3953dce,"Allow per partition limit in SELECT queries

Patch by Alex Petrov; reviewed by Sylvain Lebresne for CASSANDRA-7017.",['SelectStatement.java'],CASSANDRA-7017
677230df694752c7ecf6d5459eee60ad7cf45ecf,"Support for non-frozen UDTS

Patch by Tyler Hobbs; reviewed by Benjamin Lerer for CASSANDRA-7423",['SelectStatement.java'],CASSANDRA-74
3557d2e05c8d1059562de2a91c1b33b4fcfcc6eb,"Make deprecated repair methods backward-compatible with previous notification service

patch by Paulo Motta; reviewed by Yuki Morishita for CASSANDRA-11430",['StorageService.java'],CASSANDRA-1143
d8036f93617e318bf930885981cc75104bf523a2,"Fix SelectStatement public API (Follow-up CASSANDRA-7017)

patch by Alex Petrov; reviewed by Benjamin Lerer for CASSANDRA-7017",['SelectStatement.java'],CASSANDRA-7017
d200d137823d5b250406bccb35473a8fc2f14faf,"Replace sstables on DataTracker before marking them as non-compacting during anti-compaction

Patch by Ruoran Wang; reviewed by Paulo Motta for CASSANDRA-11548",['CompactionManager.java'],CASSANDRA-11548
7b0c7164aa22c156811a5d1a001c43d099aad8e4,"Integrated JMX Authentication and Authorization

Patch by Jan Karlsson and Sam Tunnicliffe; reviewed by Jake Luciani for
CASSANDRA-10091","['CassandraDaemon.java', 'StorageService.java']",CASSANDRA-10091
30789036330e84f41630a80171fd24835cacaf2d,"CASSANDRA-10091 Follow up

Fix a few cosmetic issues that made it through review:

* Remove unused method in AllowAllAuthorizer, added in error
* Revert change to enum sets in Permission.java
* Tidy imports in CassandraDaemon",['CassandraDaemon.java'],CASSANDRA-10091
d3db33c008542c7044f3ed8c19f3a45679fcf52e,"Avoid read repairing purgeable tombstones

Patch by Stefan Podkowinski; reviewed by Sylvain Lebresne for CASSANDRA-11427",['ColumnFamilyStore.java'],CASSANDRA-11427
1dd33eca1b72e6cf1261471f88e7c3990be3f097,"Remove DatabaseDescriptor dependency from FileUtils

patch by yukim; reviewed by snazy for CASSANDRA-11578",['CassandraDaemon.java'],CASSANDRA-11578
849a438690aa97a361227781108cc90355dcbcd9,"Fix commit log replay after out-of-order flush completion.

Patch by Benedict Elliott Smith; reviewed by Branimir Lambov for
CASSANDRA-9669","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-966
85cc390189f45be54dec9b146f66eeb7737fb0eb,"Prevent OOM failures on SSTable corruption, improve tests for corruption detection

Patch by Alex Petrov; reviewed by Stefania Alborghetti for CASSANDRA-9530","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-9
b851792c4e3ae32b8d863d9079cca6d135f1cf23,"Backport CASSANDRA-11578

patch by yukim; reviewed by Paulo Motta for CASSANDRA-11750",['CassandraDaemon.java'],CASSANDRA-11578
6f236c801be5b80fe18afc3ecebd4032c19b434d,"Remove unneeded summary repair from CASSANDRA-8993

Patch by Tyler Hobbs; review by Paulo Motta for CASSANDRA-11127",['SSTableReader.java'],CASSANDRA-8993
66c8f2b7f79fe794cc1e0594d9add260c209a9a2,"Fix index build regression from 9669.

Patch by Branimir Lambov; reviewed by Sam Tunnicliffe for CASSANDRA-9669",['ColumnFamilyStore.java'],CASSANDRA-966
e31e216234c6b57a531cae607e0355666007deb2,"Add Change Data Capture

Patch by jmckenzie; reviewed by cyeksigian and blambov for CASSANDRA-8844","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SSTableReader.java', 'CassandraDaemon.java']",CASSANDRA-8844
85f2bbfd1c6803977ecc1c2053527363078bce22,"Remove distinction between non-existing static columns and existing but null in LWTs

Path by Alex Petrov; reviewed by Benjamin Lerer for CASSANDRA-9842",['StorageProxy.java'],CASSANDRA-984
063e91754b22a28a43efccb0c238c577a6bd0b8a,"More uses of DataOutputBuffer.RECYCLER

patch by Robert Stupp; reviewed by T Jake Luciani for CASSANDRA-11971",['StorageProxy.java'],CASSANDRA-11971
d20c765a7d962b55ce905f393589869dab63d996,"Partial revert of CASSANDRA-11971, cannot recycle buffer in SP.sendMessagesToNonlocalDC

patch by Stefania Alborghetti; reviewed by Jake Luciani for CASSANDRA-11950",['StorageProxy.java'],CASSANDRA-11971
299ab74f4ae78319c9ca67ccd8251656078b798c,"Revert ""presize collections""

Issue CASSANDRA-12220 was found, because of this change

This reverts commit 70fd80ae43f3902e651c956b6d4d07cbc203d30a.",['CompactionManager.java'],CASSANDRA-12220
c193c2c438b088770fa8989ece63282e6c735056,"Reapply collection presizing fixes, now that CASSANDRA-12220 is fixed""",['CompactionManager.java'],CASSANDRA-12220
286f6a143573de267c1595fe4dd83108ed5356fc,"Remove compaction Severity from DynamicEndpointSnitch
patch by jbellis; reviewed by Jeremiah Jordan for CASSANDRA-11738",['StorageService.java'],CASSANDRA-11738
a123e984c3236b2a188411cad5c29f16e662c369,"Add schema to snapshot manifest, add WITH TIMESTAMP to DROP statement

Patch by Alex Petrov; reviewed by Aleksey Yeschenko for CASSANDRA-7190",['ColumnFamilyStore.java'],CASSANDRA-719
d40ac784d3a8ddaf71a2df8b21745827392294cc,"Garbage-collecting compaction operation and schema option.

patch by Branimir Lambov; reviewed by Marcus Eriksson for CASSANDRA-7019","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-701
47d3b7e7a013b485a2906fc7f0f2fc90e1143966,"compaction stress tool

patch by tjake; reviewed by Marcus Eriksson for CASSANDRA-11844",['ColumnFamilyStore.java'],CASSANDRA-11844
f28631e0cf1bc6cb6a1bdf7a4fa1f4af720a77b6,Revert CASSANDRA-11427 because of CASSANDRA-12351 (CASSANDRA-12143).,['ColumnFamilyStore.java'],CASSANDRA-11427
4205011c0fb92bfb6a7456ab620f5d6b40cb9160,"Add support for GROUP BY to SELECT statement

patch by Benjamin Lerer; reviewed by Sylvain Lebresne for CASSANDRA-10707","['SelectStatement.java', 'SinglePartitionReadCommand.java', 'StorageProxy.java']",CASSANDRA-10707
b29736c27acff3a62a1416a7c6cd7f77deb96b84,"Add support to one way targeted repair (pull-repair)

Patch by Geoffrey Yu; Reviewed by Paulo Motta for CASSANDRA-9876",['StorageService.java'],CASSANDRA-987
fa4255f06b0cc37051a69be20fd20e8e57798702,"Make decommission operation resumable

patch by Kaide Mu; reviewed by Paulo Motta for CASSANDRA-12008",['StorageService.java'],CASSANDRA-12008
e86d531ec2bf831a68d0bb448e5ed6ad623bbcf7,"Update StorageProxy range metrics for timeouts, failures and unavailables

patch by Nachiket Patil; reviewed by Alex Petrov for CASSANDRA-9507",['StorageProxy.java'],CASSANDRA-950
6528fbf250fdd2c75c8f9464e279628234a5fef4,"Add schema to snapshot manifest, add WITH TIMESTAMP to DROP statement

Patch by Alex Petrov; reviewed by Aleksey Yeschenko for CASSANDRA-7190",['ColumnFamilyStore.java'],CASSANDRA-719
9797511c56df4e9c7db964a6b83e67642df96c2d,"Let DatabaseDescriptor not implicitly startup services

patch by Robert Stupp; reviewed by Blake Eggleston for CASSANDRA-9054","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SSTableReader.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-905
f56c0c6685a490c9237f5f8ff0baa84f3441b545,"FOLLOW-UP OF Let DatabaseDescriptor not implicitly startup services

patch by Robert Stupp; reviewed by Jeremiah Jordon for CASSANDRA-9054","['DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-905
824cb768d2aa45e1889653ab2c98cc0bc63e594e,"Add support to rebuild from targeted replicas

Patch by Geoffrey Yu; Reviewed by Paulo Motta for CASSANDRA-9875","['StorageService.java', 'NodeProbe.java']",CASSANDRA-987
5f6a124853e55db9953e4e2fc717f9e9fe76d1d7,"Fix ant eclipse-warnings in 2.2

Patch by Sam Tunnicliffe; reviewed by Tyler Hobbs for CASSANDRA-15258",['ColumnFamilyStore.java'],CASSANDRA-1525
29239c765c22a7c1cb3a64476ebf0dfa9e2f9da0,"Replace Config.setClientMode with DatabaseDescriptor.clientInit()

patch by Robert Stupp; reviewed by Jeremiah Jordan for CASSANDRA-12550","['Config.java', 'DatabaseDescriptor.java', 'SSTableReader.java']",CASSANDRA-1255
6eff0829d2b3fe8fcac6622971b66792a4e82fef,"Enable repair -pr and -local together (fix regression of CASSANDRA-7450)

Patch by Jérôme Mainaud; Reviewed by Paulo Motta for CASSANDRA-12522",['StorageService.java'],CASSANDRA-7450
b39d984f7bd682c7638415d65dcc4ac9bcb74e5f,"Forward writes to replacement node when replace_address != broadcast_address

Patch by Paulo Motta; reviewed by Richard Low for CASSANDRA-8523",['StorageService.java'],CASSANDRA-8523
d43b9ce5092f8879a1a66afebab74d86e9e127fb,"Support optional backpressure strategies at the coordinator

patch by Sergio Bossa; reviewed by Stefania Alborghetti for CASSANDRA-9318","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java', 'StorageProxy.java']",CASSANDRA-9
ec604875886a5790b627f0fa22cea4fca34532dd,"If CF has no clustering columns, any row cache is full partition cache (CASSANDRA-12499)

Patch by Jeff Jirsa ; Reviewed by Sylvain Lebresne for CASSANDRA-12499",['SinglePartitionReadCommand.java'],CASSANDRA-12499
eace9aaddfdd0059f52b1eb9b6902f999f04a447,"If CF has no clustering columns, any row cache is full partition cache (CASSANDRA-12499)

Patch by Jeff Jirsa ; Reviewed by Sylvain Lebresne for CASSANDRA-12499",['SinglePartitionReadCommand.java'],CASSANDRA-12499
28713778abe29c1d9120d2127354b7fd5ee8fff1,"Split consistent range movement flag correction

Patch by Sankalp Kohli; Reviewed by Jeff Jirsa for CASSANDRA-12786",['StorageService.java'],CASSANDRA-1278
49ce0a49571de31094959fa0f86da5492bd7fc0e,"CASSANDRA-12836 Set JOINING mode when finishing joining ring

Patch by Sergio Bossa; reviewed by Sam Tunnicliffe for CASSANDRA-12836",['StorageService.java'],CASSANDRA-12836
4a2464192e9e69457f5a5ecf26c094f9298bf069,"Remove pre-3.0 compatibility code for 4.0

patch by Sylvain Lebresne; reviewed by Aleksey Yeschenko for CASSANDRA-12716","['ColumnFamilyStore.java', 'SinglePartitionReadCommand.java', 'CompactionManager.java', 'SSTableReader.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-12716
95d0b671d1af154eaf1c1e81992c7f3f51469eee,"CQL often queries static columns unnecessarily

patch by Sylvain Lebresne; reviewed by Tyler Hobbs for CASSANDRA-12768",['SelectStatement.java'],CASSANDRA-12768
6bd402d12eb9216529417294e9af3a5b7c37b048,"Set RPC_READY to false when draining or if a node is marked as shutdown

patch by Stefania Alborghetti; reviewed by Paulo Motta for CASSANDRA-12781",['StorageService.java'],CASSANDRA-1278
66f1aaf88d3cde5c52b13d71d3326da5eda16fb1,"Temporarily fix bug that creates commit log when running offline tools

patch by yukim; reviewed by thobbs for CASSANDRA-8616","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SSTableReader.java', 'CassandraDaemon.java']",CASSANDRA-861
39d77f43e38ae085d6049740d3d86c629b3b5f94,ninja: fix isDecomissioning check from CASSANDRA-12008,['StorageService.java'],CASSANDRA-12008
4d67639d38b3e3a6fd0a3487a99b9755abda469d,"Parallelize streaming of different keyspaces for bootstrap and rebuild

patch by Corentin Chary; reviewed by jasobrown for CASSANDRA-4663","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-4663
e1da99a1d82b5313f022307c2e110afc07e112b6,"Revert CASSANDRA-12768 (and update fix of CASSANDRA-12694) due to upgrade regression

patch by Sylvain Lebresne; reviewed by Benjamin Lerer for CASSANDRA-13025",['SelectStatement.java'],CASSANDRA-12768
af3fe39dcabd9ef77a00309ce6741268423206df,"Make TableMetadata immutable, optimize Schema

patch by Aleksey Yeschenko; reviewed by Sylvain Lebresne for
CASSANDRA-9425","['SelectStatement.java', 'ColumnFamilyStore.java', 'SinglePartitionReadCommand.java', 'CompactionManager.java', 'SSTableReader.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-9425
98d74ed998706e9e047dc0f7886a1e9b18df3ce9,"Fix consistency of incrementally repaired data

patch by Blake Eggleston, reviewed by Marcus Eriksson for CASSANDRA-9143","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'CassandraDaemon.java', 'NodeProbe.java']",CASSANDRA-9143
5725e2c422d21d8efe5ae3bc4389842939553650,"Coalescing strategies improvements CASSANDRA-13090

With the previous code TIMEHORIZON and MOVINGAVERAGE
coalesing strategy would wait even when the backlog
still contains data which would make it grow even more.

Also:
- cleanups parkLoop()
- add otc_coalescing_max_coalesced_messages
- add otc_coalescing_enough_coalesced_messages
- add other otc_* settings to cassandra.yaml

patch by Corentin Chary <c.chary@criteo.com> reviewed by Ariel Weisberg <aweisberg@apple.com> for CASSANDRA-13090","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-13090
3f3db2d40d6b5edbf079b917953a30bcc1209d25,"fix minor bugs related to CASSANDRA-9143
patch by Blake Eggleston; reviewed by Jeff Jirsa for CASSANDRA-13217",['SSTableReader.java'],CASSANDRA-9143
732d1af866b91e5ba63e7e2a467d99d4cb90e11f,"Outbound TCP connections should consult internode authenticator.
Patch by Ariel Weisberg; Reviewed by Marcus Eriksson for CASSANDRA-13324","['DatabaseDescriptor.java', 'MessagingService.java']",CASSANDRA-13324
c86de2a9817aa45930afe181ae1891d2363393c7,"Fix NPEs in original CASSANDRA-13324 commit

Patch by Ariel Weisberg; Reviewed by Marcus Eriksson",['MessagingService.java'],CASSANDRA-13324
6ed9134336bb48d04284cefd303d8374ed901c0a,"CASSANDRA-13163, fix NPE in StorageService.excise()

Patch by Ariel Weisberg; Reviewed by Jason Brown for CASSANDRA-13163",['StorageService.java'],CASSANDRA-13163
4ebab66163e136773ae68216585a5c587eba7006,"Allow selecting Map values and Set elements

patch and review by Robert Stupp, Sylvain Lebresne and Benjamin Lerer for CASSANDRA-7396",['SelectStatement.java'],CASSANDRA-739
1f54aa424fd8a79089f76951a93560e6bca9d459,"Ensure consistent view of partition columns between coordinator and replica in ColumnFilter

Patch by Alex Petrov; reviewed by Aleksey Yeschenko for CASSANDRA-13004",['MessagingService.java'],CASSANDRA-13004
90c5c8bfecd69edb5f859e9ff2424930b1394b49,Ninja: fix test failures after CASSANDRA-13004.,['MessagingService.java'],CASSANDRA-13004
9fdec0a82851f5c35cd21d02e8c4da8fc685edb2,"Use common nowInSec for validation compactions

Patch by Blake Eggleston; Reviewed by Marcus Eriksson for CASSANDRA-13671",['CompactionManager.java'],CASSANDRA-1367
cf4a0576a6f2b8f2d828a8b14140f212803adb7c,"Allow to set batch_size_warn_threshold_in_kb via JMX

patch by Romain Hardouin; reviewed by Jeff Jirsa for CASSANDRA-13699","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-1369
336baebadcd6114ad961ca1027474499e15ae42a,"Fix regression introduced by CASSANDRA-11223 for counting rows in static compact tables

patch by Stefania Alborghetti; reviewed by Benjamin Lerer for CASSANDRA-11223",['SinglePartitionReadCommand.java'],CASSANDRA-11223
2795d72b46e493b87f74a4eb9c25520adff58f8c,"Better bootstrap failure message when blocked by (potential) range movement

 patch by Mick Semb Wever; reviewed by Jeff Jirsa  for CASSANDRA-13744",['StorageService.java'],CASSANDRA-1374
d2dcd7f884cc997905c820d7cef8c9fc886ff4f7,"force minumum timeout value

patch by Varun Barala; reviewed by jasobrown for CASSANDRA-9375",['DatabaseDescriptor.java'],CASSANDRA-9375
7f297bcf8aced983cbc9c4103d0ebefc1789f0dd,"Fix race condition in read command serialization

patch by Aleksey Yeschenko; reviewed by Sam Tunnicliffe for
CASSANDRA-13363","['SelectStatement.java', 'SinglePartitionReadCommand.java']",CASSANDRA-13363
5dc79aafceb8dd1b7a985b262f128c59bedb5bf6,"add nodetool command 'statusautocompaction'

patch by cormoran; reviewed by jasobrown for CASSANDRA-8727","['StorageService.java', 'NodeProbe.java']",CASSANDRA-872
f3f90c1896eab4f3fb5507b0cf348e2f149db5d1,"Add GroupCommitLogService

patch by Yuji Ito and jasobrown; reviewed by Ariel Weisberg for CASSANDRA-13530","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-13530
32287169fc483f2959259cacc4c5a72a85ea381c,Ninja: Fix incorrect value from CASSANDRA-9375,['DatabaseDescriptor.java'],CASSANDRA-9375
e646e5032b68622f7ec1dd0c53137be08baabed9,"Prevent continuous schema exchange between 3.0 to 3.11 nodes

patch by Robert Stupp; reviewed by Andrés de la Peña for CASSANDRA-14109",['StorageService.java'],CASSANDRA-14109
7a40abb6a5108688fb1b10c375bb751cbb782ea4,"Bring code improvements of CASSANDRA-14109 into trunk (but not the change itself)

patch by Robert Stupp; reviewed by Andrés de la Peña for CASSANDRA-14109",['StorageService.java'],CASSANDRA-14109
e208a6a210d172b991b40fb66a4763e30b3e4d7d,"Avoid exposing compaction strategy index externally

Patch by Paulo Motta; Reviewed by Marcus Eriksson for CASSANDRA-14082",['CompactionManager.java'],CASSANDRA-14082
d6cc5943250a7c19adb42ef86dc9a186d4e52166,"New Bloomfilter format without changing the byte ordering

patch by Jay Zhuang; reviewed by jasobrown for CASSANDRA-9067",['SSTableReader.java'],CASSANDRA-906
59b5b6bef0fa76bf5740b688fcd4d9cf525760d0,"Allow storage port to be configurable per node

Patch by Ariel Weisberg; Reviewed by Jason Brown for CASSANDRA-7544","['DatabaseDescriptor.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-7544
3891598e61ecb3fe2a029e27061ac28f4b58c29e,"Fix mistakenly unused variable introduced by CASSANDRA-7544 and potential CME in iterator

Patch by Ariel Weisberg; Reviewed by Jason Brown for CASSANDRA-7544",['StorageService.java'],CASSANDRA-7544
cc436770010034f5e9fbde06b9a2e713ddbffcee,"Ninja fix bitwise OR to logical OR in StorageServer.onChange

Patch by Ariel Weisberg; Reviewed by Kurt Greaves for CASSANDRA-7544",['StorageService.java'],CASSANDRA-7544
39807ba48ed2e02223014fbf47dce21d4124b380,"Refactor read executor and response resolver, abstract read repair

Patch by Blake Eggleston; Reviewed by Marcus Eriksson for CASSANDRA-14058",['StorageProxy.java'],CASSANDRA-1405
40aeaf0c12b24dbc0f554fbd00a42fe739767ac7,"nodetool describecluster should be more informative

Patch by Preetika Tyagi, Reviewed by Ariel Weisberg for CASSANDRA-13853","['StorageService.java', 'NodeProbe.java']",CASSANDRA-13853
d31ed0f51b23d8fce892695ecd82d4f843f31f4c,"Abstract write path for pluggable storage

Patch by Blake Eggleston; Reviewed by Aleksey Yeschenko for CASSANDRA-14118",['ColumnFamilyStore.java'],CASSANDRA-14118
fd44a69fce135c6ddf7ebcba25d032a36a1d9064,"Use standard Amazon naming for datacenter and rack in Ec2Snitch.

patch by Gregory Ramsperger and jasobrown; reviewed by Joey Lynch for CASSANDRA-7839",['StorageService.java'],CASSANDRA-783
127cfff26bbed97d2ae9cb3b0a65824d130ec78b,"Add ability to load new SSTables from a separate directory

Patch by marcuse; reviewed by Jordan West for CASSANDRA-6719","['ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-671
b2f6ce961f38a3e4cd744e102026bf7a471056c9,"Delay hints store excise by write timeout to avoid race with decommission

patch by Jaydeepkumar Chovatia; reviewed by Aleksey Yeschenko for
CASSANDRA-13740",['StorageService.java'],CASSANDRA-1374
a9ec46a613ae5602ced004935c9954638e83e735,"List clients by protocol versions `nodetool clientstats --by-protocol`

patch by Dinesh Joshi; reviewed by jasobrown for CASSANDRA-14335","['CassandraDaemon.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-14335
68605cf03bdfecb11cd69c6d5260a773e4e87300,ninja commit the minor updates for CASSANDRA-14335,['CassandraDaemon.java'],CASSANDRA-14335
d14a9266c7ddff0589fdbe7a1836217b8bb8b394,"Automatic sstable upgrades

Patch by marcuse; reviewed by Ariel Weisberg for CASSANDRA-14197","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java', 'NodeProbe.java']",CASSANDRA-14197
6ba2fb9395226491872b41312d978a169f36fcdb,"Make C* compile and run on Java 11 and Java 8

patch by Robert Stupp; reviewed by Jason Brown for CASSANDRA-9608","['DatabaseDescriptor.java', 'SinglePartitionReadCommand.java']",CASSANDRA-96
644676b088be5177ef1d0cdaf450306ea28d8a12,"Improve read repair blocking behavior

Patch by Blake Eggleston; reviewed by Marcus Eriksson and Alex Petrov
for CASSANDRA-10726","['SinglePartitionReadCommand.java', 'MessagingService.java', 'StorageProxy.java']",CASSANDRA-1072
e225c88a65f2e8091f8ea6212c291416674882a1,"Cell reconciliation should not depend on nowInSec

patch by Benedict; reviewed by Aleksey for CASSANDRA-14592",['SinglePartitionReadCommand.java'],CASSANDRA-14592
2046c30adec194fb07bc5dd1c31fc19a64e7895c,"Fail query on transient replica if coordinator only expects full data

Patch by Alex Petrov; reviewed by Benedict Elliott Smith for CASSANDRA-14704",['StorageProxy.java'],CASSANDRA-1470
047bcd7ad171d6a4aa89128c5e6c6ed5f012b1c0,"ReplicaPlan/Layout refactor follow-up/completion

Finish much of the work to clarify endpoint selection
that was begun in Transient Replication (CASSANDRA-14404)

Also fixes:
  - commitPaxos was incorrectly selecting only live nodes,
    when needed to include down
  - We were not writing to pending transient replicas
  - On write, we were not hinting to full nodes with transient
    replication
  - rr.maybeSendAdditional{Reads,Writes} would only consult the
    same node we may have speculated a read to
  - transient->full movements mishandled consistency level upgrade by
    retaining the 'full' pending variant, which increased CL requirement;
    instead, the 'natural' replica is upgraded to 'full' for writes

patch by Benedict; reviewed by Alex Petrov and Ariel Weisberg for CASSANDRA-14705","['StorageProxy.java', 'StorageService.java']",CASSANDRA-1470
6e27e65f150ed6cc6a7205b9d7c89a763f3256fa,"Only cancel conflicting compactions when starting anticompactions and sub range compactions

Patch by marcuse; reviewed by Blake Eggleston for CASSANDRA-14935","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-14935
3bb8f88c85d35667a530254015e8b1b52f7a7a0c,"CASSANDRA-14935 followup, replace leftover todos with comments",['ColumnFamilyStore.java'],CASSANDRA-14935
16ef9ac37c21c4f9091cd1f3658e54abddab8ad8,"SSL Cert Hot Reloading should check for sanity of the new keystore/truststore before loading it

Patch by Dinesh Joshi; reviewed by Ariel Weisberg for CASSANDRA-14991","['DatabaseDescriptor.java', 'MessagingService.java', 'NodeProbe.java']",CASSANDRA-14991
cbf4da4397c2cec34d6a240b0e917a847c46b3d0,"CASSANDRA-14991 Follow-up: clean up SSL Hot Reloading code

patch by Dinesh Joshi, reviewed by Alex Petrov for CASSANDRA-15018",['DatabaseDescriptor.java'],CASSANDRA-14991
7df67eff2d66dba4bed2b4f6aeabf05144d9b057,"Reduce heap pressure during compactions
Patch by Chris Lohfink; Reviewed by Dinesh Joshi and Benedict for CASSANDRA-14654","['Config.java', 'DatabaseDescriptor.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-14654
310a48efcfdc0fb77fbd5fd6e734bf17667f617d,"Rewrite the internode messaging subsystem

patch by Aleksey Yeschenko and Benedict Elliott Smith; reviewed by Alex
Petrov, Aleksey Yeschenko, and Benedict Elliott Smith for CASSANDRA-15066

Co-authored-by: Aleksey Yeschenko <aleksey@apache.org>
Co-authored-by: Benedict Elliott Smith <benedict@apache.org>","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SinglePartitionReadCommand.java', 'SSTableReader.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-15066
860de83a02f3b7711e842a58a073802b9920a1a1,"Enable nodetool/JMX resizing of processing stage executor pool

This patch enables users to resize the thread pools used by the
various processing stages at runtime using nodetool or over JMX.

Changes:

Switch to using idiomatic Java Executor names for thread pool configuration
functions.  Deprecate `{get,set}CoreThreads` for `{get,set}CorePoolSize`,
`{get,set}MaximumThreads` for `{get,set}MaximumPoolSize`.

Introduce a new ResizableThreadPool interface used by SEPExecutorMBean and
JMXEnabledThreadPoolExecutorMBean to expose a common interface for setting
thread pool sizes.  Replace singled usage of JMXConfigurableThreadPoolExecutor
in repair code with JMXEnabledThreadPoolExecutor as both are now resizable
(since CASSANDRA-5044) and ResizableThreadPool now exporting the same API
over JMX.

Implement {get,set}CorePoolSize and {get,set}MaximumPoolSize for SEPExecutor.
To change the maximum pool size for SEPExecutor, the number of permits
has been changed so that it can go negative if the size of the pool is
reduced.  If a SEPWorker discovers the number of permits is negative when
looking for more work it stops.

Add `nodetool getconcurrency` to retrieve the current core and maximum
pool sizes for all of the executor stages and `nodetool setconcurrency`
to change core/maximum pool sizes where permitted.

Update Stage to lazily initialize the executors so that in-JVM dtests
can reference Verbs (which have an associated Stage) in message filtering
without starting up all the executors.  Introduce new Stage.execute/submit
convenience functions to avoid needing to lookup the executor first.

Update Stage executors to pass a consumer function that
updates the configuration used to initialize the thread pools. This keeps
the config in sync with changes made over JMX to `org.apache.cassandra.{request,internal}.*`
or via nodetool. Also implement for native transport threads - although
that can currently only be updated by JMX rather than nodetool.

Introduce a new `JMXEnabledSingleThreadedExecutor` for executors
that need to be single threaded for correctness that forbids changing
the core/maximum pool sizes (previously it was possible to set gossip to
run multiple threads over JMX).

Patch by Jon Meredith; reviewed by Benedict Elliot Smith for CASSANDRA-15277","['DatabaseDescriptor.java', 'SinglePartitionReadCommand.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-5044
3a8300e0b86c4acfb7b7702197d36cc39ebe94bc,"Avoid deadlock during CommitLog initialization

patch by Zephyr Guo, Dinesh Joshi; reviewed by Jordan West and Dinesh Joshi for CASSANDRA-15295

Co-Authored-By: Zephyr Guo <gzh1992n@gmail.com>
Co-Authored-By: Dinesh Joshi <dinesh.joshi@apple.com>","['DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-15295
b907dc9689dd04ebae1f765570401d1f20a88ebd,"Make sure that hidden columns are only hidden from CQL

Patch by Alex Petrov; reviewed by Aleksandr Sorokoumov for CASSANDRA-13917 (follow-up).",['SelectStatement.java'],CASSANDRA-1391
da90439f0052c3a05aaf6d4268a8c719e10fafde,"Make native_transport_max_concurrent_requests_in_bytes updatable

Patch by Jordan West; Reviewed by Chris Lohfink CASSANDRA-15519",['StorageService.java'],CASSANDRA-1551
dbb43197fe9c462b22c4e4c3ef8a0c55b5696fa7,"Add the cause to the exception and allow to log when an invalid
partitioner is detected.

Patch by David Capwell, reviewed by brandonwilliams for CASSANDRA-15591",['DatabaseDescriptor.java'],CASSANDRA-1559
6a6dd8ad243cd140f931342ce609821ff2ca12d0,"Disable JMX rebinding

Patch by Colm O hEigeartaigh; reviewed by Sam Tunnicliffe for CASSANDRA-15653",['CassandraDaemon.java'],CASSANDRA-1565
1f72cc6197187abac5b1f70a19589dd4883e8d98,"Extract in-jvm-dtest API

Patch by Alex Petrov for CASSANDRA-15539; reviewed by David Capwell and Dinesh Joshi.","['MessagingService.java', 'NodeProbe.java']",CASSANDRA-1553
dfc279a22a5563ac7a832a586914d5410426e9b7,"Fix flaky test o.a.c.d.test.*RepairCoordinatorFastTest

patch by David Capwell; reviewed by Ekaterina Dimitrova and Benjamin Lerer
for CASSANDRA-15650",['NodeProbe.java'],CASSANDRA-15650
6a302f734a1dede4b4bdee5e5f67c5ada6f0115d,"Set now in seconds in the future for validation repairs

Patch by Blake Eggleston; reviewed by Ekaterina Dimitrova for CASSANDRA-15655","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-1565
78c785367f2836960ae26e5e5ef258162ef30ec3,"Improve logging around incremental repairs

Patch by marcuse; reviewed by Sam Tunnicliffe for CASSANDRA-15599",['CompactionManager.java'],CASSANDRA-1559
e995c3fcc7479e82f34721d9634093a807ff06bd,"Allow sending Entire SSTables over SSL

Patch by Dinesh Joshi; Reviewed by Joseph Lynch for CASSANDRA-15740",['DatabaseDescriptor.java'],CASSANDRA-15740
b105e919678240b5f448df9acaf6c93117f0c0cc,"liveDiskSpaceUsed and totalDiskSpaceUsed get corrupted if IndexSummaryRedistribution gets interrupted

Patch by David Capwell; reviewed by marcuse for CASSANDRA-15674",['SSTableReader.java'],CASSANDRA-1567
d48954563802b1c2d42fd0bf5062568baae5b0eb,"Clean up redundant nodetool commands added in 4.0

Patch by Chris Lohfink; Reviewed by Jordan West for CASSANDRA-15256","['StorageService.java', 'NodeProbe.java']",CASSANDRA-1525
4d42c189fa82b32fd93ae42a164b91e4db62992e,"Avoid creating duplicate rows during major upgrades

Patch by Aleksey Yeschenko, Sam Tunnicliffe and Marcus Eriksson;
reviewed by Sylvain Lebresne and Alex Petrov for CASSANDRA-15789","['Config.java', 'DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-15789
dd255ffa07d0263521a1ca863fc2192db19bc04c,"Fix replica-side filtering returning stale data with CL > 1

patch by Andres de la Peña; reviewed by Benjamin Lerer, Caleb Rackliffe and ZhaoYang for CASSANDRA-8272",['SinglePartitionReadCommand.java'],CASSANDRA-827
976096abd2ba786f747774ee5160c4cba6fefce2,"Fix writing of snapshot manifest when the table has table-backed secondary indexes
patch by Aleksandr Sorokoumov; reviewed by Andrés de la Peña for CASSANDRA-10968",['ColumnFamilyStore.java'],CASSANDRA-10968
d8993934e976d8edb94cbfe2974688dac63c5db5,"Remove BackPressureStrategy

patch by Benedict; reviewed by Sergio Bossa and Robert Stupp for CASSANDRA-15375","['Config.java', 'DatabaseDescriptor.java', 'MessagingService.java', 'StorageProxy.java']",CASSANDRA-15375
e5c3d08a1428d378b6690f0419a2b25724b9736e,"Operational improvements and hardening for replica filtering protection
patch by Caleb Rackliffe; reviewed by Andrés de la Peña for CASSANDRA-15907","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-15907
d28f769fc6dae2ddbc150723a4069c765fc80c08,"Disable JMX rebinding

Patch by Colm O hEigeartaigh; reviewed by Sam Tunnicliffe for CASSANDRA-15653/CASSANDRA-16075",['CassandraDaemon.java'],CASSANDRA-1565
a062ff5f9f0d3221deaaaaf8fccbcd21e933e7cd,"Resolve JMX output inconsistencies from CASSANDRA-7544 storage-port-configurable-per-node

patch by Jon Meredith; reviewed by David Capwell for CASSANDRA-15937","['StorageProxy.java', 'StorageService.java']",CASSANDRA-7544
91bcbb28733437a7a5fedb16984d4de2fa70b049,"Add a new jmxtool which can dump what JMX objects exist and diff

patch by David Capwell, Stephen Mallette; reviewed by Berenguer Blasi, Jon Meredith for CASSANDRA-16082",['CassandraDaemon.java'],CASSANDRA-1608
83e1e9e45193322f18f57aa7cc4ad31d9d5a152d,"in-jvm dtest now exposes stdout and stderr for nodetool

patch by Yifan Cai; reviewed by Alex Petrov, David Capwell for CASSANDRA-16057",['NodeProbe.java'],CASSANDRA-16057
699a1f74fcc1da1952da6b2b0309c9e2474c67f4,"CASSANDRA-15229: Segregate Network and Chunk Cache BufferPools and Recirculate Partially Freed Chunks

* initiate multiple buffer pool for different lifespan and usages
  - Chunk Cache Buffer Pool - conf.file_cache_size_in_mb=512mb
  - Networking Buffer Pool - conf.temporary_cache_size_in_mb=128mb

* Add overflowSize and usedSize to buffer pool metrics

* re-circulate buffer pool Chunk for ChunkCache whenever it has free space, even thoughput it may not be able to allocate due to fragmentation

patch by Zhao Yang; reviewed by Caleb Rackliffe and Aleksey Yeschenko for CASSANDRA-15229","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-15229
f15c6b8c06c9588bd96615fabfc36b11857cd4bb,"Backport CASSANDRA-16057: Should update in-jvm dtest to expose stdout and stderr for nodetool

patch by Yifan Cai; reviewed by Alex Petrov, David Capwell for CASSANDRA-16057",['NodeProbe.java'],CASSANDRA-16057
fee7a10823da1e29bd0e6504fea9679389180c9e,"Prevent invoking enable/disable gossip when not in NORMAL

Patch by Yifan Cai; Reviewed by Brandon Williams and Blake Eggleston for CASSANDRA-16146",['StorageService.java'],CASSANDRA-16146
f106ef0697e172492b0343462c593edb703f2ac8,"Fix invalid cell value skipping when reading from disk

patch by Jacek Lewandowski; reviewed by Sylvain Lebresne for CASSANDRA-16223",['SelectStatement.java'],CASSANDRA-1622
e5ab8c1951384b9ddf0df9f1d4d49b4c9dfc188f,"Fix tests broken by CASSANDRA-16146

Patch by Yifan Cai, reviewed by brandonwilliams for CASSANDRA-16146",['StorageService.java'],CASSANDRA-16146
548ef438568fe3216e39235fc054202709c542ca,"Fix a race condition on ColumnFamilyStore and TableMetrics

patch by Ekaterina Dimitrova; reviewed by Benjamin Lerer for
CASSANDRA-16228",['ColumnFamilyStore.java'],CASSANDRA-1622
8ffec0f02cf73c3d3a8c01aa2d856647a5620a21,"Bring back partial compact storage support to 4.0

Patch by Alex Petrov; reviewed by Marcus Eriksson for CASSANDRA-16217","['SelectStatement.java', 'SinglePartitionReadCommand.java', 'CassandraDaemon.java']",CASSANDRA-16217
17ebee3186d1bfdee9a2b355cb8f139492d144e8,"CASSANDRA-15158 fixed SCHEMA_DELAY to use getSchemaDelay and no longer convert it from secones to millis (since its already millis)

patch by David Capwell; reviewed by Blake Eggleston for CASSANDRA-15158",['StorageService.java'],CASSANDRA-15158
fc9a5a7c63c5d264c30e940ef88236d2da0f5959,"Rate limit validation compactions using compaction_throughput_mb_per_sec

 patch by Stefan Miklosovic; reviewed by Mick Semb Wever, Chris Lohfink for CASSANDRA-16161",['CompactionManager.java'],CASSANDRA-1616
22abff779df097e0ef38180442e9c680b3d41187,"Optimised repair streaming improvements

Patch by marcuse; reviewed by Sam Tunnicliffe for CASSANDRA-16274","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-16274
a7c4ba9eeecb365e7c4753d8eaab747edd9a632a,"Improve checksumming and compression in protocol V5

This reverts the changes made to the native protocol V5 wire format in
CASSANDRA-13304 and subsequent follow up JIRAs (CASSANDRA-15556 &
CASSANDRA-14716). The framing format has been re-implemented based on the
internode messaging format developed in CASSANDRA-15066.

OPTIONS and STARTUP messages are unframed (i.e. identical to the V4 format).
After sending its response to a STARTUP message, the server modifies the
pipeline and all further messages are sent (and should be expected by the
client to be received) in the format determined by the protocol version of
the STARTUP message.

Patch by Sam Tunnicliffe; reviewed by Alex Petrov and Caleb Rackliffe
for CASSANDRA-15299","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-15066
f8500ee911343eb8826f9c44bb6db2ab780f6327,"Fix skipping on pre-3.0 created compact storage sstables due to missing primary key liveness

Check primary key liveness information only if it exists, and fall back to checking cell contents, which makes skipping possible for COMPACT STORAGE tables after and upgrade to 3.0+

 patch by Caleb Rackliffe; reviewed by Alex Petrov, Mick Semb Wever for CASSANDRA-16226",['SinglePartitionReadCommand.java'],CASSANDRA-1622
0a1e900a0a042f78d7d5d6625bc98b84eb463e69,"Prevent unbounded number of pending flushing tasks; Add PendingFlushTasks metric (CASSANDRA-16261)
Authored by Ekaterina Dimitrova; reviewed by Caleb Rackliffe and Andres de la Pena for CASSANDRA-16261","['DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-16261
b61860c76e9cf1eebfb7d29dc4f4420955f62bb4,"Fix nodetool ring, status output when DNS resolution or port printing are in use
Patch by Adam Holmberg and Scott Wolfenhaut; reviewed by Berenguer Blasi, Brandon Williams and Ekaterina Dimitrova for CASSANDRA-16283",['StorageService.java'],CASSANDRA-16283
f69b11eee9605add3a006de46eedb773a984d90b,"Improve system tables handling in case of disk failures

patch by Benjamin Lerer; reviewed by Andrés de la Peña and  Marcus
Eriksson for CASSANDRA-14793","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-14793
d6f18106f09e7b1a58744c9bd1ee35054a43d68a,"Add an option to nodetool tablestats to check sstable location correctness

patch by Yifan Cai; reviewed by Ekaterina Dimitrova, Marcus Eriksson for CASSANDRA-16344","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-1634
6665fc29b33abcc26aad4cecbfee88225b0a7225,"Improve coordination tests

patch by Andrés de la Peña; reviewed by Caleb Rackliffe, Alex Petrov and Blake Eggleston for CASSANDRA-16180",['StorageProxy.java'],CASSANDRA-1618
5ed5e84613ef0e9664a774493db7d2604e3596e0,"Nodetool status to display all available info even when bootstrapping

Patch by Berenguer Blasi, reviewed by brandonwilliams for
CASSANDRA-16412",['StorageService.java'],CASSANDRA-1641
5c84ed9ae8227e550630768a47fef7b2d1f1f1d7,"Send FAILED_SESSION_MSG on shutdown and on in-progress repairs during startup

 patch by Marcus Eriksson; reviewed by Adam Holmberg, Chris Lohfink, Mick Semb Wever for CASSANDRA-16425",['StorageService.java'],CASSANDRA-1642
9bc8d0b452aeb7aaa2005e710fc3de0998172738,"Avoid executing commands that have guaranteed empty bounds in slices filter

Patch by Alex Petrov; reviewed by Marcus Eriksson and Aleksey Yeschenko for CASSANDRA-16435.","['SelectStatement.java', 'SinglePartitionReadCommand.java']",CASSANDRA-1643
efde6a76f9807eaa0af80b5e85aa350ac8709a81,"Refuse DROP COMPACT STORAGE if some 2.x sstables are in use
patch by Sylvain Lebresne; review changes and tests by Ekaterina Dimitrova; reviewed by Benjamin Lerer and Brandon Williams for CASSANDRA-15897","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-15897
ec9b7b9d376e9c98cedb3ad4eae90311923bc7bd,"Expose StorageServiceMBean#getKeyspaceReplicationInfo (backport from 4.0 and CASSANDRA-13853)

 patch by Stefan Miklosovic; reviewed by Mick Semb Wever for CASSANDRA-16447",['StorageService.java'],CASSANDRA-13853
3edacd632c2f2c360ca1d931c6b4f6fd7326511f,"Scheduled (delayed) schema pull tasks should not run after MIGRATION stage shutdown during decommission
patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe and Yifan Cai for CASSANDRA-16495",['StorageService.java'],CASSANDRA-16495
b915688ea878aaa284f5cedeb799c5f797c4d824,"Fix false unavailable for queries due to cluster topology changes

patch by Yifan Cai; reviewed by Aleksey Yeschenko, Andres de la Peña for CASSANDRA-16545","['SelectStatement.java', 'StorageProxy.java']",CASSANDRA-1654
8fd046f2557e4d50e80986b813bc904dce625e6a,Ninja fix typo in logging for CASSANDRA-16628,['StorageService.java'],CASSANDRA-16628
d84c6e98106e7b0c205f019ee24d416d0bb65f37,"Prevent loss of commit log data when moving sstables between nodes

patch by Jakub Zytka and Jacek Lewandowski; reviewed by Branimir Lambov and Benjamin Lerer for CASSANDRA-16619

Add originating host ID to sstable metadata

- md, me sstables
- add missing test cases in MetadataSerializerTest

Co-authored-by: Jakub Zytka <jakub.zytka@datastax.com>
Co-authored-by: Jacek Lewandowski <jacek.lewandowski@datastax.com>",['StorageService.java'],CASSANDRA-1661
5f09226a0d56f6d2d5e60f83465f9f17beed0572,"Don't wait on schema versions from replacement target when replacing a node

patch by Blake Eggleston; reviewed by Brandon Williams for CASSANDRA-16692",['StorageService.java'],CASSANDRA-1669
2059c7586ef6bf10900977d4f5bb1072313e0b74,"Fix queries on empty partitions with static data

patch by Benjamin Lerer; reviewed by Andrés de la Peña and Jacek
Lewandowski for CASSANDRA-16686

When an CQL query is done at the partition level (without clustering or
regular column restrictions), if a partition does not contains any row but
contains some static columns a row will be returned to the user with null
values for all the clustering and regular columns.
Since CASSANDRA-12768, Cassandra fetch all the regular columns but only
the static columns that have been selected by the user. By consequence,
Cassandra will fetch only s1 for the SELECT s1 FROM %s WHERE pk=1 query
from the description example. Due to that it will NOT attempt to fetch the
s2 value and will look only at the third and second SSTables. The
partition having no value for s1 Cassandra will consider the partition
empty and will not return a row for it as it should.

The patch fix the issue by adding all the static columns to the fetched
columns when the query is at the partition level (without clustering or
regular column restrictions). Unfortunately as 4.0-rc1 has been released
we need to ensure backward compatibility with it in a mixed cluster
environment. To ensure that some extra changes were required in
ColumnFilter and in Gossiper.",['SelectStatement.java'],CASSANDRA-12768
2fba5c80ce7bf71d04c62043ffa1088b9e832d83,"Avoid memoizing the wrong min cluster version during upgrades

patch by Marcus Eriksson, Jon Meredith; reviewed by Brandon Williams, Yifan Cai for CASSANDRA-16759",['StorageService.java'],CASSANDRA-1675
296f65e8d1c25f31a87481843d715f5b7dad9d7b,"Log when compacting many tombstones

Patch by marcuse; reviewed by Brandon Williams for CASSANDRA-16780","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-1678
69b653a01f09874d73bc70e1e7a7670859a4e4a4,"Remove mutation data from error log message

patch by Andrés de la Peña; reviewed by Brandon Williams for CASSANDRA-16817

Co-authored-by: Aleksandr Sorokoumov <aleksandr.sorokoumov@gmail.com>",['StorageProxy.java'],CASSANDRA-1681
acf38bf7a1ac34fdbe8c18c843828a78293a85cb,"Use JMX to validate nodetool --jobs parameter

patch by Dmitrii Saprykin; reviewed by Andrés de la Peña and Benjamin Lerer for CASSANDRA-16104

Co-authored-by: Andrés de la Peña <a.penya.garcia@gmail.com>
Co-authored-by: Daniel Jatnieks <jatnieks@pobox.com>
Co-authored-by: Dmitrii Saprykin <dmitrii.saprykin@nih.gov>","['StorageService.java', 'NodeProbe.java']",CASSANDRA-1610
8acbbe042b236c6948845ecd7af093c6f0fa3e4b,"Background schedule to clean up orphaned hints files

patch by Yifan Cai; reviewed by Brandon Williams, Chris Lohfink for CASSANDRA-16815","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-1681
b286639eea11b5f6ee709711d00d36aa029bc114,"implement getauditlog command

patch by Stefan Miklosovic; reviewed by Ekaterina Dimitrova, Mick Semb Wever for CASSANDRA-16725","['DatabaseDescriptor.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-1672
d220d24994400d4342f5281f1a51514a6ae8c2fd,"Request-Based Native Transport Rate-Limiting

patch by Caleb Rackliffe; reviewed by Benedict Elliott Smith and Josh McKenzie for CASSANDRA-16663","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-1666
4b3f07fc74089151efeff7a8fdfa9c414a1f0d6a,"allow blocking IPs from updating metrics about traffic

patch by David Capwell; reviewed by Benjamin Lerer, Caleb Rackliffe, Jon Meredith for CASSANDRA-16859","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-1685
ad249424814836bd00f47931258ad58bfefb24fd,"Add TTL support to nodetool snapshots

Patch by Abi Palagashvili; Reviewed by Paulo Motta and Stefan Miklosovic for CASSANDRA-16789

Co-authored-by: Paulo Motta <pauloricardomg@gmail.com>
Co-authored-by: Stefan Miklosovic <smiklosovic@apache.org>

Closes #1046","['ColumnFamilyStore.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-1678
4ec4ab992f8adc0a60055a60525e9d11a28bc2ae,"Add client warnings and abort to tombstone and coordinator reads which go past a low/high watermark

patch by David Capwell; reviewed by Blake Eggleston, Marcus Eriksson for CASSANDRA-16850","['Config.java', 'DatabaseDescriptor.java', 'SelectStatement.java', 'SinglePartitionReadCommand.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-1685
585bc692918deea2b8c4b1098ee7e7478881f138,"Move RepairedDataInfo to the execution controller rather than the ReadCommand to avoid unintended sharing

patch by Caleb Rackliffe; reviewed by Sam Tunnicliffe and Alex Petrov for CASSANDRA-16721

Co-authored-by: Sam Tunnicliffe <sam@beobal.com>
Co-authored-by: Caleb Rackliffe <calebrackliffe@gmail.com>","['SinglePartitionReadCommand.java', 'StorageProxy.java']",CASSANDRA-1672
f59411f1c985043850154971e9c4066013f355cb,"Tolerate missing DNS entry when completing host replacement

patch by Chris Lohfink; reviewed by Brandon Williams for CASSANDRA-16873

Co-authored by Chris Lohfink <clohfink@apple.com>
Co-authored by Josh McKenzie <jmckenzie@apache.org>",['StorageService.java'],CASSANDRA-1687
c36c081e5c33362daae748c2da1be4da9ef18fa6,"Delay auth setup until after gossip has settled to avoid unavailables on startup

Patch by marcuse; reviewed by Sam Tunnicliffe for CASSANDRA-16783

Co-authored-by: Caleb Rackliffe <calebrackliffe@gmail.com>","['CassandraDaemon.java', 'StorageService.java']",CASSANDRA-1678
57f53f53ae811f00cf9c1f84bd0414d99391f1ce,"Avoid removing batch when it's not created during view replication
patch by Zhao Yang, Ekaterina Dimitrova; reviewed by Zhao Yang, Ekaterina Dimitrova, Brandon Williams for CASSANDRA-16175

Co-authored-by: Zhao Yang <zhao.yang@datastax.com>
Co-authored-by: Ekaterina Dimitrova <ekaterina.dimitrova@datastax.com>",['StorageProxy.java'],CASSANDRA-16175
e86ae7fbe52c95747d69f7d78b6da6fbd34bd48d,"make creation timestamp consistent for all tables of a snapshot

patch by Stefan Miklosovic; reviewed by Paulo Motta and Aleksei Zotov for CASSANDRA-16920","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-1692
b9d8700355bf0ecabe1ca7e3f139d0ad52c4bdc4,"Avoid trying to acquire 0 permits from the rate limiter when taking snapshot

Patch by marcuse; reviewed by Alex Petrov for CASSANDRA-16872","['ColumnFamilyStore.java', 'SSTableReader.java']",CASSANDRA-1687
c7526f943f50e994e94c8287c772c856961833f2,"Add soft/hard limits to local reads to protect against reading too much data in a single query

patch by David Capwell; reviewed by Caleb Rackliffe and Marcus Eriksson for CASSANDRA-16896","['Config.java', 'DatabaseDescriptor.java', 'SelectStatement.java', 'StorageService.java']",CASSANDRA-1689
15a2fe00fc9817874f4c1600d56a373c21b1ad1c,"[CASSANDRA-16923] CEP-10 Phase 1: Mockable System Clock

Co-authored-by: Benedict Elliott Smith <benedict@apache.org>
Co-authored-by: Aleksey Yeschenko  <aleksey@apache.org>
Co-authored-by: Sam Tunnicliffe <samt@apache.org>","['SelectStatement.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'MessagingService.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-16923
13632e9a99e8256a565bd6919d2d11b3e476e973,"Avoid re-prepare storm on qualified statements after `use`

Patch by Alex Petrov; reviewed by Marcus Eriksson for CASSANDRA-15252",['SelectStatement.java'],CASSANDRA-1525
2e2db4dc40c4935305b9a2d5d271580e96dabe42,"Verify correct ownership of attached locations on disk at startup

patch by Sam Tunnicliffe; reviewed by Chris Earman, Xiaolong Jiang, and Caleb Rackliffe for CASSANDRA-16879

Co-authored by Sam Tunnicliffe <sam@beobal.com>
Co-authored by Josh McKenzie <jmckenzie@apache.org>",['CassandraDaemon.java'],CASSANDRA-1687
e5b92e108851d2be81c43cbf982564f92d28aa6b,"[CASSANDRA-16924] CEP-10 Phase 1: Mockable Blocking Concurrency Primitives

patch by Benedict; reviewed by Sam Tunnicliffe and Aleksei Zotov for CASSANDRA-16924

Co-authored-by: Benedict Elliott Smith <benedict@apache.org>
Co-authored-by: Sam Tunnicliffe <samt@apache.org>","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-16924
be1f050bc8c0cd695a42952e3fc84625ad48d83a,"[CASSANDRA-16925] CEP-10 Phase 1: Mockable Task Execution

Co-authored-by: Benedict Elliott Smith <benedict@apache.org>
Co-authored-by: Sam Tunnicliffe <samt@apache.org>","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-16925
6a1d9de3d938d24baa2ba98b5379b0536177c786,"[CASSANDRA-16926] CEP-10 Phase 1: Mockable Filesystem

patch by Benedict; reviewed by Aleksey Yeschenko, Sam Tunnicliffe and Aleksei Zotov for CASSANDRA-16926

Co-authored-by: Benedict Elliott Smith <benedict@apache.org>
Co-authored-by: Aleksey Yeschenko  <aleksey@apache.org>","['DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-16926
aae7e8b07c84476de893b473a13cdc6d9e260573,"[CASSANDRA-16928] CEP-10 Phase 1: InetAddressAndPort extends InetSocketAddress

patch by Benedict; reviewed by Sam Tunnicliffe, Caleb Rackliffe and Aleksei Zotov for CASSANDRA-16928",['StorageService.java'],CASSANDRA-16928
5b82447098ad634900f8892297ef82083eadb954,[CASSANDRA-17013] CEP-10 Phase 1: in-jvm-dtest-api changes and version bump,['SSTableReader.java'],CASSANDRA-17013
ce2a0a28bc9ca21e1fae29f2a38448a877db06c3,"[CASSANDRA-16932] CEP-10 Phase 2: Minor Gossip Fixes

* Ensure we apply new states in correct order so as not to lose TOKEN message
* Permit replacement nodes to join the ring with lower heartbeat state than
  node being replaced",['StorageService.java'],CASSANDRA-16932
fe9cff663b48fecdb964caaded2004e83a0c89f4,"[CASSANDRA-16930] CEP-10 Phase 2: Improved Configuration For Controlling Determinism

Co-authored-by: Benedict Elliott Smith <benedict@apache.org>
Co-authored-by: Sam Tunnicliffe <samt@apache.org>
Co-authored-by: Caleb Rackliffe <calebrackliffe@gmail.com>","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-16930
5ab15316e1cd83c129f3a66ba89e0fdcb60e4dfd,"Allow reverse iteration order during resource permissions checking

Patch by Sam Tunnicliffe; reviewed by Blake Eggleston, Jeff Jirsa, and Aleksei Zotov for CASSANDRA-17016

Co-authored by Sam Tunnicliffe <sam@beobal.com>
Co-authored by Josh McKenzie <jmckenzie@apache.org>","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-1701
ab920c30310a8c095ba76b363142b8e74cbf0a0a,"Add a Denylist to block reads and writes on specific partition keys

Patch by Josh McKenzie, reviewed by Aleksei Zotov and Sumanth Pasupuleti for CASSANDRA-12106

Co-authored by Josh McKenzie <jmckenzie@apache.org>
Co-authored by Sam Overton","['Config.java', 'DatabaseDescriptor.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-12106
2fc7206128384b2b412042ef17ee86cd32fd595c,"Forbid other Future implementations with checkstyle

patch by Benedict Elliott Smith; reviewed by David Capwell for CASSANDRA-17055",['MessagingService.java'],CASSANDRA-1705
599294c919df10a4aea592d78364af565d8ff1ed,"Replace System.currentTimeMillis with Clock.Global.currentTimeMillis

Patch by brandonwilliams; reviewed by bereng for CASSANDRA-17123",['SSTableReader.java'],CASSANDRA-1712
63292292b8dbe3bb4f691f82823dcdc0172d2291,"Implement Virtual Tables for Auth Caches

Patch by Aleksei Zotov; reviewed by Sam Tunnicliffe, and Benjamin Lerer for CASSANDRA-16914",['NodeProbe.java'],CASSANDRA-1691
77dde2a3c4b40da3d820d4852c572338acbf6dc9,"Introduce separate rate limiting settings for entire SSTable streaming

patch by Francisco Guerrero; reviewed by Dinesh Joshi, Marcus Eriksson, Yifan Cai for CASSANDRA-17065","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-1706
dd6242037b6c78eed0994638c20ec82ecf78c43c,"Queries performed with NODE_LOCAL consistency level do not update request metrics

patch by Aleksey Yeschenko; reviewed by Alex Petrov for CASSANDRA-17052",['StorageProxy.java'],CASSANDRA-1705
b6f61e850c8cfb1f0763e0f15721cde8893814b5,"Remove unused configuration parameters from cassandra.yaml
patch by Ekaterina Dimitrova; reviewed by Berenguer Blasi for CASSANDRA-17132","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-17132
44ace88585f2aefc322465ed6b6f6ad5bfd5bb34,"internode_send_buff_size_in_bytes and internode_recv_buff_size_in_bytes have new names. Backward compatibility with the old names added
patch by Ekaterina Dimitrova; reviewed by David Capwell for CASSANDRA-17141",['Config.java'],CASSANDRA-17141
33fd2dc817f56116af0b4b7d2cd5365ce52948d9,"Log queries that fail on timeout or unavailable errors up to once per minute by default

patch by Caleb Rackliffe and Marcus Eriksson; reviewed by David Capwell and Yifan Cai for CASSANDRA-17159

Co-authored-by: Caleb Rackliffe <calebrackliffe@gmail.com>
Co-authored-by: Marcus Eriksson <marcuse@apache.org>",['StorageProxy.java'],CASSANDRA-1715
31bea0b0d41e4e81095f0d088094f03db14af490,"[CEP-10] Cluster and Code Simulations: Minor fixes

- fix repair timeout
- fix secondary index flushing
- fix race condition with Ref
- fix resource leaks
- fix incorrect exists()
- fix repair error reporting when null exception message
- fix dtest use of System.nanoTime

patch by Benedict; reviewed by Sam Tunnicliffe for CASSANDRA-17008","['ColumnFamilyStore.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-1700
eae581a5f07c340594f6af47bb558693ef363611,"[CEP-10] Cluster and Code Simulations: Minor improvements

- Simplify Semaphore
- Future improvements
- ScheduledExecutorPlus improvements for simulator compatibility
- Debug leaks in Ref or BufferPool
- Support use of TokenMetadata without initialising Cassandra
- Additional system properties and simulator flags
- Permit Clock initialisation within separate ClassLoader
- Introduce BallotGenerator

patch by Benedict; reviewed by Sam Tunnicliffe for CASSANDRA-17008","['DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-1700
7871a2854217acc89d2f885619243a442cf68e22,"Add guardrails framework prototype

patch by Andrés de la Peña; reviewed by David Capwell and Stefan Miklosovic for CASSANDRA-17147

Co-authored-by: Sylvain Lebresne <lebresne@gmail.com>
Co-authored-by: Andrés de la Peña <a.penya.garcia@gmail.com>
Co-authored-by: Aleksandr Sorokoumov <aleksandr.sorokoumov@gmail.com>
Co-authored-by: Zhao Yang <jasonstack.zhao@gmail.com>
Co-authored-by: Jakub Żytka <jakub.zytka@datastax.com>","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-1714
d9460a04daee5fa97639abf2b6e28ff9b29cf636,"Add non-blocking mode for CDC writes

patch by Yifan Cai; reviewed by Josh McKenzie for CASSANDRA-17001","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-1700
a41cdd64b217c451b5576abe2f455eaa7ec1f322,"Allow column_index_size_in_kb to be configurable through nodetool

patch by Francisco Guerrero; reviewed by Dinesh Joshi, Yifan Cai for CASSANDRA-17121","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-1712
95522f85d5e14734f9af3096953974a4f48a884f,"Add guardrail for list operations that require read before write

patch by Andrés de la Peña; reviewed by Ekaterina Dimitrova for CASSANDRA-17154",['StorageProxy.java'],CASSANDRA-1715
c420d754d8571120e58b2fe4838c766d26169d7d,"CASSANDRA-16308: Add droppable tombstone metrics to nodetool tablestats

patch by Krishna Vadali; reviewed by Paulo Motta and Brandon Williams for CASSANDRA-16308

Closes #1359",['NodeProbe.java'],CASSANDRA-16308
bc20bddcebd6a37b14cfbdd50c359be4c9743f73,"Make capacity/validity/updateinterval/activeupdate for Auth Caches configurable via nodetool

patch by Aleksei Zotov; reviewed by Josh McKenzie for CASSANDRA-17063",['NodeProbe.java'],CASSANDRA-1706
9ff28fc717e7926b5cf7c8acc85a35e0cfb43595,"Fixes for intermittent in-JVM dtest failures

patch by Jon Meredith, Caleb Rackliffe, Marcus Eriksson, Benedict Elliott Smith <benedict@apache.org>; reviewed by Caleb Rackliffe for CASSANDRA-17256",['StorageService.java'],CASSANDRA-1725
28eea6e8cd4055c8d21f872c72f8bd14fd2467ba,"Runtime-configurable YAML option to prohibit USE statements

patch by Caleb Rackliffe; reviewed by David Capwell for CASSANDRA-17318","['Config.java', 'DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-1731
5bb4bab12f8edfef95ed13cbabf8c0f377986065,"DataRate parameters transition to the new framework
Fix the DB descriptorRefTest which failed on the previous commit
patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe, David Capwell, Michael Semb Wever and Benjamin Lerer for CASSANDRA-15234","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-15234
a3258d66bcc9f946304c19d59e75d2721126303e,"Transfer parameters to the newly introduced configuration framework (1)
patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe, David Capwell, Michael Semb Wever and Benjamin Lerer for CASSANDRA-15234","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-15234
b9e2ab75f8f6dedd45c6ad7a83b3160149869262,"Extend DurationSpec and DataStorageSpec for smallest unit and transfer denylist parameters to the new framework
patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe, David Capwell, Michael Semb Wever and Benjamin Lerer for CASSANDRA-15234","['Config.java', 'DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-15234
d85f7f7c2dd4b9bbdb44bc96235e6a8bc3ff3967,"Transfer parameters to the newly introduced configuration framework (2)
patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe, David Capwell, Michael Semb Wever and Benjamin Lerer for CASSANDRA-15234","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-15234
755fd9446b084e659e98bd7336b9e910c2e12577,"Transfer parameters to the newly introduced configuration framework (3)
patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe, David Capwell, Michael Semb Wever and Benjamin Lerer for CASSANDRA-15234","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-15234
ed48f3c017c5e572a523890bcd5b7c798d7eb358,"Transfer parameters to the newly introduced configuration framework (4)
patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe, David Capwell, Michael Semb Wever and Benjamin Lerer for CASSANDRA-15234","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-15234
1315d0c96f4625a76296f58d431f97669e5178c2,"Transfer parameters to the newly introduced configuration framework (5)
patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe, David Capwell, Michael Semb Wever and Benjamin Lerer for CASSANDRA-15234","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-15234
23138252f20891c26a3692664c6affaf99e86541,"Transfer parameters to the newly introduced configuration framework (6)
patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe, David Capwell, Michael Semb Wever and Benjamin Lerer for CASSANDRA-15234","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-15234
6d5203615f7a9670cb1698b74123666bc25ba471,"Transfer parameters to the newly introduced configuration framework (7)
patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe, David Capwell, Michael Semb Wever and Benjamin Lerer for CASSANDRA-15234","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-15234
c51a7c66fc21ca2da08b89ae5f9b4817ee4d8c23,"Bulk change of units around the code to support the move to the new configuration framework
patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe, David Capwell, Michael Semb Wever and Benjamin Lerer for CASSANDRA-15234","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-15234
9f56bf4ca7fdb61ad09e5f2ad09b87cd01e0716b,"Remove old Duration class in favor of DurationSpec class
patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe, David Capwell, Michael Semb Wever and Benjamin Lerer for CASSANDRA-15234","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-15234
3a6f6907314670fdb2b316db8f08ffd85da88851,"Limit the maximum hints size per host

patch by Yifan Cai; reviewed by Dinesh Joshi, Francisco Guerrero for CASSANDRA-17142","['Config.java', 'DatabaseDescriptor.java', 'StorageProxy.java']",CASSANDRA-1714
537ad9e17b820e48df78a7edfe6b3a17d56e08bc,"Deprecate otc_coalescing_strategy, otc_coalescing_window_us, otc_coalescing_enough_coalesced_messages,
otc_backlog_expiration_interval_ms (CASSANDRA-17377)
patch by Ekaterina Dimitrova; reviewed by Brandon Williams for CASSANDRA-17377",['Config.java'],CASSANDRA-17377
22a4ae16e46639c0ecc9934352499a3ea664f8d7,"Deprecate JavaScript user-defined functions
patch by Ekaterina Dimitrova; reviewed by Berenguer Blasi and Marcus Eriksson for CASSANDRA-17280",['DatabaseDescriptor.java'],CASSANDRA-17280
65fcc79b628a7e415b57c27c596ea1cb5e67211d,"Revert removal of deprecated max_streaming_retries into Config, revert name change to user_defined_function_warn_timeout and user_defined_function_fail_timeout
patch by Ekaterina Dimitrova; reviewed by David Capwell for CASSANDRA-17378","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-17378
12e2c159f86b223df1c2018c8a395a805b11956e,"Forward port from cassandra-4.0(CASSANDRA-17377) - deprecation of otc_coalescing_strategy, otc_coalescing_window_us, otc_coalescing_enough_coalesced_messages, otc_backlog_expiration_interval_ms
patch by Ekaterina Dimitrova; reviewed by David Capwell for CASSANDRA-17378",['Config.java'],CASSANDRA-17377
eac9d925621dc1757ac88ac7160dc0b2bd3e0015,"make startup checks configurable

patch by Stefan Miklosovic; reviewed by Paulo Motta for CASSANDRA-17220","['Config.java', 'DatabaseDescriptor.java', 'CassandraDaemon.java']",CASSANDRA-1722
ae50cbd1ad2120bb070489e7b94d1f8ca393a4b9,"deprecate property windows_timer_interval

patch by Stefan Miklosovic; reviewed by Ekaterina Dimitrova and Berenguer Blasi for CASSANDRA-17404",['Config.java'],CASSANDRA-1740
b18a9f03377059d9caae8894e8734c2380344b66,"Validate existence of DCs when repairing

Patch by Jan Karlsson; reviewed by bereng and brandonwilliams for
CASSANDRA-17407",['StorageService.java'],CASSANDRA-1740
60675cc2759db0c5629604279e70c51e10dfefd6,"Remove and ban use of Instant.now

Patch by marcuse; reviewed by Benedict Elliott Smith for CASSANDRA-17414","['ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-1741
5a0d6154d144b958404a4d7117602d35157848ba,"[CASSANDRA-17176] Introduce TimeUUID

patch by Benedict; reviewed by Blake Eggleston for CASSANDRA-17176","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageProxy.java']",CASSANDRA-17176
8960b4d8513e22c4c11c181c520380342935aee7,[CASSANDRA-17177] List Appends Are Not Linearizable,['StorageProxy.java'],CASSANDRA-17177
2b2c6decfafc6235ad537e72073fab2fd4467e2f,"Refactor schema management to allow for schema source pluggability

Patch by Jacek Lewandowski, reviewed by Alex Petrov for CASSANDRA-17044.","['ColumnFamilyStore.java', 'CompactionManager.java', 'MessagingService.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-1704
935bcf1e8732a4138c15205896945c2f02ddb844,"Add guardrails for collection items and size

patch by Andrés de la Peña; reviewed by Berenguer Blasi for CASSANDRA-17153",['Config.java'],CASSANDRA-1715
fbd6b047915d9810bf5e3131ba11c9374b3834a3,"Log largest memtable on flush at info rather than debug

Patch by Josh McKenzie; reviewed by Brandon Williams for CASSANDRA-17472",['ColumnFamilyStore.java'],CASSANDRA-1747
0040fea3797ea3e497691e9d1e2660711c60ac4d,"Implement sstable generation identifier as uuid

Patch by Jacek Lewandowski; reviewed by Andrés de la Peña, Benjamin Lerer and Dan Jatnieks for CASSANDRA-17048","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SSTableReader.java', 'CassandraDaemon.java']",CASSANDRA-1704
57ab3afcf16970047d3df4656241cf0705e94bee,"reduce hot-path object allocations required to record local/remote requests against the client request metrics

patch by Caleb Rackliffe; reviewed by Jon Meredith for CASSANDRA-17424

Co-authored-by: Marcus Eriksson <marcuse@apache.org>
Co-authored-by: Caleb Rackliffe <calebrackliffe@gmail.com>",['StorageProxy.java'],CASSANDRA-1742
f32d2b06de63258888f28c0dba33db4912be6da8,"Upgrade slf4j to 1.7.25

Patch by brandonwilliams; reviewed by bereng for CASSANDRA-17474",['StorageProxy.java'],CASSANDRA-1747
910bbb9b5fced249696930c2e38240a9b0f51bb5,"Add guardrail to disallow creation of secondary indexes

Patch by Josh McKenzie; reviewed by Chris Lohfink for CASSANDRA-17498",['Config.java'],CASSANDRA-1749
20175bf77e2c6f72c25240ee445b583805a37630,"Remove guardrails global enable flag

patch by Savni Nagarkar; reviewed by Andrés de la Peña and Joshua McKenzie for CASSANDRA-17499",['Config.java'],CASSANDRA-1749
47cac5c49b93d205fa9b3a57ce55470887c5be45,"Provide JMX endpoint to allow transient logging of blocking read repairs

Patch by Josh McKenzie; reviewed by David Capwell for CASSANDRA-17471

Co-authored-by: Aleksey Yeschenko <aleksey@apache.org>
Co-aurhoted-by: Josh McKenzie <jmckenzie@apache.org>",['StorageProxy.java'],CASSANDRA-1747
74bb6d8496d5a2a5b89a843ba764fe37b65ee331,"Shutdown ScheduledExecutors as part of node drainage

patch by Stefan Miklosovic; reviewed by Jon Meredith for CASSANDRA-17493",['StorageService.java'],CASSANDRA-1749
dac738d2eba8629d4f482d7cbfd855d2c5b9df47,"Transfer config parameters to the new types; Fix corner case for permissions_update_interval, roles_update_interval, credentials_update_interval;Fix typo in Config annotation; Made Converters type safe and fixed a few cases where converters used the wrong type; o should be provided with unit to DataStorageSpec and DurationStorageSpec; Fix null bug in DataStorageSpec and DurationSpec
patch by Ekaterina Dimitrova, David Capwell; reviewed by David Capwell and Caleb Rackliffe for CASSANDRA-17431

Co-authored-by: Ekaterina Dimitrova <ekaterina.dimitrova@datastax.com>
Co-authored-by: David Capwell <dcapwell@apache.org>","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-17431
7db3285e7b745e591dc4c405ae9af6c1cddb0c79,"Migrate track_warnings to more standard naming conventions and use latest configuration types rather than long

patch by David Capwell; reviewed by Andres de la Peña, Caleb Rackliffe for CASSANDRA-17560","['Config.java', 'DatabaseDescriptor.java', 'SelectStatement.java', 'StorageService.java']",CASSANDRA-1756
b3842de5cf1fa1b81872effb4585fbc7e1873d59,"Add guardrail for data disk usage

patch by Andrés de la Peña; reviewed by Ekaterina Dimitrova and Stefan Miklosovic for CASSANDRA-17150

Co-authored-by: Andrés de la Peña <a.penya.garcia@gmail.com>
Co-authored-by: Zhao Yang <jasonstack.zhao@gmail.com>
Co-authored-by: Eduard Tudenhoefner <etudenhoefner@gmail.com>","['Config.java', 'StorageService.java']",CASSANDRA-1715
2b90ac1a1671b4071d9aa6f18e852021bc66702d,"nodetool compact should support using a key string to find the range to avoid operators having to manually do this

patch by David Capwell; reviewed by Marcus Eriksson for CASSANDRA-17537","['ColumnFamilyStore.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-1753
545809616c92a91e4c39d1eedfa65800f25a2a93,"Track top partitions by size and tombstone count

Patch by marcuse; reviewed by David Capwell and Yifan Cai for CASSANDRA-16310","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java']",CASSANDRA-1631
6bd373f5d27754f80384caa31d1b2a4cfc43bc19,"Add guardrail to disallow TRUNCATE and DROP TABLE commands

Patch by Josh McKenzie; reviewed by Aleksey Yeschenko for CASSANDRA-17558",['Config.java'],CASSANDRA-1755
da7c66222740f02c6de5b563681dd381d28f8201,"Migrate threshold for minimum keyspace replication factor to guardrails

patch by Savni Nagarkar; reviewed by Andres de la Peña, David Capwell for CASSANDRA-17212","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-1721
7741eacc546f80fe4324c7821fcf2c029f64b1f9,"Add auto_snapshot_ttl configuration

Patch by Paulo Motta; Reviewed by Stefan Miklosovic for CASSANDRA-16790

Co-authored-by: fibersel <0583463@gmail.com>","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java']",CASSANDRA-1679
61d4cccb0b137422f8cc8e2a294700753c5a6247,"Fix URISyntaxException in nodetool with updated Java

Patch by Jermy Li; reviewed by bereng and brandonwilliams for
CASSANDRA-17581",['NodeProbe.java'],CASSANDRA-1758
030831c5f5457c37ba78f0539898bb6cbd676823,"Rename truncate_drop guardrail to drop_truncate_table

Patch by Josh McKenzie; reviewed by Andres de la Pena for CASSANDRA-17592",['Config.java'],CASSANDRA-1759
ce515a3d77c2042575827e8bdb1da639fc957491,"Add guardrail for ALTER TABLE ADD / DROP / REMOVE column operations

Patch by Josh McKenzie; reviewed by Jon Meredith for CASSANDRA-17495","['Config.java', 'StorageService.java']",CASSANDRA-1749
6396562f71316838083618714b142fd982ae0155,"StorageService read threshold get methods throw NullPointerException due to not handling null configs

patch by David Capwell; reviewed by Berenguer Blasi for CASSANDRA-17593","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-1759
f57c8d2c25f3a7c2b845ad9205ad25a9b04cca34,"Fix repair_request_timeout_in_ms and remove paxos_auto_repair_threshold_mb
patch by Benedict Elliott Smith and Ekaterina Dimitrova; reviewed by Benedict Elliott Smith and Blake Eggleston for CASSANDRA-17557","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-17557
26dd119679605bf61ad3caa24a70509e5be5aac9,"Add new CQL function maxWritetime

patch by Yifan Cai; reviewed by Andres de la Peña, Francisco Guerrero for CASSANDRA-17425",['SelectStatement.java'],CASSANDRA-1742
c635f198f6ceca272e61b857b67fd91f23da3836,"Fix leak of non-standard Java types in our Exceptions as clients using JMX are unable to handle them
Remove useless validation that leads to unnecessary additional read of cassandra.yaml on startup
patch by Ekaterina Dimitrova; review by David Capwell for CASSANDRA-17638",['DatabaseDescriptor.java'],CASSANDRA-17638
14fbab15bd264dd1cf894bf48170cf4f30ada8a0,"Add guardrail to allow disabling SimpleStrategy

Patch by Josh McKenzie; reviewed by Aleksey Yeschenko for CASSANDRA-17647",['Config.java'],CASSANDRA-1764
c3998ef6018644ff4d3aebcd0b7e3e1d566663f0,"Return an empty collection when a node is not a member

Patch by brandonwilliams; reviewed by adelapena for CASSANDRA-17680",['StorageService.java'],CASSANDRA-1768
51ce71881c87df754969809b5f6b2a466abc1e35,"filter out dead replicas for counter writes

Patch by brandonwilliams; reviewed by adelapena for CASSANDRA-17411",['StorageProxy.java'],CASSANDRA-1741
07e5876c43998fe7384df115c65749d668183130,"Add toBytesInLong to IntKibibytesBound to support widening to long in getBatchSizeFailThreshold
patch by Akin Tekeoglu; reviewed by Ekaterina Dimitrova and Andres de la Peña for CASSANDRA-17650",['DatabaseDescriptor.java'],CASSANDRA-17650
60b54425edc0a328bc1baf00c2e5bf111d4b9da8,"Fix commitLogUpperBound initialization in AbstractMemtableWithCommitlog
so that it is always available when writeBarrier gets initialized.

Harden Memtable API so that it is apparent that getting commitLogUpperBound
is valid only after it is fully established.

patch by Jakub Żytka and Dan Jatnieks;
reviewed by Dan Jatnieks, Jeremiah D Jordan and Caleb Rackliffe for CASSANDRA-17587",['ColumnFamilyStore.java'],CASSANDRA-1758
46d9cbe2f66b02cedf1b7961c4c1194488e1323b,"min_tracked_partition_size_bytes parameter from 4.1 alpha1 was renamed to min_tracked_partition_size
patch by Ekaterina Dimitrova; reviewed by Berenguer Blasi for CASSANDRA-17733","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-17733
55f094a6d2c288b74e6ea86edaa7c45cd494c208,"Remove ephemeral snapshot marker file and introduce a flag to SnapshotManifest

patch by Stefan Miklosovic; reviewed by Paulo Motta for CASSANDRA-16911","['ColumnFamilyStore.java', 'CassandraDaemon.java', 'StorageService.java']",CASSANDRA-1691
860ec627a14068f5180c44b7cf47dd264978a328,"Fix issues with index_summary_resize_interval and index_summary_capacity
patch by Ekaterina Dimitrova; reviewed by Andres de la Pena for CASSANDRA-17735",['DatabaseDescriptor.java'],CASSANDRA-17735
1c70149ef512212d9cf8f57cb703fce92bf3dafa,"Fix Settings Virtual Table to update paxos_variant after startup and rename enable_uuid_sstable_identifiers to uuid_sstable_identifiers_enabled as per our config naming conventions
patch by Ekaterina Dimitrova; reviewed by Brandon Williams for CASSANDRA-17738","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-17738
1f067051537618804ca9d0c66b903be74b942b22,"When doing a host replacement, -Dcassandra.broadcast_interval_ms is used to know when to check the ring but checks that the ring wasn't changed in -Dcassandra.ring_delay_ms, changes to ring delay should not depend on when we publish load stats

patch by David Capwell; reviewed by Brandon Williams, Caleb Rackliffe for CASSANDRA-17776",['StorageService.java'],CASSANDRA-1777
04901913d61f047e806bb4c2bbd530677958a919,"Fix Setting Virtual Table to update after startup config properties gc_log_threshold_in_ms, gc_warn_threshold_in_ms, conf.index_summary_capacity_in_mb, prepared_statements_cache_size_mb, key_cache_size_in_mb, counter_cache_size_in_mb
patch by Ekaterina Dimitrova; reviewed by Andres de la Pena for CASSANDRA-17737","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-17737
fe28f482db0e1bc81936a62d0564e9657f428d2a,"Fix sstable_preemptive_open_interval_in_mb disabled value - backward compatibility
patch by Ekaterina Dimitrova; reviewed by Andres de la Pena and Jon Meredith for CASSANDRA-17737","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-17737
0daf21244fc0187d092616834d38df1a77dcabf0,"Add JMX call to getSSTableCountPerTWCSBucket for TWCS

Patch by Stefan Podkowinski; reviewed by Caleb Rackliffe and Marcus Eriksson for CASSANDRA-17774

Co-authored-by: Stefan Podkowinski <s.podkowinski@gmail.com>
Co-authored-by: Josh McKenzie <jmckenzie@apache.org>",['ColumnFamilyStore.java'],CASSANDRA-1777
dd08314ed654aafa60b2a82fc4953aac171ba3ef,"Uncomment prepared_statements_cache_size, key_cache_size, counter_cache_size, index_summary_capacity which were
commented out by mistake in a previous patch;
Fix breaking change with cache_load_timeout; cache_load_timeout_seconds <=0 and cache_load_timeout=0 are equivalent
and they both mean disabled;
Deprecate public method setRate(final double throughputMbPerSec) in Compaction Manager in favor of
setRateInBytes(final double throughputBytesPerSec);
Revert breaking change removal of StressCQLSSTableWriter.Builder.withBufferSizeInMB(int size). Deprecate it in favor
of StressCQLSSTableWriter.Builder.withBufferSizeInMiB(int size);
Fix precision issues, add new -m flag (for nodetool/setstreamthroughput, nodetool/setinterdcstreamthroughput,
nodetool/getstreamthroughput and nodetoo/getinterdcstreamthroughput), add new -d flags (nodetool/getstreamthroughput,
 nodetool/getinterdcstreamthroughput, nodetool/getcompactionthroughput);
Fix a bug with precision in nodetool/compactionstats;
Deprecate StorageService methods and add new ones for stream_throughput_outbound, inter_dc_stream_throughput_outbound,
compaction_throughput_outbound in the JMX MBean `org.apache.cassandra.db:type=StorageService`;
Removed getEntireSSTableStreamThroughputMebibytesPerSec in favor of new getEntireSSTableStreamThroughputMebibytesPerSecAsDouble
in the JMX MBean `org.apache.cassandra.db:type=StorageService`;
Removed getEntireSSTableInterDCStreamThroughputMebibytesPerSec in favor of getEntireSSTableInterDCStreamThroughputMebibytesPerSecAsDouble
in the JMX MBean `org.apache.cassandra.db:type=StorageService`

Patch by Ekaterina Dimitrova; reviewed by Caleb Rackliffe, Francisco Guerrero for CASSANDRA-17225","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-1722
652e49a8bb2f8849ce0ebb5161c30e3889c14608,"Add separate thread pool for Secondary Index building so it doesn't block compactions

Patch by Chris Lohfink; reviewed by Caleb Rackliffe, Josh McKenzie, Sam Tunnicliffe, and Marcus Eriksson for CASSANDRA-17781

Co-authored-by: Chris Lohfink <clohfink@apple.com>
Co-authored-by: Josh McKenzie <jmckenzie@apache.org>","['Config.java', 'DatabaseDescriptor.java', 'CompactionManager.java']",CASSANDRA-1778
e5e13c02ccf386093153fd6824fd85ef7bd24eb3,"Fix default value for compaction_throughput_mb_per_sec in Config class to match  the one in cassandra.yaml
patch by Ekaterina Dimimtrova; reviewed by Francisco Guerrero, Michael Semb Wever for CASSANDRA-17790",['Config.java'],CASSANDRA-17790
f5dc9a1c1e27ac5ea0cb972ceaf68d5993804d6f,"Set default FD in DD client initialization

Patch by Doug Rohrer; reviewed by brandonwilliams and maedhroz for
CASSANDRA-17782",['DatabaseDescriptor.java'],CASSANDRA-1778
9184dd5a998366dc2b5c18d4954b13b033efcf80,"When doing a host replacement, we need to check that the node is a live node before failing with ""Cannot replace a live node...""

patch by Francisco Guerrero; reviewed by Brandon Williams, David Capwell for CASSANDRA-17805",['StorageService.java'],CASSANDRA-1780
4b7069c06c7913e1f3f2d5622d8cbc04746b0bac,"Add guardrail for column size

patch by Andrés de la Peña; reviewed by Ekaterina Dimitrova and David Capwell for CASSANDRA-17151",['Config.java'],CASSANDRA-1715
83c169ec9e36324f27bf562951362f4a03c3c688,"Fix BulkLoader to load entireSSTableThrottle and entireSSTableInterDcThrottle

patch by Francisco Guerrero; reviewed by Ekaterina Dimitrova, Yifan Cai for CASSANDRA-17677",['DatabaseDescriptor.java'],CASSANDRA-1767
5beab63b5550efb5e31e5005f90649661a9fe595,"Improve the way we handle repair message timeouts to avoid hanging repairs

Patch by marcuse; reviewed by David Capwell for CASSANDRA-17613","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-1761
377e114cb1459895423c292cb0bf7f921fd30e43,"Introduce compaction priorities to prevent upgrade compaction inability to finish

Patch by Alex Petrov; reviewed by Josh McKenzie and Marcus Eriksson for CASSANDRA-17851

Co-authored-by: Alex Petrov <oleksandr.petrov@gmail.com>
Co-authored-by: Josh McKenzie <jmckenzie@apache.org>","['ColumnFamilyStore.java', 'CompactionManager.java']",CASSANDRA-1785
d6aee7e08c658db9d394a6b7e3e27791b4d6854f,"Optionally avoid hint transfer during decommission

patch by Caleb Rackliffe; reviewed by Jon Meredith and Stefan Miklosovic for CASSANDRA-17808","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-1780
bd2ecb3454649d8c84cf0b1ce8c1e94ed1e06e74,"Add metrics around storage usage and compression

Patch by Caleb Rackliffe; reviewed by Abe Ratnofsky and Josh McKenzie for CASSANDRA-17898

Co-authored-by: Caleb Rackliffe <calebrackliffe@gmail.com>
Co-authored-by: Josh McKenzie <jmckenzie@apache.org>","['SSTableReader.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-1789
e89b214d069321c8968871b8eb7d51d4dfba7c33,"Allow disabling hotness persistence for high sstable counts

Patch by Caleb Rackliffe; reviewed by Chris Lohfink and Josh McKenzie for CASSANDRA-17868

Co-authored-by: Caleb Rackliffe <calebrackliffe@gmail.com>
Co-authored-by: Josh McKenzie <jmckenzie@apache.org>","['Config.java', 'DatabaseDescriptor.java', 'SSTableReader.java', 'StorageProxy.java']",CASSANDRA-1786
4c85c6a4030d7d613230cd4b2204c42f941fd552,"key_cache_save_period, row_cache_save_period, counter_cache_save_period are not deprecated and we should not emit deprecation warning on startup for them
Patch by Ekaterina Dimitrova; reviewed by Stefan Miklosovic for CASSANDRA-17904",['Config.java'],CASSANDRA-17904
872e34c2d613a43b2c2be75efa016b6943bf87ad,"add --older-than and --older-than-timestamp options for nodetool clearsnapshot

patch by Stefan Miklosovic; reviewed by Paulo Motta for CASSANDRA-16860","['StorageService.java', 'NodeProbe.java']",CASSANDRA-1686
3bdd2caa22a0413929188536b41d8117177574fa,"Fix StorageService.getNativeaddress handling of IPv6 addresses

StorageService.getNativeaddress does not currently correctly handle
IPv6 addresses correctly when NATIVE_ADDRESS_AND_PORT are not present in
that it simply concatenates the IP address with the default native port,
e.g.:

0:0:0:0:0:0:5a:3:9042

This does not parse into an InetSocketAddress as the address and port
can't be disambiguated.

Such a case would usually be present when there are 3.x nodes present in a
cluster with 4.0 nodes.

Change updates RPC_ADDRESS and else case to create InetAddressAndPort instances
with DatabaseDescriptor.getNativeTransportPort and returns the
getHostAddress(withPort) which properly bracket encodes the address,
e.g.:

[0:0:0:0:0:0:5a:3]:9042

which can be parsed as an InetSocketAddress.

patch by Andy Tolbert; reviewed by Ariel Weisberg, Brandon Williams for CASSANDRA-17945",['StorageService.java'],CASSANDRA-1794
4fc2d9e53985dc89b93bbac80bea9faa4a3d708b,"Include estimated active compaction remaining write size when starting a new compaction

Patch by Marcus Eriksson; reviewed by Chris Lohfink, Stefan Podkowinski, Caleb Rackliffe,and Josh McKenzie for CASSANDRA-17931

Co-authored-by: Marcus Eriksson <marcuse@apache.org>
Co-authored-by: Josh McKenzie <jmckenzie@apache.org>","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-1793
c08981888181392017761606f4490cca7f977db9,"Make Cassandra logs able to be viewed in the virtual table system_views.system_logs

patch by Stefan Miklosovic; reviewed by Brandon Williams for CASSANDRA-17948",['CassandraDaemon.java'],CASSANDRA-1794
dd53a609c692c12ffb94acf9fcf81343e35723e9,"Add --resolve-ip option to nodetool gossipinfo

patch by Maxim Chanturiay; reviewed by Stefan Miklosovic and Caleb Rackliffe for CASSANDRA-17934",['NodeProbe.java'],CASSANDRA-1793
39a470235af13837a1a022ab0a1b6f8f062bcf6a,"Disable resumable bootstrap by default

Patch by Marcus Eriksson; reviewed by Jordan West, Blake Eggleston, and Josh McKenzie for CASSANDRA-17679

Co-authored-by: Marcus Eriksson <marcuse@apache.org>
Co-authored-by: Josh McKenzie <jmckenzie@apache.org>",['StorageService.java'],CASSANDRA-1767
9a0dd603b18ab5034df27443a4bbc10111edcd8b,"Log JVM Arguments at in-JVM Test Class Initialization

patch by Natnael Adere; reviewed by Caleb Rackliffe, David Capwell for CASSANDRA-16664",['CassandraDaemon.java'],CASSANDRA-1666
873e024a32d37de08550c8106a8d7fd52bda588b,CASSANDRA-17711: Add nodetool forcecompact,"['ColumnFamilyStore.java', 'CompactionManager.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-17711
13d495aa7d5b7a7c121fcc9e105f79107c5c2a1c,"fix intermittent failures in nodetool toppartitions caused by failure to validate invalid bytes

Patch by Jordan West; Reviewed by Brandon Williams and Cheng Wang for CASSANDRA-17254",['ColumnFamilyStore.java'],CASSANDRA-1725
797b96958af07945b0a1799024c1ef664dfee2e2,"Implement a guardrail for not having zero default_time_to_live on tables with TWCS

patch by Stefan Miklosovic; reviewed by Andrés de la Peña, Josh McKenzie, Brandon Williams and Brad Schoening for CASSANDRA-18042

Co-authored-by: Andrés de la Peña <a.penya.garcia@gmail.com>",['Config.java'],CASSANDRA-1804
3f83396b76115a25b8189410c68775f87f31f8ac,"Set the major compaction type correctly for compactionstats

Patch by Maxwell Guo; reviewed by brandonwilliams and blambov for CASSANDRA-18055",['CompactionManager.java'],CASSANDRA-1805
e936b2cc1ba7f525c636de5f9fb1780ca70f1762,"fix serialization error in getsstables --show-levels

Patch by Jordan West; Reviewed by Brandon Williams, Cheng Wang for CASSANDRA-18140;","['ColumnFamilyStore.java', 'NodeProbe.java']",CASSANDRA-1814
8bb9c72f582de6bcc39522ba9ade91fd5bc22f67,"Add safeguard so cleanup fails when node has pending ranges

Patch by Lindsey Zurovchak; Reviewed by Paulo Motta, Stefan Miklosovic for CASSANDRA-16418

Closes #2061","['CompactionManager.java', 'StorageService.java']",CASSANDRA-1641
9bf128aaa33c21427c826dab82414e3772d2ba24,"Improve unit tests performance

- Don't flush schema on every schema update in unit tests
- Use unix command to delete test data
- Shorten teardown
- Stable processor count presented by JMX on Jenkins, CircleCI and local

Patch by <jacek-lewandowski>, reviewed by <michaelsembwever> and <josh-mckenzie> for CASSANDRA-17427",['MessagingService.java'],CASSANDRA-1742
a0ec0ae303443b1d1cbfe845d94fccfb38123f8c,"Remove scripted UDFs, remove related tests or rewrite some tests to create java UDFs instead, where it makes sense
patch by Ekaterina Dimitrova; reviewed by Michael Semb Wever for CASSANDRA-18252","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-18252
24ebd24c79175f7426f4c489dc5a006e75f09dfb,"More accurate skipping of sstables in read path

This patch improves the following things:
1. SSTable metadata will store a covered slice instead of min/max clusterings. The difference is that for slices there is available the type of a bound rather than just a clustering. In particular it will provide the information whether the lower and upper bound of an sstable is opened or closed.
2. SSTable metadata will store a flag whether the SSTable contains any partition level deletions or not
3. The above two changes required to introduce a new major format for SSTables - oa
4. Single partition read command makes use of the above changes. In particular an sstable can be skipped when it does not intersect with the column filter, does not have partition level deletions and does not have statics; In case there are partition level deletions, but the other conditions are satisfied, only the partition header needs to be accessed (tests attached)
5. Skipping SSTables assuming those three conditions are satisfied has been implemented also for partition range queries (tests attached). Also added minor separate statistics to record the number of accessed sstables in partition reads because now not all of them need to be accessed.
6. Artificial lower bound marker is now an object on its own and is not implemented as a special case of range tombstone bound.
7. Extended the lower bound optimization usage due the 1 and 2
8. Do not initialize iterator just to get a cached partition and associated columns index. The purpose of using lower bound optimization was to avoid opening an iterator of an sstable if possible.
9. Add key range to stats metadata

[f369595b1c] Add fields to sstable version and placeholders in stats serializer
[f5c3f772e2] Add hasKeyRange and hasLegacyMinMax
[3cde51f4e1] Add partition level deletion presence marker to sstable stats
[67b2ee2152] Extract AbstractTypeSerializer
[c77b475d6c] Refactor slices intersection checking
[ceb5af3a38] Store min and max clustering as a slice in stats metadata as and improved min/max
[d1f8973929] Implement MetadataCollectorBench
[335369da84] Apply partition level deletion presence marker optimizations to single partition read command
[2497a009b9] Lower bound optimization - add slices and isReverseOrder fields to UnfilteredRowIteratorWithLowerBound
[e32ee31177] Lower bound optimization - Replace usage of RangeTombstoneMarker as a lower bound with ArtificialBoundMarker
[e213e712c4] Lower bound optimization - improve usage of lower bound optimization
[c4f93006b1] Apply read path improvements to partition range queries
[5fa462266c] Add key range to StatsMetadata
[79a7339ed4] Use key range from stats if possible
[266ed2749b] Added new sstables for LegacySSTableTest

patch by Jacek Lewandowski; reviewed by Branimir Lambov and C. Scott Andreas for CASSANDRA-18134

Co-authored-by: Branimir Lambov <blambov>
Co-authored-by: Sylvain Lebresne <pcmanus>
Co-authored-by: Jacek Lewandowski <jacek-lewandowski>
Co-authored-by: Jakub Zytka <jakubzytka>",['SinglePartitionReadCommand.java'],CASSANDRA-18134
b7e1e44a909c3a1d11e9c387db680c74d31b879f,"SSTable format API

Summary of the changes:

Format, reader and writer
---------------------------
There are a lot of refactorings around sstable related classes aiming to extract the most generic functionality to the top-level entities and push down implementation-specific stuff to the actual implementation. In Particular, the top-level, implementation agnostic classes/interfaces are SSTableFormat interface, SSTable, SSTableReader, SSTableWriter, IVerifier, and IScrubber. The rest of the codebase has been reviewed for explicit usages of big table format-specific usages of sstable classes and refactored. SSTable, SSTableReader, and SSTableWriter have their builders. Builders make a hierarchy that follows the same inheritance structure as readers and writers.

There are also partial implementations that add support for some features and may or may not be used by the custom implementations. They include:
- AbstractSSTableFormat - adds an implementation of some initialization methods - in practice, all of the format implementations should extend this class
- SSTableReaderWithFilter - add support for Bloom filter to the reader
- SortedTableWriter - generic implementation for a writer which writes partitions in the default order to the data file, supports Bloom filter and some index of partitions
- IndexSummarySupport - interface implemented by the readers using index summaries
- KeyCacheSupport - interface implemented by the readers using row key cache

Descriptor
---------------------------
Refactored the Descriptor class so that:
- All paths are created from the base directory File rather than from a String
- All the methods named *filename* producing full paths were made private; their current implementations are returning file names rather than paths (the naming was inconsistent)
- The usages of the `filenameFor` method were refactored to use the `fileFor` method
- The usages of the `fromFilename` method were refactored to use a  `fromFileWithComponent(..., false).left` expression
In essence, the Descriptor class is no longer working on String-based paths.

Index summaries
---------------------------
Removed the index summary from the generic SSTableReader class and created an interface IndexSummarySupport to be implemented by the readers that need it. Methods in related classes that refer back to the reader were refactored to support just readers of the SSTableReader & IndexSummarySupport type. Therefore, we will no longer need to assume that the generic SSTableReader has anything to do with an index summary.

A new IndexSummaryComponent class encloses data fields from the index summary file (note that aside from the index summary itself, the file includes the first and last partition of the sstable). The class has been extracted to deal with those fields and have that logic in a single place.

Filter
---------------------------
Refactored IFilter and its serialization - in particular, added the `serialize` method to the IFilter interface and moved loading/saving logic to a separate utility class FilterComponent.
Extracted the SSTableReaderWithFilter abstract reader extending the generic SSTableReader with filter support.
Extracted bloom filter metrics into separate entities allowing to plug them in if the implementation uses a filter.

Cache
---------------------------
Refactored CacheService to support different key-cache values. CacheService now supports arbitrary IRowIndexEntry implementation as a key-cache value. A new version of the auto-saving cache was created (""g"") because some information about the type of serialized row index entry needs to be known before it is deserialized (or skipped). Therefore, the SSTableFormat type ordinal number is stored, which is sufficient because the IRowIndexEntry serializer is specific to the sstable format type.
Similarly to the IndexSummarySupport, a new KeyCacheSupport interface has to be implemented to mark the reader as supporting key-cache. It contains the default implementation of several methods the rest of the system relies on when the key-cache is supported.

Other changes
---------------------------
- Fixed disabling chunk cache - enable(boolean) method in ChunkCache does not make any sense - it makes a false impression it can disable chunk cache once enabled, while in fact, it only clears it. Added setFileCacheEnabled to DatabaseDescriptor

- Made WrappingUnfilteredRowIterator an interface

- DataInputStreamPlus extends InputStream - this makes it possible for input stream-based inheritors of DataInputPlus to extend DataInputStreamPlus. It simplifies coding because sometimes we want to get DataInputPlus implementation extending InputStream as an argument.

- Table and keyspace metrics were made pluggable - in particular, added the ability for a certain format to register gauges that are specific only to that format and make no sense for others

- Implemented mmapped region extension for compressed data

- Refactored FileHandle so that it is no longer closable

- Implemented WrappingRebufferer

- Introduced the SSTable.Owner interface to make SSTable implementation not reference higher-level entities directly. SSTable accepts passing null as the owner when there is no owner (like sometimes in offline tools) or passing a mock when needed in tests.

Individual commits
---------------------------

[4a87cd36fe] Fix disabling chunk cache
[c84c75ccf3] Made WrappingUnfilteredRowIterator an interface
[253d2b828e] Add getType to SSTableFormat
[3f169dcc20] Remove getIndexSerializer from SSTableFormat
[05bae1833b] Pull down rowIndexEntrySerializer field
[da675f2809] Moved RowIndexEntry
[673f0c5c39] Reduce usages of RowIndexEntry
[c72538be91] Refactor CacheService to support for different key cache values
[54d33ee656] Minor refactoring of ColumnIndex
[93862df967] Just moved AbstractSSTableIterator to o.a.c.io.sstable.format
[9e4566a1de] Refactored AbstractSSTableIterator
[a4e61e80bb] Extracted IScrubber and IVerifier interfaces
[20f78c7419] Push down implementation of SSTableReader.firstKeyBeyond
[f2c24e5774] Moved SSTableReader.getSampleIndexesForRanges to IndexSummary
[b6c3a6c1ea] Moved SSTableReader.getKeySamples implementation to IndexSummary
[c4b90ebb33] Refactor InstanceTidier so that it is more generic
[918d5a9e74] Refactor dropping page cache
[a52fb4d558] Refactor sstable metrics
[f6d10f930f] NEW (fix up) - DataInputStreamPlus extends InputStream
[8f6a56d972] Getting rid of index summary in SSTableReader
[4a918bf725] Removed direct usages of primary index from SSTableReader
[358fa32602] Refactor KeyIterator so that it is sstable format agnostic
[14c09d89c2] Remove explicit usage of Components outside of format specific classes
[feff14e137] Move clone methods implementation from SSTableReader to BigTableReader
[64e9787b10] Move saveIndexSummary and saveBloomFilter to SSTableReaderBuilder
[ae71fe6ed8] Moved indexSummary field to BigTableReader and made it private
[df9fd8c4b9] Moved ifile field to BigTableReader and made it private
[2be6ea9ecf] Moved static open methods for BigTableReader to the reader factory
[bc0e55ac48] Minor refactoring around IFilter and its serialization
[5b95704beb] Minor refactorings around IndexSummary
[87812335e8] Extracted TOCComponent class to deal with TOC file
[fdad092a6a] Extracted CompressionInfoComponent class
[39b47e388d] Extracted StatsComponent as a helper for elements of SSTable metadata
[cdb55bff47] Fix SSTable.getMinimalKey
[b99c6d5805] Refactor FileHandle so that it is no longer closable
[77b7f7ace5] Implement WrappingRebufferer
[b6868914dd] Add progressPercentage to ProgressInfo
[7fd4956e5b] Moved copy/rename/hardLink methods from SSTableWriter to SSTable
[1ccc6bf148] Create generic SSTableBuilder and IOOptions
[da58a81102] Refactor SSTableReaderBuilder
[4501ddba1c] Refactor ColumnIndex
[d4f9e1a64b] Extracted non-big-table-specific functionality from BigTableWriter to SortedTableWriter
[379525d01e] Refactor BigTableZeroCopyWriter to SSTableZeroCopyWriter as it is not specific to big format
[8ac37f83bc] Extract EmptySSTableScanner out from BigTableScanner
[ee6673f1cf] Implement SSTableWriterBuilder
[bb26629235] Refactor opening early / final
[a327595015] Refactored SSTableWriter factory
[16ffd7334b] Extract non-big-format-specific logic from scrubber and verifier
[75e02db6af] Allow to specify the default SSTableFormat via system property
[a7b9d0d628] Small fixes around streaming
[407f977c36] Move guard collection size
[0529e57d2f] Remove explicit references to big format
[61509963ec] Unclassified minor changes
[da28d1af3a] Replaced getCreationTimeFor(Component) with getDataCreationTime()
[e99c834de6] !!! Reformatting
[882b7baa5a] Rename SSTableReader.maybePresent and fix its redundant usages
[b70c983bea] Implement mmapped region extension for compressed data
[d7ff3970de] Introduce SSTable.Owner interface
[e9feb9c462] Replaced getCreationTimeFor(Component) with getDataCreationTime()
[ee8082fb07] Created SSTableFormat.deleteOrphanedComponents
[e62950fd3d] Refactor metrics further
[cefa5b3814] Extract key cache support into separate entity
[dd55101ca1] Extracted SSTableReaderWithFilter
[510b651824] Implement customizable component types
[2be512d9fa] Pluggable SSTableFormat by making SSTableFormat.Type not an enum
[670836b55d] Refactor CRC and digest validators
[00c91103bc] Extract delete method to delete SSTables and purge row cache entries
[0819dc9fc2] Extracted trySkipFileCacheBefore(key) to SSTableReader
[732f841750] Added missing overrides in ForwardingSSTableReader
[db623218fd] Update DatabaseDescriptorRefTest
[c018c468e5] Cleanup
[eafc836242] Add @SuppressWarnings(""resource"") where needed
[3b7c911dd6] Documentation

patch by Jacek Lewandowski, reviewed by Branimir Lambov for CASSANDRA-17056

Co-authored-by: @jacek-lewandowski
Co-authored-by: @blambov","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'SinglePartitionReadCommand.java', 'CompactionManager.java', 'SSTableReader.java', 'StorageService.java']",CASSANDRA-1705
48417940280021d0012b7a7db6c9f823a98086e4,"Add MaxSSTableSize and MaxSSTableDuration metrics and propagate them together with local read/write ratio to tablestats

patch by Stefan Miklosovic; reviewed by Brandon Williams and Brad Schoening for CASSANDRA-18283","['ColumnFamilyStore.java', 'NodeProbe.java']",CASSANDRA-1828
4734dfc503e6b4307b63dd61f36da9f9c89d86f9,"Extend implicit allow-filtering for virtual tables to clustering columns

patch by Stefan Miklosovic; reviewed by Aleksey Yeschenko for CASSANDRA-18331",['SelectStatement.java'],CASSANDRA-1833
d5b1483703b53c02fb0e616e58107afb814f9f81,"Incompatible file system thrown while running Simulator

patch by David Capwell; reviewed by Brandon Williams, Caleb Rackliffe for CASSANDRA-18320","['CassandraDaemon.java', 'StorageService.java']",CASSANDRA-1832
fc9efd6357fb4255174689b3c107b897254a7d2f,"Add virtual table system_views.snapshots

patch by Maxwell Guo; reviewed by Stefan Miklosovic and Paulo Motta for CASSANDRA-18102

Co-authored-by: Stefan Miklosovic <smiklosovic@apache.org>",['StorageService.java'],CASSANDRA-1810
2e2a49fcdcf34ef2e8afcb3369f5a62cb168f18c,"CEP-20: Dynamic Data Masking

Allows to attach the native masking functions and UDFs to the definitions of
table columns in the schema, as defined by CEP-20.

The functions masking a column can be specified on CREATE TABLE queries, right
at the end of the column definition. The mask of a column can also be changed
or dropped with an ALTER TABLE query. Once a column is masked, SELECT queries
will always return the masked value of the column. That masking is done on the
coordinator, at the end of the query execution. Thus, masking won't affect any
filters or ordering, which would be based on the clear values of the masked
columns. Column masks are stored on the table system_schema.column_masks.

A new UNMASK permission allows to see the clear data of columns with an
attached mask. Also, a new SELECT_MASKED permission allows to run SELECT
queries restricting the clear values of masked columns. Superusers have both
permissions by default, whereas regular users don't have them.

Dynamic data masking can be enabled/disabled with the config property
dynamic_data_masking_enabled in cassandra.yaml. It is disabled by default.

This is the combination of multiple tickets:

 * Add masking functions to column metadata (CASSANDRA-18068)
 * Add UNMASK permission (CASSANDRA-18069)
 * Add SELECT_MASKED permission (CASSANDRA-18070)
 * Add support for using UDFs as masking functions (CASSANDRA-18071)
 * Add feature flag for dynamic data masking (CASSANDRA-18316)

patch by Andrés de la Peña; reviewed by Benjamin Lerer and Berenguer Blasi for CASSANDRA-17940","['Config.java', 'DatabaseDescriptor.java', 'SelectStatement.java']",CASSANDRA-1807
4444721b6de555352bf0ac3ef7e36f94dc832f41,"Provide summary of failed SessionInfo's in StreamResultFuture

patch by Natnael Adere; reviewed by David Capwell, Dinesh Joshi, Jon Meredith for CASSANDRA-17199","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-17199
8b0dc8ad6b5e657cf5946eaed17da0fdabaa53f4,"When decommissioning should set Severity to limit traffic

patch by David Capwell; reviewed by Brandon Williams for CASSANDRA-18430","['Config.java', 'DatabaseDescriptor.java', 'SSTableReader.java', 'StorageProxy.java', 'StorageService.java']",CASSANDRA-1843
4f348786bd6d72f4402134a29ddb3355b1fade61,"Do not remove truncated_at entry in system.local while dropping an index

patch by Stefan Miklosovic; reviewed by Caleb Rackliffe for CASSANDRA-18105",['ColumnFamilyStore.java'],CASSANDRA-1810
73da05f83ba2547662e6320cb2cb3576bf82c15f,"Replace usages of json-simple dependency by Jackson

patch by Tatu Saloranta; reviewed by Brandon Williams for CASSANDRA-16855

Co-authored-by: Stefan Miklosovic <smiklosovic@apache.org>",['ColumnFamilyStore.java'],CASSANDRA-1685
2ff1ad4788a1e29b99f81f75b2966b7951ba8250,"Add Timestamp Bound Guardrail (bound user supplied timestamps within a certain range)

Patch by Jordan West; Reviewed by Andrés de la Peña and Brandon Williams for CASSANDRA-18352",['Config.java'],CASSANDRA-1835
fe0e04c2319afab958b3da83e7b54c84bced9dc2,"Fix sstable formats configuration

- refactored sstable format configuration
- sstable formats are discovered via ServiceLoader
- options configuration for sstable formats can be included in yaml
- yaml may include selected sstable format and version (version is not yet supported)
- auto saved caches refactored - they include additional metadata component which contains necessary mappings

patch by Jacek Lewandowski; reviewed by David Capwell for CASSANDRA-18441","['Config.java', 'DatabaseDescriptor.java', 'ColumnFamilyStore.java', 'StorageService.java']",CASSANDRA-1844
aafb4d19448f12ce600dc4e84a5b181308825b32,"Improve nodetool enable{audit,fullquery}log

Patch by marcuse; reviewed by Dinesh Joshi and Mick Semb Wever for CASSANDRA-18550","['DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-18550
1adbea5a068287f42f2421e558f4c404c69aea74,"Extend maximum expiration date

patch by Berenguer Blasi; reviewed by Andrés de la Peña for CASSANDRA-14227","['Config.java', 'DatabaseDescriptor.java', 'SelectStatement.java', 'ColumnFamilyStore.java', 'SinglePartitionReadCommand.java', 'CompactionManager.java', 'SSTableReader.java', 'MessagingService.java', 'StorageProxy.java']",CASSANDRA-14227
e2a6c99310aa93ba3506ca8f603ae1039372f533,"Expose bootstrap and decommission state to nodetool info

patch by Stefan Miklosovic; reviewed by Brandon Williams CASSANDRA-18555

Co-authored-by: Jaydeepkumar Chovatia <chovatia.jaydeep@gmail.com>",['StorageService.java'],CASSANDRA-1855
c579faa488ec156a59ed8e15dd6db55759b9c942,"Remove deprecated compaction_tombstone_warning_threshold and compaction_large_partition_warning_threshold from yaml

patch by Andrés de la Peña; reviewed by Brandon Williams for CASSANDRA-18626","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-1862
8faa2a2c6968221453a144954c219e9a0d90f0e2,"Remove WaitingOnFreeMemtableSpace and DroppedMutations metrics

Patch by Bartlomiej, reviewed by bereng and brandonwilliams for
CASSANDRA-18298",['NodeProbe.java'],CASSANDRA-1829
cde91e56f09d9ebf315c79c9a81b89f70f4eb724,"In-memory index implementation with query path

This includes the following elements of the Storage Attached Index:
- Memtable-attached indexes backed by an in-memory trie structure for byte-comparable values
- Query path for the in-memory index
- Index status propagation
- Randomized testing for Memtable-attached indexes

patch my Mike Adamson; reviewed by Caleb Rackliffe and Andres de la Peña for CASSANDRA-18058

Co-authored-by: Mike Adamson <madamson@datastax.com>
Co-authored-by: Caleb Rackliffe <calebrackliffe@gmail.com>","['SinglePartitionReadCommand.java', 'StorageService.java']",CASSANDRA-1805
6ab45971fc651f78c8748f80e3cd6d4a1b6dbc50,"Introduce pluggable crypto providers and default to Amazon Corretto Crypto Provider

patch by Ayushi Singh; reviewed by Stefan Miklosovic, Michael Semb Wever and Maxim Muzafarov for CASSANDRA-18624

Co-authored-by: Stefan Miklosovic <smiklosovic@apache.org>","['Config.java', 'DatabaseDescriptor.java']",CASSANDRA-1862
f078c02cb58bddd735490b07548f7352f0eb09aa,"Adding Mutual TLS authenticators for client & internode connections

Patch by Jyothsna Konisa & Dinesh Joshi; reviewed by Yifan Cai, Jon Meredith,
Yuki Morishita & Dinesh Joshi for CASSANDRA-18554

Co-Authored-By: Dinesh Joshi <djoshi@apache.org>","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java']",CASSANDRA-1855
933137fb14d4ebfe38d0d2c8e23b765aa1c89333,"CIDR filtering authorizer

Patch by Shailaja Koppu, Yifan Cai; Reviewed by Dinesh Joshi, Yifan Cai for CASSANDRA-18592

Co-Authored-By: Yifan Cai <ycai@apache.org>","['Config.java', 'DatabaseDescriptor.java', 'StorageService.java', 'NodeProbe.java']",CASSANDRA-1859
acb4993cd0545ba4ce7bbb0a506c0cf46a0ac5ef,"Expose bootstrap failure state via JMX and nodetool info

patch by Jaydeepkumar Chovatia; reviewed by Stefan Miklosovic and Brandon Williams for CASSANDRA-18749",['StorageService.java'],CASSANDRA-1874
8bbf92a670d98f758c549cf241e7732370c21384,"Refactor validation logic in StorageService.rebuild

patch by Stefan Miklosovic; reviewed by Ariel Weisberg for CASSANDRA-18803",['StorageService.java'],CASSANDRA-1880
6708499e4c930f7733894e6076b925fb151d9251,"Remove metrics-reporter-config dependency

patch by Maxim Muzafarov; reviewed by Ekaterina Dimitrova and Brandon Williams for CASSANDRA-18743",['CassandraDaemon.java'],CASSANDRA-1874
